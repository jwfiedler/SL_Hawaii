

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Data Wrangling &#8212; Hawaii Sea Level Indicators</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/SL_Data_Wrangling';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sea Level Magnitude" href="SL_annual.html" />
    <link rel="prev" title="Setup" href="setup.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>


  <div class="bd-header-announcement container-fluid bd-header-announcement">
    <div class="bd-header-announcement__content">In development! Please post issues and suggestions to github.</div>
  </div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/trend_map.png" class="logo__image only-light" alt="Hawaii Sea Level Indicators - Home"/>
    <script>document.write(`<img src="../_static/trend_map.png" class="logo__image only-dark" alt="Hawaii Sea Level Indicators - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://uhslc.soest.hawaii.edu/jfiedler/SeaLevelIndicators/">Indicator Matrix</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../gettingStarted.html">Getting Started</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Data Wrangling</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ANNUAL</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="SL_annual.html">Sea Level Magnitude</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="regional_and_local/SL_Trend.html">Sea Level Trend</a></li>
<li class="toctree-l2"><a class="reference internal" href="regional_and_local/SL_anomaly_annual.html">Annual Sea Level Anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="regional_and_local/SL_Rankings_annual.html">Annual Sea Level Rankings</a></li>
<li class="toctree-l2"><a class="reference internal" href="regional_and_local/SL_Extremes_annual.html">Annual Extremes</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html">Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="nonstationaryGEV/monthly_extremes_non-stationaryGEV.html">Nonstationary Extremes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Flood.html">Minor Flood Frequency and Duration</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="FloodFrequency.html">Minor Flood Frequency</a></li>
<li class="toctree-l2"><a class="reference internal" href="FloodDuration.html">Flood Duration</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">INTRA-ANNUAL</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="SL_intra-annual.html">Sea Level Magnitude</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="regional_and_local/SL_anomaly_intra-annual.html">Intra-Annual Sea Level Anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="regional_and_local/SL_Extremes_intra-annual.html">Intra-Annual Extremes</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributions.html">Contributions</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Flood_intra-annual.html">Minor Flood Frequency and Duration</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="FloodFrequency_intra-annual.html">Minor Flood Frequency</a></li>
<li class="toctree-l2"><a class="reference internal" href="FloodDuration_intra-annual.html">Flood Duration</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jwfiedler/SL_Hawaii/main?urlpath=tree/notebooks/SL_Data_Wrangling.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jwfiedler/SL_Hawaii" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jwfiedler/SL_Hawaii/edit/main/notebooks/SL_Data_Wrangling.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jwfiedler/SL_Hawaii/issues/new?title=Issue%20on%20page%20%2Fnotebooks/SL_Data_Wrangling.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/SL_Data_Wrangling.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data Wrangling</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-tide-gauge-data">Retrieve Tide Gauge Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-data-from-noaa-co-ops-api">Retrieve data from NOAA CO-OPS API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-altimetry-data">Retrieve altimetry data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#processing">Processing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#process-the-tide-gauge-data-to-match-cmems">Process the tide gauge data to match CMEMS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize-the-tide-gauge-data-relative-to-the-1993-2012-epoch">Normalize the tide gauge data relative to the 1993-2012 epoch</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-climate-indices">Retrieve Climate Indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pacific-meridional-mode">Pacific Meridional Mode</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pdo-pacific-decadal-oscillation">PDO: Pacific Decadal Oscillation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#best-bivariate-enso-timeseries">BEST: Bivariate EnSo Timeseries</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-wrangling">
<h1>Data Wrangling<a class="headerlink" href="#data-wrangling" title="Permalink to this heading">#</a></h1>
<p>In this notebook we’ll obtain all of our data, arrange it how we want, and store it in the proper directories.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">run</span> setup.ipynb
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../data&#39;</span><span class="p">)</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../output&#39;</span><span class="p">)</span>

<span class="n">tg_nc_dir</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;tide_gauge_nc&#39;</span>

<span class="c1"># Check if the directories exist, if not create them</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">,</span> <span class="n">tg_nc_dir</span><span class="p">]:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">d</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>

        
</pre></div>
</div>
</div>
</div>
<section id="retrieve-tide-gauge-data">
<h2>Retrieve Tide Gauge Data<a class="headerlink" href="#retrieve-tide-gauge-data" title="Permalink to this heading">#</a></h2>
<p>We are interested in getting tide gauge and alitmetry data for the Hawaiian Islands (and surrounds) for 1993 through 2022.
Let’s first establish where the tide gauges are by looking at the tide gauge dataset. We’ll retrieve tide gauge data from the UHSLC (University of Hawaii Sea Level Center) fast-delivery dataset {cite:t}``. The fast-delivery data are released within 1-2 months of data collection and are subject only to basic quality control.</p>
<p>We’ll be retrieving the hourly data for our station group at from UHSLC, and saving this to our data directory so we don’t have to download again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hawaii stations are: </span>
<span class="n">stationdict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Hilo&#39;</span><span class="p">:</span> <span class="s1">&#39;060&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Kawaihae&#39;</span><span class="p">:</span> <span class="s1">&#39;552&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Kahului&#39;</span><span class="p">:</span> <span class="s1">&#39;059&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Mokuoloe&#39;</span><span class="p">:</span> <span class="s1">&#39;061&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Honolulu&#39;</span><span class="p">:</span> <span class="s1">&#39;057&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Nawiliwili&#39;</span><span class="p">:</span> <span class="s1">&#39;058&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Johnston Island&#39;</span><span class="p">:</span> <span class="s1">&#39;052&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Midway Island&#39;</span><span class="p">:</span> <span class="s1">&#39;050&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Kaumalapau&#39;</span><span class="p">:</span> <span class="s1">&#39;548&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Barbers Point&#39;</span><span class="p">:</span> <span class="s1">&#39;547&#39;</span><span class="p">,</span>
    <span class="s1">&#39;French Frigate Shoals&#39;</span><span class="p">:</span> <span class="s1">&#39;014&#39;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">stationdict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

<span class="n">station_group</span> <span class="o">=</span> <span class="s1">&#39;Hawaiian Islands&#39;</span>

<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;station_group&#39;</span><span class="p">,</span> <span class="n">station_group</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Hawaiian Islands&#39;
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What about research quality data (RQD)?
RQD undergo thorough and time-consuming QC, and are usually released 1-2 years after data is received.</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://uhslc.soest.hawaii.edu/data/netcdf/fast/hourly/&quot;</span> 
<span class="n">uhslc_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">stationdict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<span class="k">for</span> <span class="n">uhslc_id</span> <span class="ow">in</span> <span class="n">uhslc_ids</span><span class="p">:</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;h</span><span class="si">{</span><span class="n">uhslc_id</span><span class="si">}</span><span class="s1">.nc&#39;</span> <span class="c1"># h for hourly, d for daily</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;tide_gauge_nc&#39;</span><span class="p">,</span><span class="n">fname</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">urlretrieve</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">fname</span><span class="p">),</span> <span class="n">path</span><span class="p">)</span> 
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Downloading </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1"> from </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we merge all the datasets. This can take a while.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_dir</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PosixPath(&#39;../data&#39;)
</pre></div>
</div>
</div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>In the following section I remove the trailing zero from the record-id of each tide gauge. This will propagate through everything!!</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the data</span>

<span class="kn">import</span> <span class="nn">glob</span>        
<span class="c1"># Get a list of all .nc files in the data directory</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="s1">&#39;tide_gauge_nc&#39;</span><span class="p">,</span><span class="s1">&#39;h*.nc&#39;</span><span class="p">))</span>

<span class="c1"># Open the datasets</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">]</span>

<span class="c1">#merge in batches of 2 to avoid memory issues</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">merged_datasets</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">batch_size</span><span class="p">]</span>
    <span class="n">merged_batch</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">merged_datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">merged_batch</span><span class="p">)</span>

<span class="c1">#merge the merged datasets</span>
<span class="n">rsl</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged_datasets</span><span class="p">)</span>

<span class="c1"># convert byte strings to normal strings</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;station_country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;station_country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;ssc_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;ssc_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c1"># remove the trailing zero from each record_id</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]</span> <span class="o">=</span><span class="p">(</span><span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">rsl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 55MB
Dimensions:               (time: 1052654, record_id: 11)
Coordinates:
  * time                  (time) datetime64[ns] 8MB 1905-01-01T10:00:00.02880...
  * record_id             (record_id) int64 88B 14 50 52 57 ... 61 547 548 552
Data variables:
    sea_level             (record_id, time) float32 46MB nan nan ... 923.0 928.0
    lat                   (record_id) float32 44B 23.87 28.22 ... 20.78 20.03
    lon                   (record_id) float32 44B 193.7 182.6 ... 203.0 204.2
    station_name          (record_id) &lt;U17 748B &#x27;French Frigate&#x27; ... &#x27;Kawaihae&#x27;
    station_country       (record_id) &lt;U30 1kB &#x27;United States of America (the...
    station_country_code  (record_id) float32 44B 840.0 840.0 ... 840.0 840.0
    uhslc_id              (record_id) float32 44B 14.0 50.0 52.0 ... 548.0 552.0
    gloss_id              (record_id) float32 44B 107.0 106.0 109.0 ... nan nan
    ssc_id                (record_id) &lt;U4 176B &#x27;fren&#x27; &#x27;midx&#x27; ... &#x27;kaum&#x27; &#x27;kawa&#x27;
    last_rq_date          (record_id) datetime64[ns] 88B 2018-10-03T22:59:59....
Attributes:
    title:                  UHSLC Fast Delivery Tide Gauge Data (hourly)
    ncei_template_version:  NCEI_NetCDF_TimeSeries_Orthogonal_Template_v2.0
    featureType:            timeSeries
    Conventions:            CF-1.6, ACDD-1.3
    date_created:           2025-03-03T14:27:41Z
    publisher_name:         University of Hawaii Sea Level Center (UHSLC)
    publisher_email:        philiprt@hawaii.edu, markm@soest.hawaii.edu
    publisher_url:          http://uhslc.soest.hawaii.edu
    summary:                The UHSLC assembles and distributes the Fast Deli...
    processing_level:       Fast Delivery (FD) data undergo a level 1 quality...
    acknowledgment:         The UHSLC Fast Delivery database is supported by ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ad169d46-02a6-4677-aced-65793b70749d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ad169d46-02a6-4677-aced-65793b70749d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1052654</li><li><span class='xr-has-index'>record_id</span>: 11</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-672fe0eb-5da8-4800-b060-acb0c79b2641' class='xr-section-summary-in' type='checkbox'  checked><label for='section-672fe0eb-5da8-4800-b060-acb0c79b2641' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1905-01-01T10:00:00.028800 ... 2...</div><input id='attrs-97aed89f-2315-4f2a-8e50-77a9f6836910' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-97aed89f-2315-4f2a-8e50-77a9f6836910' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49dd954f-9ca8-4239-a8f2-d59ead01d456' class='xr-var-data-in' type='checkbox'><label for='data-49dd954f-9ca8-4239-a8f2-d59ead01d456' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1905-01-01T10:00:00.028800000&#x27;, &#x27;1905-01-01T10:59:59.971200000&#x27;,
       &#x27;1905-01-01T12:00:00.000000000&#x27;, ..., &#x27;2025-01-31T21:00:00.000000000&#x27;,
       &#x27;2025-01-31T22:00:00.028800000&#x27;, &#x27;2025-01-31T22:59:59.971200000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>record_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>14 50 52 57 58 59 60 61 547 548 552</div><input id='attrs-88a0c2ee-0a20-41a3-9226-6a9e68419220' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-88a0c2ee-0a20-41a3-9226-6a9e68419220' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7072fa50-6f7f-49a4-975b-81d16521817f' class='xr-var-data-in' type='checkbox'><label for='data-7072fa50-6f7f-49a4-975b-81d16521817f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 14,  50,  52,  57,  58,  59,  60,  61, 547, 548, 552])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5e09ad02-6809-4d72-a685-aa970f1ab0dd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5e09ad02-6809-4d72-a685-aa970f1ab0dd' class='xr-section-summary' >Data variables: <span>(10)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sea_level</span></div><div class='xr-var-dims'>(record_id, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 923.0 928.0</div><input id='attrs-7c7ae2c1-98d8-41ad-88bf-a8966f657c2d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7c7ae2c1-98d8-41ad-88bf-a8966f657c2d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a8a0b869-ff96-427e-bd44-2a6eb3f9af40' class='xr-var-data-in' type='checkbox'><label for='data-a8a0b869-ff96-427e-bd44-2a6eb3f9af40' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>relative sea level</dd><dt><span>units :</span></dt><dd>millimeters</dd><dt><span>source :</span></dt><dd>in situ tide gauge water level observations</dd><dt><span>platform :</span></dt><dd>station_name, station_country, station_country_code, uhslc_id, gloss_id, ssc_id</dd></dl></div><div class='xr-var-data'><pre>array([[  nan,   nan,   nan, ...,  867.,  774.,  771.],
       [  nan,   nan,   nan, ..., 1159., 1080., 1025.],
       [  nan,   nan,   nan, ...,  882.,  664.,  539.],
       ...,
       [  nan,   nan,   nan, ...,   nan,   nan,   nan],
       [  nan,   nan,   nan, ...,   nan,   nan,   nan],
       [  nan,   nan,   nan, ..., 1005.,  923.,  928.]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>23.87 28.22 16.75 ... 20.78 20.03</div><input id='attrs-fd6eaa64-06e5-4b4a-8c5e-804425847aeb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fd6eaa64-06e5-4b4a-8c5e-804425847aeb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1d7767ea-6f3f-4420-aebe-02209bbfff2e' class='xr-var-data-in' type='checkbox'><label for='data-1d7767ea-6f3f-4420-aebe-02209bbfff2e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>valid_min :</span></dt><dd>-90</dd><dt><span>valid_max :</span></dt><dd>90</dd></dl></div><div class='xr-var-data'><pre>array([23.867, 28.217, 16.75 , 21.307, 21.967, 20.9  , 19.733, 21.433,
       21.322, 20.783, 20.033], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>193.7 182.6 190.5 ... 203.0 204.2</div><input id='attrs-1998fd19-29d4-4753-be0a-a237aca84a1f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1998fd19-29d4-4753-be0a-a237aca84a1f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a87772f9-f851-4edc-b50c-b43fc1d526fd' class='xr-var-data-in' type='checkbox'><label for='data-a87772f9-f851-4edc-b50c-b43fc1d526fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>360</dd></dl></div><div class='xr-var-data'><pre>array([193.71 , 182.633, 190.483, 202.133, 200.65 , 203.533, 204.933,
       202.2  , 201.88 , 203.   , 204.167], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_name</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U17</div><div class='xr-var-preview xr-preview'>&#x27;French Frigate&#x27; ... &#x27;Kawaihae&#x27;</div><input id='attrs-c40af301-8ac4-4e08-90d4-5bc58c8c9a64' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c40af301-8ac4-4e08-90d4-5bc58c8c9a64' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-008c0e2d-3ca9-456d-87d6-d820a0c74ee8' class='xr-var-data-in' type='checkbox'><label for='data-008c0e2d-3ca9-456d-87d6-d820a0c74ee8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>station name</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;French Frigate&#x27;, &#x27;Midway&#x27;, &#x27;Johnston&#x27;, &#x27;Honolulu, Hawaii&#x27;,
       &#x27;Nawiliwili&#x27;, &#x27;Kahului&#x27;, &#x27;Hilo, Hawaii&#x27;, &#x27;Mokuoloe&#x27;,
       &#x27;Barbers Point, HI&#x27;, &#x27;Kaumalapau, HI&#x27;, &#x27;Kawaihae&#x27;], dtype=&#x27;&lt;U17&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U30</div><div class='xr-var-preview xr-preview'>&#x27;United States of America (the)&#x27;...</div><input id='attrs-33b27ec5-fbf3-4040-b077-a290997b7894' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-33b27ec5-fbf3-4040-b077-a290997b7894' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e09170f3-6480-46f5-a0af-db819b791129' class='xr-var-data-in' type='checkbox'><label for='data-e09170f3-6480-46f5-a0af-db819b791129' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>station country (ISO 3166-1)</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;], dtype=&#x27;&lt;U30&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country_code</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>840.0 840.0 840.0 ... 840.0 840.0</div><input id='attrs-16622f10-cfcc-4f61-a7de-15a558eb7e2e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-16622f10-cfcc-4f61-a7de-15a558eb7e2e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cfa42500-0958-4530-9ac8-160ebfee2934' class='xr-var-data-in' type='checkbox'><label for='data-cfa42500-0958-4530-9ac8-160ebfee2934' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>station country code (ISO 3166-1 numeric)</dd><dt><span>comment :</span></dt><dd>These are 3-digit country codes (e.g., 003) stored as integers.</dd></dl></div><div class='xr-var-data'><pre>array([840., 840., 840., 840., 840., 840., 840., 840., 840., 840., 840.],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>uhslc_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>14.0 50.0 52.0 ... 548.0 552.0</div><input id='attrs-644a59c3-5ced-4f2d-ae38-46f71b11c6fe' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-644a59c3-5ced-4f2d-ae38-46f71b11c6fe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2b8f04c0-2444-4174-84d9-082280f1ac1f' class='xr-var-data-in' type='checkbox'><label for='data-2b8f04c0-2444-4174-84d9-082280f1ac1f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique station ID number used by the University of Hawaii Sea Level Center (UHSLC)</dd></dl></div><div class='xr-var-data'><pre>array([ 14.,  50.,  52.,  57.,  58.,  59.,  60.,  61., 547., 548., 552.],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>gloss_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>107.0 106.0 109.0 ... nan nan nan</div><input id='attrs-21994f50-1ca5-40f5-947f-9ea82cfdf7cc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-21994f50-1ca5-40f5-947f-9ea82cfdf7cc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a75e6203-6c4d-4bc4-be86-c719198ef6e9' class='xr-var-data-in' type='checkbox'><label for='data-a75e6203-6c4d-4bc4-be86-c719198ef6e9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique station ID number used by the WMO/IOC Global Sea Level Observing System (GLOSS)</dd></dl></div><div class='xr-var-data'><pre>array([107., 106., 109., 108.,  nan,  nan, 287.,  nan,  nan,  nan,  nan],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ssc_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>&#x27;fren&#x27; &#x27;midx&#x27; ... &#x27;kaum&#x27; &#x27;kawa&#x27;</div><input id='attrs-b88b813e-8b91-4a2b-8ded-334d6cb17152' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b88b813e-8b91-4a2b-8ded-334d6cb17152' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8d7aa959-1b57-4f92-85b0-2ff654306ec3' class='xr-var-data-in' type='checkbox'><label for='data-8d7aa959-1b57-4f92-85b0-2ff654306ec3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique station ID code in the Sealevel Station Catalog (SSC) produced by the WMO/IOC Sea Level Monitoring Facility (VLIZ)</dd><dt><span>comment :</span></dt><dd>Note that SSC IDs vary in length. The IDs are padded with space characters to produce the retangular character matrix provided here.</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;fren&#x27;, &#x27;midx&#x27;, &#x27;john&#x27;, &#x27;hono&#x27;, &#x27;nawi&#x27;, &#x27;kahu&#x27;, &#x27;hilo&#x27;, &#x27;moku&#x27;,
       &#x27;brpt&#x27;, &#x27;kaum&#x27;, &#x27;kawa&#x27;], dtype=&#x27;&lt;U4&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>last_rq_date</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2018-10-03T22:59:59.971200 ... 2...</div><input id='attrs-5f9cac4b-0e9f-4f23-bc19-46c4ccc02e95' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5f9cac4b-0e9f-4f23-bc19-46c4ccc02e95' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-88478f0c-6d84-4f75-9c3d-88561c40e96e' class='xr-var-data-in' type='checkbox'><label for='data-88478f0c-6d84-4f75-9c3d-88561c40e96e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>date of last Research Quality sea level value</dd><dt><span>comment :</span></dt><dd>Values in last_rq_date correspond to an identical value in the time vector. Dates less than or equal to last_rq_date for a given station correspond to Research Quality (RQ) data. Dates after last_rq_date correspond to Fast Delivery (FD) data. Missing values indicate no RQ data for a station.</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2018-10-03T22:59:59.971200000&#x27;, &#x27;2021-12-31T22:59:59.971200000&#x27;,
       &#x27;2018-12-31T22:59:59.971200000&#x27;, &#x27;2021-12-31T22:59:59.971200000&#x27;,
       &#x27;2021-12-31T22:59:59.971200000&#x27;, &#x27;2021-12-31T22:59:59.971200000&#x27;,
       &#x27;2021-12-31T22:59:59.971200000&#x27;, &#x27;2021-12-31T22:59:59.971200000&#x27;,
       &#x27;2018-12-30T22:59:59.971200000&#x27;, &#x27;2015-03-22T22:59:59.971200000&#x27;,
       &#x27;2022-12-31T22:59:59.971200000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-413e23f8-eab3-4632-8c4f-d0aed945641e' class='xr-section-summary-in' type='checkbox'  ><label for='section-413e23f8-eab3-4632-8c4f-d0aed945641e' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4dc2b1f0-2a17-4a17-ab0e-2eedf76d08ab' class='xr-index-data-in' type='checkbox'/><label for='index-4dc2b1f0-2a17-4a17-ab0e-2eedf76d08ab' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1905-01-01 10:00:00.028800&#x27;, &#x27;1905-01-01 10:59:59.971200&#x27;,
                      &#x27;1905-01-01 12:00:00&#x27;, &#x27;1905-01-01 13:00:00.028800&#x27;,
               &#x27;1905-01-01 13:59:59.971200&#x27;,        &#x27;1905-01-01 15:00:00&#x27;,
               &#x27;1905-01-01 16:00:00.028800&#x27;, &#x27;1905-01-01 16:59:59.971200&#x27;,
                      &#x27;1905-01-01 18:00:00&#x27;, &#x27;1905-01-01 19:00:00.028800&#x27;,
               ...
               &#x27;2025-01-31 13:59:59.971200&#x27;,        &#x27;2025-01-31 15:00:00&#x27;,
               &#x27;2025-01-31 16:00:00.028800&#x27;, &#x27;2025-01-31 16:59:59.971200&#x27;,
                      &#x27;2025-01-31 18:00:00&#x27;, &#x27;2025-01-31 19:00:00.028800&#x27;,
               &#x27;2025-01-31 19:59:59.971200&#x27;,        &#x27;2025-01-31 21:00:00&#x27;,
               &#x27;2025-01-31 22:00:00.028800&#x27;, &#x27;2025-01-31 22:59:59.971200&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1052654, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>record_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-cb3818db-e9eb-4262-a91f-ed5308ba9863' class='xr-index-data-in' type='checkbox'/><label for='index-cb3818db-e9eb-4262-a91f-ed5308ba9863' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([14, 50, 52, 57, 58, 59, 60, 61, 547, 548, 552], dtype=&#x27;int64&#x27;, name=&#x27;record_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-64945964-2087-430d-ba23-8c7ef661d60d' class='xr-section-summary-in' type='checkbox'  ><label for='section-64945964-2087-430d-ba23-8c7ef661d60d' class='xr-section-summary' >Attributes: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>UHSLC Fast Delivery Tide Gauge Data (hourly)</dd><dt><span>ncei_template_version :</span></dt><dd>NCEI_NetCDF_TimeSeries_Orthogonal_Template_v2.0</dd><dt><span>featureType :</span></dt><dd>timeSeries</dd><dt><span>Conventions :</span></dt><dd>CF-1.6, ACDD-1.3</dd><dt><span>date_created :</span></dt><dd>2025-03-03T14:27:41Z</dd><dt><span>publisher_name :</span></dt><dd>University of Hawaii Sea Level Center (UHSLC)</dd><dt><span>publisher_email :</span></dt><dd>philiprt@hawaii.edu, markm@soest.hawaii.edu</dd><dt><span>publisher_url :</span></dt><dd>http://uhslc.soest.hawaii.edu</dd><dt><span>summary :</span></dt><dd>The UHSLC assembles and distributes the Fast Delivery (FD) dataset of hourly- and daily-averaged tide gauge water-level observations. Tide gauge operators, or data creators, provide FD data to UHSLC after a level 1 quality assessment (see processing_level attribute). The UHSLC provides an independent quality assessment of the time series and makes FD data available within 4-6 weeks of collection. This is a &quot;fast&quot; turnaround time compared to Research Quality (RQ) data, which are available on an annual cycle after a level 2 quality assessment. RQ data replace FD data in the data stream as the former becomes available. This file contains hybrid time series composed of RQ data when available with FD data appended to the end of each RQ series.</dd><dt><span>processing_level :</span></dt><dd>Fast Delivery (FD) data undergo a level 1 quality assessment (e.g., unit and timing evaluation, outlier detection, combination of multiple channels into a primary channel, etc.). In this file, FD data are appended to Research Quality (RQ) data that have received a level 2 quality assessment (e.g., tide gauge datum evaluation, assessment of level ties to tide gauge benchmarks, comparison with nearby stations, etc.).</dd><dt><span>acknowledgment :</span></dt><dd>The UHSLC Fast Delivery database is supported by the National Oceanic and Atmospheric Administration (NOAA) Office of Climate Observations (OCO).</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_MHHW_uhslc_datums</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">datumname</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://uhslc.soest.hawaii.edu/stations/TIDES_DATUMS/fd/LST/fd&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;/datumTable_&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;_mm_GMT.csv&#39;</span>
    <span class="n">datumtable</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">datum</span> <span class="o">=</span> <span class="n">datumtable</span><span class="p">[</span><span class="n">datumtable</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">datumname</span><span class="p">][</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># ensure datum is a float</span>
    <span class="n">datum</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">datum</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">datum</span><span class="p">,</span> <span class="n">datumtable</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">datum</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Should make something to include all datums here as well.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add MHHW to the dataset</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;MHHW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="n">get_MHHW_uhslc_datums</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s1">&#39;MHHW&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;uhslc_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="s1">&#39;record_id&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;record_id&#39;</span><span class="p">:</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]})</span>

<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;MHHW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mm&#39;</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;MHHW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Mean Higher High Water, rel. to station datum&#39;</span>

<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;datumname&#39;</span><span class="p">,</span> <span class="s1">&#39;MHHW&#39;</span><span class="p">)</span>

<span class="c1"># add MSL to the dataset</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;MSL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="n">get_MHHW_uhslc_datums</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s1">&#39;MSL&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;uhslc_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="s1">&#39;record_id&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;record_id&#39;</span><span class="p">:</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]})</span>

<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;MSL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mm&#39;</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;MSL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Mean Sea Level, rel. to station datum&#39;</span>

<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;datumname&#39;</span><span class="p">,</span> <span class="s1">&#39;MSL&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;MHHW&#39;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;MSL&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#round the time to the nearest hour</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
<span class="n">rsl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/core/accessor_dt.py:161: FutureWarning: &#39;H&#39; is deprecated and will be removed in a future version, please use &#39;h&#39; instead.
  field_values = method(freq=freq).values
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 55MB
Dimensions:               (time: 1052654, record_id: 11)
Coordinates:
  * time                  (time) datetime64[ns] 8MB 1905-01-01T10:00:00 ... 2...
  * record_id             (record_id) int64 88B 14 50 52 57 ... 61 547 548 552
Data variables:
    sea_level             (record_id, time) float32 46MB nan nan ... 923.0 928.0
    lat                   (record_id) float32 44B 23.87 28.22 ... 20.78 20.03
    lon                   (record_id) float32 44B 193.7 182.6 ... 203.0 204.2
    station_name          (record_id) &lt;U17 748B &#x27;French Frigate&#x27; ... &#x27;Kawaihae&#x27;
    station_country       (record_id) &lt;U30 1kB &#x27;United States of America (the...
    station_country_code  (record_id) float32 44B 840.0 840.0 ... 840.0 840.0
    uhslc_id              (record_id) float32 44B 14.0 50.0 52.0 ... 548.0 552.0
    gloss_id              (record_id) float32 44B 107.0 106.0 109.0 ... nan nan
    ssc_id                (record_id) &lt;U4 176B &#x27;fren&#x27; &#x27;midx&#x27; ... &#x27;kaum&#x27; &#x27;kawa&#x27;
    last_rq_date          (record_id) datetime64[ns] 88B 2018-10-03T22:59:59....
    MHHW                  (record_id) float64 88B 997.0 1.204e+03 ... 1.406e+03
    MSL                   (record_id) float64 88B 777.0 1.02e+03 ... 1.053e+03
Attributes:
    title:                  UHSLC Fast Delivery Tide Gauge Data (hourly)
    ncei_template_version:  NCEI_NetCDF_TimeSeries_Orthogonal_Template_v2.0
    featureType:            timeSeries
    Conventions:            CF-1.6, ACDD-1.3
    date_created:           2025-03-03T14:27:41Z
    publisher_name:         University of Hawaii Sea Level Center (UHSLC)
    publisher_email:        philiprt@hawaii.edu, markm@soest.hawaii.edu
    publisher_url:          http://uhslc.soest.hawaii.edu
    summary:                The UHSLC assembles and distributes the Fast Deli...
    processing_level:       Fast Delivery (FD) data undergo a level 1 quality...
    acknowledgment:         The UHSLC Fast Delivery database is supported by ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-564936b4-126a-4e81-b13e-718bf2b933ab' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-564936b4-126a-4e81-b13e-718bf2b933ab' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1052654</li><li><span class='xr-has-index'>record_id</span>: 11</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d376a909-68ac-4e3f-9853-3eb356093ee3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d376a909-68ac-4e3f-9853-3eb356093ee3' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1905-01-01T10:00:00 ... 2025-01-...</div><input id='attrs-71504b00-1fbf-4791-9dbe-2176e89c5838' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-71504b00-1fbf-4791-9dbe-2176e89c5838' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc9070e2-7ac4-4b7a-bdb5-ca7a2f9d2b16' class='xr-var-data-in' type='checkbox'><label for='data-fc9070e2-7ac4-4b7a-bdb5-ca7a2f9d2b16' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1905-01-01T10:00:00.000000000&#x27;, &#x27;1905-01-01T11:00:00.000000000&#x27;,
       &#x27;1905-01-01T12:00:00.000000000&#x27;, ..., &#x27;2025-01-31T21:00:00.000000000&#x27;,
       &#x27;2025-01-31T22:00:00.000000000&#x27;, &#x27;2025-01-31T23:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>record_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>14 50 52 57 58 59 60 61 547 548 552</div><input id='attrs-7efbfaff-e0dc-4c3d-9ae1-96df72b90963' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7efbfaff-e0dc-4c3d-9ae1-96df72b90963' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80444f3a-b187-4e5b-b962-f0ecfd625b99' class='xr-var-data-in' type='checkbox'><label for='data-80444f3a-b187-4e5b-b962-f0ecfd625b99' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 14,  50,  52,  57,  58,  59,  60,  61, 547, 548, 552])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-dfdae5af-9d59-46dc-9119-bed9d858175a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dfdae5af-9d59-46dc-9119-bed9d858175a' class='xr-section-summary' >Data variables: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sea_level</span></div><div class='xr-var-dims'>(record_id, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 923.0 928.0</div><input id='attrs-883c0387-5167-4d09-a87a-d0cb53d40035' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-883c0387-5167-4d09-a87a-d0cb53d40035' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e2294ac1-b2d4-4c17-9cd1-88a841c98c6c' class='xr-var-data-in' type='checkbox'><label for='data-e2294ac1-b2d4-4c17-9cd1-88a841c98c6c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>relative sea level</dd><dt><span>units :</span></dt><dd>millimeters</dd><dt><span>source :</span></dt><dd>in situ tide gauge water level observations</dd><dt><span>platform :</span></dt><dd>station_name, station_country, station_country_code, uhslc_id, gloss_id, ssc_id</dd></dl></div><div class='xr-var-data'><pre>array([[  nan,   nan,   nan, ...,  867.,  774.,  771.],
       [  nan,   nan,   nan, ..., 1159., 1080., 1025.],
       [  nan,   nan,   nan, ...,  882.,  664.,  539.],
       ...,
       [  nan,   nan,   nan, ...,   nan,   nan,   nan],
       [  nan,   nan,   nan, ...,   nan,   nan,   nan],
       [  nan,   nan,   nan, ..., 1005.,  923.,  928.]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>23.87 28.22 16.75 ... 20.78 20.03</div><input id='attrs-9aeb4cd1-b2ca-44d3-86a6-f163ec4a649b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9aeb4cd1-b2ca-44d3-86a6-f163ec4a649b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b877d187-35a7-456c-bbb8-9e3b2c1be099' class='xr-var-data-in' type='checkbox'><label for='data-b877d187-35a7-456c-bbb8-9e3b2c1be099' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>valid_min :</span></dt><dd>-90</dd><dt><span>valid_max :</span></dt><dd>90</dd></dl></div><div class='xr-var-data'><pre>array([23.867, 28.217, 16.75 , 21.307, 21.967, 20.9  , 19.733, 21.433,
       21.322, 20.783, 20.033], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>193.7 182.6 190.5 ... 203.0 204.2</div><input id='attrs-bdcc43bb-06d9-45d5-8da1-3eb2f401f059' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bdcc43bb-06d9-45d5-8da1-3eb2f401f059' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-95232183-063b-4955-936d-2cc521cd422c' class='xr-var-data-in' type='checkbox'><label for='data-95232183-063b-4955-936d-2cc521cd422c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>360</dd></dl></div><div class='xr-var-data'><pre>array([193.71 , 182.633, 190.483, 202.133, 200.65 , 203.533, 204.933,
       202.2  , 201.88 , 203.   , 204.167], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_name</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U17</div><div class='xr-var-preview xr-preview'>&#x27;French Frigate&#x27; ... &#x27;Kawaihae&#x27;</div><input id='attrs-b67f168a-dd1c-45dc-978e-78bc79455947' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b67f168a-dd1c-45dc-978e-78bc79455947' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a52c6784-bfd5-47c3-ac52-0df9a9d37a44' class='xr-var-data-in' type='checkbox'><label for='data-a52c6784-bfd5-47c3-ac52-0df9a9d37a44' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>station name</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;French Frigate&#x27;, &#x27;Midway&#x27;, &#x27;Johnston&#x27;, &#x27;Honolulu, Hawaii&#x27;,
       &#x27;Nawiliwili&#x27;, &#x27;Kahului&#x27;, &#x27;Hilo, Hawaii&#x27;, &#x27;Mokuoloe&#x27;,
       &#x27;Barbers Point, HI&#x27;, &#x27;Kaumalapau, HI&#x27;, &#x27;Kawaihae&#x27;], dtype=&#x27;&lt;U17&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U30</div><div class='xr-var-preview xr-preview'>&#x27;United States of America (the)&#x27;...</div><input id='attrs-caa9c786-f734-4c0b-b1f0-1401c29e2b4e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-caa9c786-f734-4c0b-b1f0-1401c29e2b4e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-574aa91b-5e17-4f6a-ab9d-830388d7acd0' class='xr-var-data-in' type='checkbox'><label for='data-574aa91b-5e17-4f6a-ab9d-830388d7acd0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>station country (ISO 3166-1)</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;], dtype=&#x27;&lt;U30&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country_code</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>840.0 840.0 840.0 ... 840.0 840.0</div><input id='attrs-95cbf897-bd7c-4679-9ab2-a3f400992210' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-95cbf897-bd7c-4679-9ab2-a3f400992210' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4b00ae22-d170-4cbf-9f02-d30668f724e7' class='xr-var-data-in' type='checkbox'><label for='data-4b00ae22-d170-4cbf-9f02-d30668f724e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>station country code (ISO 3166-1 numeric)</dd><dt><span>comment :</span></dt><dd>These are 3-digit country codes (e.g., 003) stored as integers.</dd></dl></div><div class='xr-var-data'><pre>array([840., 840., 840., 840., 840., 840., 840., 840., 840., 840., 840.],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>uhslc_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>14.0 50.0 52.0 ... 548.0 552.0</div><input id='attrs-aa73aeb9-7362-45d9-ad2c-149d2a117942' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aa73aeb9-7362-45d9-ad2c-149d2a117942' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f560a9b7-d7e2-4e92-9212-3fdaa468d506' class='xr-var-data-in' type='checkbox'><label for='data-f560a9b7-d7e2-4e92-9212-3fdaa468d506' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique station ID number used by the University of Hawaii Sea Level Center (UHSLC)</dd></dl></div><div class='xr-var-data'><pre>array([ 14.,  50.,  52.,  57.,  58.,  59.,  60.,  61., 547., 548., 552.],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>gloss_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>107.0 106.0 109.0 ... nan nan nan</div><input id='attrs-c24a399b-6b51-474a-b1eb-876210232462' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c24a399b-6b51-474a-b1eb-876210232462' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b4f34770-6dad-427a-baf3-d7085da18adb' class='xr-var-data-in' type='checkbox'><label for='data-b4f34770-6dad-427a-baf3-d7085da18adb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique station ID number used by the WMO/IOC Global Sea Level Observing System (GLOSS)</dd></dl></div><div class='xr-var-data'><pre>array([107., 106., 109., 108.,  nan,  nan, 287.,  nan,  nan,  nan,  nan],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ssc_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>&#x27;fren&#x27; &#x27;midx&#x27; ... &#x27;kaum&#x27; &#x27;kawa&#x27;</div><input id='attrs-a3fd6d02-9a0f-4fb9-a711-e645ea552a83' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a3fd6d02-9a0f-4fb9-a711-e645ea552a83' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ed3c5f01-926e-4966-81d4-1a97db51941b' class='xr-var-data-in' type='checkbox'><label for='data-ed3c5f01-926e-4966-81d4-1a97db51941b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique station ID code in the Sealevel Station Catalog (SSC) produced by the WMO/IOC Sea Level Monitoring Facility (VLIZ)</dd><dt><span>comment :</span></dt><dd>Note that SSC IDs vary in length. The IDs are padded with space characters to produce the retangular character matrix provided here.</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;fren&#x27;, &#x27;midx&#x27;, &#x27;john&#x27;, &#x27;hono&#x27;, &#x27;nawi&#x27;, &#x27;kahu&#x27;, &#x27;hilo&#x27;, &#x27;moku&#x27;,
       &#x27;brpt&#x27;, &#x27;kaum&#x27;, &#x27;kawa&#x27;], dtype=&#x27;&lt;U4&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>last_rq_date</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2018-10-03T22:59:59.971200 ... 2...</div><input id='attrs-6abe8d88-8d65-435d-a168-bd31844be979' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6abe8d88-8d65-435d-a168-bd31844be979' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d210fcb-65a8-457f-b7d8-c43077fce774' class='xr-var-data-in' type='checkbox'><label for='data-3d210fcb-65a8-457f-b7d8-c43077fce774' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>date of last Research Quality sea level value</dd><dt><span>comment :</span></dt><dd>Values in last_rq_date correspond to an identical value in the time vector. Dates less than or equal to last_rq_date for a given station correspond to Research Quality (RQ) data. Dates after last_rq_date correspond to Fast Delivery (FD) data. Missing values indicate no RQ data for a station.</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2018-10-03T22:59:59.971200000&#x27;, &#x27;2021-12-31T22:59:59.971200000&#x27;,
       &#x27;2018-12-31T22:59:59.971200000&#x27;, &#x27;2021-12-31T22:59:59.971200000&#x27;,
       &#x27;2021-12-31T22:59:59.971200000&#x27;, &#x27;2021-12-31T22:59:59.971200000&#x27;,
       &#x27;2021-12-31T22:59:59.971200000&#x27;, &#x27;2021-12-31T22:59:59.971200000&#x27;,
       &#x27;2018-12-30T22:59:59.971200000&#x27;, &#x27;2015-03-22T22:59:59.971200000&#x27;,
       &#x27;2022-12-31T22:59:59.971200000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>MHHW</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>997.0 1.204e+03 ... 1.406e+03</div><input id='attrs-57f77f2b-ac47-423a-a178-0dabbef43fc7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-57f77f2b-ac47-423a-a178-0dabbef43fc7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c67c3aac-ea15-4a35-8651-84d38565cf85' class='xr-var-data-in' type='checkbox'><label for='data-c67c3aac-ea15-4a35-8651-84d38565cf85' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd><dt><span>long_name :</span></dt><dd>Mean Higher High Water, rel. to station datum</dd></dl></div><div class='xr-var-data'><pre>array([ 997., 1204., 1225., 1722., 1240., 1364., 1912., 1533., 3865.,
       2261., 1406.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>MSL</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>777.0 1.02e+03 ... 1.053e+03</div><input id='attrs-2e12191b-4815-435a-9040-4a7487ae3b80' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2e12191b-4815-435a-9040-4a7487ae3b80' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e47a5526-d859-42ac-b410-0cec92452083' class='xr-var-data-in' type='checkbox'><label for='data-e47a5526-d859-42ac-b410-0cec92452083' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd><dt><span>long_name :</span></dt><dd>Mean Sea Level, rel. to station datum</dd></dl></div><div class='xr-var-data'><pre>array([ 777., 1020.,  875., 1412.,  949., 1075., 1545., 1211., 3531.,
       1891., 1053.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-54ad7674-538d-493d-90da-56d008c7ff57' class='xr-section-summary-in' type='checkbox'  ><label for='section-54ad7674-538d-493d-90da-56d008c7ff57' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-50462adf-a134-4d76-9f14-bd8443f3737a' class='xr-index-data-in' type='checkbox'/><label for='index-50462adf-a134-4d76-9f14-bd8443f3737a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1905-01-01 10:00:00&#x27;, &#x27;1905-01-01 11:00:00&#x27;,
               &#x27;1905-01-01 12:00:00&#x27;, &#x27;1905-01-01 13:00:00&#x27;,
               &#x27;1905-01-01 14:00:00&#x27;, &#x27;1905-01-01 15:00:00&#x27;,
               &#x27;1905-01-01 16:00:00&#x27;, &#x27;1905-01-01 17:00:00&#x27;,
               &#x27;1905-01-01 18:00:00&#x27;, &#x27;1905-01-01 19:00:00&#x27;,
               ...
               &#x27;2025-01-31 14:00:00&#x27;, &#x27;2025-01-31 15:00:00&#x27;,
               &#x27;2025-01-31 16:00:00&#x27;, &#x27;2025-01-31 17:00:00&#x27;,
               &#x27;2025-01-31 18:00:00&#x27;, &#x27;2025-01-31 19:00:00&#x27;,
               &#x27;2025-01-31 20:00:00&#x27;, &#x27;2025-01-31 21:00:00&#x27;,
               &#x27;2025-01-31 22:00:00&#x27;, &#x27;2025-01-31 23:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1052654, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>record_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d424d664-5f81-411c-a6f8-6e5acb536503' class='xr-index-data-in' type='checkbox'/><label for='index-d424d664-5f81-411c-a6f8-6e5acb536503' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([14, 50, 52, 57, 58, 59, 60, 61, 547, 548, 552], dtype=&#x27;int64&#x27;, name=&#x27;record_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a93a2c33-c0a6-4e6f-a043-daacddee85c6' class='xr-section-summary-in' type='checkbox'  ><label for='section-a93a2c33-c0a6-4e6f-a043-daacddee85c6' class='xr-section-summary' >Attributes: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>UHSLC Fast Delivery Tide Gauge Data (hourly)</dd><dt><span>ncei_template_version :</span></dt><dd>NCEI_NetCDF_TimeSeries_Orthogonal_Template_v2.0</dd><dt><span>featureType :</span></dt><dd>timeSeries</dd><dt><span>Conventions :</span></dt><dd>CF-1.6, ACDD-1.3</dd><dt><span>date_created :</span></dt><dd>2025-03-03T14:27:41Z</dd><dt><span>publisher_name :</span></dt><dd>University of Hawaii Sea Level Center (UHSLC)</dd><dt><span>publisher_email :</span></dt><dd>philiprt@hawaii.edu, markm@soest.hawaii.edu</dd><dt><span>publisher_url :</span></dt><dd>http://uhslc.soest.hawaii.edu</dd><dt><span>summary :</span></dt><dd>The UHSLC assembles and distributes the Fast Delivery (FD) dataset of hourly- and daily-averaged tide gauge water-level observations. Tide gauge operators, or data creators, provide FD data to UHSLC after a level 1 quality assessment (see processing_level attribute). The UHSLC provides an independent quality assessment of the time series and makes FD data available within 4-6 weeks of collection. This is a &quot;fast&quot; turnaround time compared to Research Quality (RQ) data, which are available on an annual cycle after a level 2 quality assessment. RQ data replace FD data in the data stream as the former becomes available. This file contains hybrid time series composed of RQ data when available with FD data appended to the end of each RQ series.</dd><dt><span>processing_level :</span></dt><dd>Fast Delivery (FD) data undergo a level 1 quality assessment (e.g., unit and timing evaluation, outlier detection, combination of multiple channels into a primary channel, etc.). In this file, FD data are appended to Research Quality (RQ) data that have received a level 2 quality assessment (e.g., tide gauge datum evaluation, assessment of level ties to tide gauge benchmarks, comparison with nearby stations, etc.).</dd><dt><span>acknowledgment :</span></dt><dd>The UHSLC Fast Delivery database is supported by the National Oceanic and Atmospheric Administration (NOAA) Office of Climate Observations (OCO).</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#ensure rsl is netcdf4 format</span>
<span class="n">rsl</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;rsl_hawaii.nc&#39;</span><span class="p">,</span><span class="n">engine</span><span class="o">=</span><span class="s1">&#39;netcdf4&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">rsl</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/backends/file_manager.py:211,</span> in <span class="ni">CachingFileManager._acquire_with_cache_info</span><span class="nt">(self, needs_lock)</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">211</span>     <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_key</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span> <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/backends/lru_cache.py:56,</span> in <span class="ni">LRUCache.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">56</span>     <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">move_to_end</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="ne">KeyError</span>: [&lt;class &#39;netCDF4._netCDF4.Dataset&#39;&gt;, (&#39;/Users/jfiedler/Documents/Repositories/SL_Hawaii/SL_Hawaii/data/rsl_hawaii.nc&#39;,), &#39;a&#39;, ((&#39;clobber&#39;, True), (&#39;diskless&#39;, False), (&#39;format&#39;, &#39;NETCDF4&#39;), (&#39;persist&#39;, False)), &#39;e841b464-729c-4c94-953f-4c8103352227&#39;]

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">PermissionError</span><span class="g g-Whitespace">                           </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#ensure rsl is netcdf4 format</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">rsl</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;rsl_hawaii.nc&#39;</span><span class="p">,</span><span class="n">engine</span><span class="o">=</span><span class="s1">&#39;netcdf4&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">rsl</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/core/dataset.py:2298,</span> in <span class="ni">Dataset.to_netcdf</span><span class="nt">(self, path, mode, format, group, engine, encoding, unlimited_dims, compute, invalid_netcdf)</span>
<span class="g g-Whitespace">   </span><span class="mi">2295</span>     <span class="n">encoding</span> <span class="o">=</span> <span class="p">{}</span>
<span class="g g-Whitespace">   </span><span class="mi">2296</span> <span class="kn">from</span> <span class="nn">xarray.backends.api</span> <span class="kn">import</span> <span class="n">to_netcdf</span>
<span class="ne">-&gt; </span><span class="mi">2298</span> <span class="k">return</span> <span class="n">to_netcdf</span><span class="p">(</span>  <span class="c1"># type: ignore  # mypy cannot resolve the overloads:(</span>
<span class="g g-Whitespace">   </span><span class="mi">2299</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2300</span>     <span class="n">path</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2301</span>     <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2302</span>     <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2303</span>     <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2304</span>     <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2305</span>     <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2306</span>     <span class="n">unlimited_dims</span><span class="o">=</span><span class="n">unlimited_dims</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2307</span>     <span class="n">compute</span><span class="o">=</span><span class="n">compute</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2308</span>     <span class="n">multifile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2309</span>     <span class="n">invalid_netcdf</span><span class="o">=</span><span class="n">invalid_netcdf</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2310</span> <span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/backends/api.py:1322,</span> in <span class="ni">to_netcdf</span><span class="nt">(dataset, path_or_file, mode, format, group, engine, encoding, unlimited_dims, compute, multifile, invalid_netcdf)</span>
<span class="g g-Whitespace">   </span><span class="mi">1318</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1319</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1320</span>             <span class="sa">f</span><span class="s2">&quot;unrecognized option &#39;invalid_netcdf&#39; for engine </span><span class="si">{</span><span class="n">engine</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1321</span>         <span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1322</span> <span class="n">store</span> <span class="o">=</span> <span class="n">store_open</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1324</span> <span class="k">if</span> <span class="n">unlimited_dims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1325</span>     <span class="n">unlimited_dims</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">encoding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unlimited_dims&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/backends/netCDF4_.py:409,</span> in <span class="ni">NetCDF4DataStore.open</span><span class="nt">(cls, filename, mode, format, group, clobber, diskless, persist, lock, lock_maker, autoclose)</span>
<span class="g g-Whitespace">    </span><span class="mi">403</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">404</span>     <span class="n">clobber</span><span class="o">=</span><span class="n">clobber</span><span class="p">,</span> <span class="n">diskless</span><span class="o">=</span><span class="n">diskless</span><span class="p">,</span> <span class="n">persist</span><span class="o">=</span><span class="n">persist</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span>
<span class="g g-Whitespace">    </span><span class="mi">405</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">406</span> <span class="n">manager</span> <span class="o">=</span> <span class="n">CachingFileManager</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">407</span>     <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span>
<span class="g g-Whitespace">    </span><span class="mi">408</span> <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">409</span> <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">lock</span><span class="o">=</span><span class="n">lock</span><span class="p">,</span> <span class="n">autoclose</span><span class="o">=</span><span class="n">autoclose</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/backends/netCDF4_.py:356,</span> in <span class="ni">NetCDF4DataStore.__init__</span><span class="nt">(self, manager, group, mode, lock, autoclose)</span>
<span class="g g-Whitespace">    </span><span class="mi">354</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group</span> <span class="o">=</span> <span class="n">group</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">mode</span>
<span class="ne">--&gt; </span><span class="mi">356</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="o">.</span><span class="n">data_model</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="o">.</span><span class="n">filepath</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_remote</span> <span class="o">=</span> <span class="n">is_remote_uri</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/backends/netCDF4_.py:418,</span> in <span class="ni">NetCDF4DataStore.ds</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">416</span> <span class="nd">@property</span>
<span class="g g-Whitespace">    </span><span class="mi">417</span> <span class="k">def</span> <span class="nf">ds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">418</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_acquire</span><span class="p">()</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/backends/netCDF4_.py:412,</span> in <span class="ni">NetCDF4DataStore._acquire</span><span class="nt">(self, needs_lock)</span>
<span class="g g-Whitespace">    </span><span class="mi">411</span> <span class="k">def</span> <span class="nf">_acquire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">needs_lock</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">412</span>     <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">acquire_context</span><span class="p">(</span><span class="n">needs_lock</span><span class="p">)</span> <span class="k">as</span> <span class="n">root</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">413</span>         <span class="n">ds</span> <span class="o">=</span> <span class="n">_nc4_require_group</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">414</span>     <span class="k">return</span> <span class="n">ds</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/contextlib.py:119,</span> in <span class="ni">_GeneratorContextManager.__enter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
<span class="g g-Whitespace">    </span><span class="mi">118</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">119</span>     <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">120</span> <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">121</span>     <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;generator didn&#39;t yield&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/backends/file_manager.py:199,</span> in <span class="ni">CachingFileManager.acquire_context</span><span class="nt">(self, needs_lock)</span>
<span class="g g-Whitespace">    </span><span class="mi">196</span> <span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="g g-Whitespace">    </span><span class="mi">197</span> <span class="k">def</span> <span class="nf">acquire_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">needs_lock</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">198</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Context manager for acquiring a file.&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">199</span>     <span class="n">file</span><span class="p">,</span> <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_acquire_with_cache_info</span><span class="p">(</span><span class="n">needs_lock</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">200</span>     <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">201</span>         <span class="k">yield</span> <span class="n">file</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/backends/file_manager.py:217,</span> in <span class="ni">CachingFileManager._acquire_with_cache_info</span><span class="nt">(self, needs_lock)</span>
<span class="g g-Whitespace">    </span><span class="mi">215</span>     <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span>     <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span>
<span class="ne">--&gt; </span><span class="mi">217</span> <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opener</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span>     <span class="c1"># ensure file doesn&#39;t get overridden when opened again</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>

<span class="nn">File src/netCDF4/_netCDF4.pyx:2469,</span> in <span class="ni">netCDF4._netCDF4.Dataset.__init__</span><span class="nt">()</span>

<span class="nn">File src/netCDF4/_netCDF4.pyx:2028,</span> in <span class="ni">netCDF4._netCDF4._ensure_nc_success</span><span class="nt">()</span>

<span class="ne">PermissionError</span>: [Errno 13] Permission denied: &#39;/Users/jfiedler/Documents/Repositories/SL_Hawaii/SL_Hawaii/data/rsl_hawaii.nc&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="retrieve-data-from-noaa-co-ops-api">
<h2>Retrieve data from NOAA CO-OPS API<a class="headerlink" href="#retrieve-data-from-noaa-co-ops-api" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://api.tidesandcurrents.noaa.gov/mdapi/prod/webapi/stations.json&quot;</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># get a list of all the stations</span>
<span class="n">stations</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

<span class="c1">#from list of stations, get NOAA stations within the bounding box of UHSLC gauges</span>
<span class="n">hawaii_stations</span> <span class="o">=</span> <span class="p">[</span><span class="n">station</span> <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">[</span><span class="s1">&#39;stations&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">station</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">station</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">station</span><span class="p">[</span><span class="s1">&#39;lng&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">-</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">station</span><span class="p">[</span><span class="s1">&#39;lng&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>

<span class="c1">#make a dictionary of all stations in hawaii with station name: station id</span>
<span class="n">stationdictNOAA</span>  <span class="o">=</span> <span class="p">{</span><span class="n">station</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span> <span class="n">station</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">hawaii_stations</span><span class="p">}</span>
<span class="n">stationdictNOAA</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Nawiliwili&#39;: &#39;1611400&#39;,
 &#39;Honolulu&#39;: &#39;1612340&#39;,
 &#39;Pearl Harbor&#39;: &#39;1612401&#39;,
 &#39;Mokuoloe&#39;: &#39;1612480&#39;,
 &#39;Kahului, Kahului Harbor&#39;: &#39;1615680&#39;,
 &#39;Kawaihae&#39;: &#39;1617433&#39;,
 &#39;Hilo, Hilo Bay, Kuhio Bay&#39;: &#39;1617760&#39;,
 &#39;Sand Island, Midway Islands&#39;: &#39;1619910&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span><span class="p">,</span> <span class="n">as_completed</span>

<span class="k">def</span> <span class="nf">fetch_data_chunk</span><span class="p">(</span><span class="n">stationID</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>
    <span class="c1"># Format dates for the URL</span>
    <span class="n">begin_date_str</span> <span class="o">=</span> <span class="n">start_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1"> %H:%M&#39;</span><span class="p">)</span>
    <span class="n">end_date_str</span> <span class="o">=</span> <span class="n">end_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1"> %H:%M&#39;</span><span class="p">)</span>
    
    <span class="c1"># Create the URL</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=</span><span class="si">{</span><span class="n">begin_date_str</span><span class="si">}</span><span class="s1">&amp;end_date=</span><span class="si">{</span><span class="n">end_date_str</span><span class="si">}</span><span class="s1">&amp;station=</span><span class="si">{</span><span class="n">stationID</span><span class="si">}</span><span class="s1">&amp;datum=STND&amp;product=water_level&amp;units=metric&amp;time_zone=gmt&amp;format=json&#39;</span>
    
    <span class="c1"># Request data from NOAA API</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    
    <span class="c1"># Check if the request was successful</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">if</span> <span class="s1">&#39;data&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># print(f&quot;No &#39;data&#39; key in response for {begin_date_str} to {end_date_str}: {data}&quot;)</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;JSON decoding failed for </span><span class="si">{</span><span class="n">begin_date_str</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_date_str</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># print(f&quot;Failed to fetch data for {begin_date_str} to {end_date_str}, status code: {response.status_code}&quot;)</span>
        <span class="k">return</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">fetch_noaa_water_level_parallel</span><span class="p">(</span><span class="n">stationID</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>
    <span class="c1"># Convert dates to datetime objects</span>
    <span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1"> %H:%M&#39;</span><span class="p">)</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">end_date</span><span class="p">,</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1"> %H:%M&#39;</span><span class="p">)</span>
    
    <span class="c1"># List to hold all data</span>
    <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># Generate date ranges in 31-day increments</span>
    <span class="n">date_ranges</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_start_date</span> <span class="o">=</span> <span class="n">start_date</span>
    <span class="k">while</span> <span class="n">current_start_date</span> <span class="o">&lt;</span> <span class="n">end_date</span><span class="p">:</span>
        <span class="n">current_end_date</span> <span class="o">=</span> <span class="n">current_start_date</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">31</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">current_end_date</span> <span class="o">&gt;</span> <span class="n">end_date</span><span class="p">:</span>
            <span class="n">current_end_date</span> <span class="o">=</span> <span class="n">end_date</span>
        <span class="n">date_ranges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">current_start_date</span><span class="p">,</span> <span class="n">current_end_date</span><span class="p">))</span>
        <span class="n">current_start_date</span> <span class="o">=</span> <span class="n">current_end_date</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">total_ranges</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">date_ranges</span><span class="p">)</span>
    
    <span class="c1"># Fetch data in parallel</span>
    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="n">future_to_date_range</span> <span class="o">=</span> <span class="p">{</span><span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">fetch_data_chunk</span><span class="p">,</span> <span class="n">stationID</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">date_ranges</span><span class="p">}</span>
        <span class="n">completed_ranges</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">as_completed</span><span class="p">(</span><span class="n">future_to_date_range</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data_chunk</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">data_chunk</span><span class="p">:</span>
                    <span class="n">all_data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">data_chunk</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">future_to_date_range</span><span class="p">[</span><span class="n">future</span><span class="p">]</span>
                <span class="c1"># print(f&quot;Error fetching data for {start} to {end}: {e}&quot;)  #uncomment if you want to track progress</span>
            
            <span class="n">completed_ranges</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># print(f&quot;Progress: {completed_ranges}/{total_ranges} chunks completed.&quot;) #uncomment if you want to track progress</span>
    
    <span class="c1"># Convert to DataFrame</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_data</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        
        <span class="c1"># Clean data: remove rows with empty &#39;v&#39; values</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
        
        <span class="c1"># Convert &#39;v&#39; to float</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        
        <span class="c1"># Remove duplicates</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        
        <span class="c1"># Sort by time</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        
        <span class="c1"># Create time series</span>
        <span class="n">sea_level_ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        
        <span class="c1"># Resample to hourly data</span>
        <span class="n">sea_level_ts</span> <span class="o">=</span> <span class="n">sea_level_ts</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        
        <span class="c1"># Ensure unique timestamps for xarray</span>
        <span class="n">sea_level_ts</span> <span class="o">=</span> <span class="n">sea_level_ts</span><span class="p">[</span><span class="o">~</span><span class="n">sea_level_ts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)]</span>
        
        <span class="c1"># Create xarray dataset with the correct dimension</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span><span class="s1">&#39;sea_level&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">sea_level_ts</span><span class="o">.</span><span class="n">values</span><span class="p">)},</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="n">sea_level_ts</span><span class="o">.</span><span class="n">index</span><span class="p">})</span>

        <span class="c1"># rename t to time</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">})</span>
        
        
        <span class="k">return</span> <span class="n">ds</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data fetched.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="s1">&#39;19050101 00:00&#39;</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="s1">&#39;20241231 00:00&#39;</span>

<span class="k">for</span> <span class="n">station_name</span><span class="p">,</span> <span class="n">station_id</span> <span class="ow">in</span> <span class="n">stationdictNOAA</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="c1"># check if we already have the data</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;tide_gauge_nc/noaa_</span><span class="si">{</span><span class="n">station_id</span><span class="si">}</span><span class="s1">.nc&#39;</span><span class="p">):</span>
        <span class="c1">#check last date in nc file</span>
        <span class="n">dsOLD</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;tide_gauge_nc/noaa_</span><span class="si">{</span><span class="n">station_id</span><span class="si">}</span><span class="s1">.nc&#39;</span><span class="p">)</span>
        <span class="n">last_date</span> <span class="o">=</span> <span class="n">dsOLD</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dsOLD</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1"># if last date is after end_date, skip</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">last_date</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">end_date</span><span class="p">,</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1"> %H:%M&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data for </span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s2"> already exists and is up to date, skipping&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">last_date</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">end_date</span><span class="p">,</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1"> %H:%M&#39;</span><span class="p">):</span>
            <span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">last_date</span><span class="p">)</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">start_date</span> <span class="o">=</span> <span class="n">start_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1"> %H:%M&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data for </span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s2"> already exists, will append from </span><span class="si">{</span><span class="n">start_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetching data for </span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">continue</span>

    <span class="n">ds</span> <span class="o">=</span> <span class="n">fetch_noaa_water_level_parallel</span><span class="p">(</span><span class="n">station_id</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
    <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">station_id</span>
    <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">station_name</span>
    <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;USA&#39;</span>
    <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">([</span><span class="n">station</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">hawaii_stations</span> <span class="k">if</span> <span class="n">station</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">station_id</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">([</span><span class="n">station</span><span class="p">[</span><span class="s1">&#39;lng&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">hawaii_stations</span> <span class="k">if</span> <span class="n">station</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">station_id</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># if the file already exists, append the new data</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;tide_gauge_nc/noaa_</span><span class="si">{</span><span class="n">station_id</span><span class="si">}</span><span class="s1">.nc&#39;</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;tide_gauge_nc/noaa_</span><span class="si">{</span><span class="n">station_id</span><span class="si">}</span><span class="s1">.nc&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dsOLD</span><span class="p">:</span>
            <span class="n">dsNEW</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dsOLD</span><span class="p">,</span> <span class="n">ds</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">dsNEW</span> <span class="o">=</span> <span class="n">dsNEW</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">dsNEW</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;tide_gauge_nc/noaa_</span><span class="si">{</span><span class="n">station_id</span><span class="si">}</span><span class="s1">.nc&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span>  <span class="sa">f</span><span class="s1">&#39;tide_gauge_nc/noaa_</span><span class="si">{</span><span class="n">station_id</span><span class="si">}</span><span class="s1">.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data for Nawiliwili already exists and is up to date, skipping
Data for Honolulu already exists and is up to date, skipping
Data for Pearl Harbor already exists and is up to date, skipping
Data for Mokuoloe already exists and is up to date, skipping
Data for Kahului, Kahului Harbor already exists and is up to date, skipping
Data for Kawaihae already exists and is up to date, skipping
Data for Hilo, Hilo Bay, Kuhio Bay already exists and is up to date, skipping
Data for Sand Island, Midway Islands already exists and is up to date, skipping
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsOLD</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;tide_gauge_nc/noaa_</span><span class="si">{</span><span class="n">station_id</span><span class="si">}</span><span class="s1">.nc&#39;</span><span class="p">)</span>
<span class="n">dsOLD</span>

<span class="c1"># only sea_level should have the time dimension, lat and lon should be scalars</span>
<span class="k">def</span> <span class="nf">remove_time_dim</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var</span> <span class="o">!=</span> <span class="s1">&#39;sea_level&#39;</span> <span class="ow">and</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
            <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>

<span class="n">dsOLD</span> <span class="o">=</span> <span class="n">remove_time_dim</span><span class="p">(</span><span class="n">dsOLD</span><span class="p">)</span>
<span class="n">dsOLD</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 4MB
Dimensions:          (time: 269593)
Coordinates:
  * time             (time) datetime64[ns] 2MB 1994-03-31 ... 2024-12-31
Data variables:
    sea_level        (time) float64 2MB ...
    station_id       &lt;U7 28B ...
    station_name     &lt;U27 108B ...
    station_country  &lt;U3 12B ...
    lat              float64 8B ...
    lon              float64 8B ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-f80cb78a-92f2-4a78-a13b-4e253f9710fd' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f80cb78a-92f2-4a78-a13b-4e253f9710fd' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 269593</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-46f83e82-f448-4c6c-8951-8f550df7a34f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-46f83e82-f448-4c6c-8951-8f550df7a34f' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1994-03-31 ... 2024-12-31</div><input id='attrs-2599d81b-2aec-43db-bffa-6b977db52d10' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2599d81b-2aec-43db-bffa-6b977db52d10' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f19f4d35-70d3-47c8-9454-8168f52f9b53' class='xr-var-data-in' type='checkbox'><label for='data-f19f4d35-70d3-47c8-9454-8168f52f9b53' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1994-03-31T00:00:00.000000000&#x27;, &#x27;1994-03-31T01:00:00.000000000&#x27;,
       &#x27;1994-03-31T02:00:00.000000000&#x27;, ..., &#x27;2024-12-30T22:00:00.000000000&#x27;,
       &#x27;2024-12-30T23:00:00.000000000&#x27;, &#x27;2024-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8d23fa5b-c9be-40a8-954d-83287d0e795e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8d23fa5b-c9be-40a8-954d-83287d0e795e' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sea_level</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-c1a75b43-992b-4ce5-a43b-b07e6515d271' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c1a75b43-992b-4ce5-a43b-b07e6515d271' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-78ebe5b2-df5f-4a2f-9870-c072d1b1d39c' class='xr-var-data-in' type='checkbox'><label for='data-78ebe5b2-df5f-4a2f-9870-c072d1b1d39c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[269593 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_id</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-71784d2c-c6bb-4c2c-8642-6ce4e2a70c75' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-71784d2c-c6bb-4c2c-8642-6ce4e2a70c75' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3da6d0ce-b3a4-4fbd-b1b2-da2c57eb4d21' class='xr-var-data-in' type='checkbox'><label for='data-3da6d0ce-b3a4-4fbd-b1b2-da2c57eb4d21' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=&lt;U7]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_name</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U27</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-625b0044-0935-436a-8a7e-43ab950e5a3c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-625b0044-0935-436a-8a7e-43ab950e5a3c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb631752-abba-4e2f-b4fb-d1fd82f9f3b3' class='xr-var-data-in' type='checkbox'><label for='data-eb631752-abba-4e2f-b4fb-d1fd82f9f3b3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=&lt;U27]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U3</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-40f26da5-4bc3-4730-af5b-e8074d0f7b75' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-40f26da5-4bc3-4730-af5b-e8074d0f7b75' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12ea7b86-16bb-42dc-91fc-859497a8c236' class='xr-var-data-in' type='checkbox'><label for='data-12ea7b86-16bb-42dc-91fc-859497a8c236' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=&lt;U3]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-51ac4a11-3a98-4c52-ac1a-1116c98e0563' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-51ac4a11-3a98-4c52-ac1a-1116c98e0563' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a135e909-aaa2-4ea2-9b0c-7945832b6aa3' class='xr-var-data-in' type='checkbox'><label for='data-a135e909-aaa2-4ea2-9b0c-7945832b6aa3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8ca41362-d79e-42c5-a819-dd4e06955339' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8ca41362-d79e-42c5-a819-dd4e06955339' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-26487a8f-7a4e-4f06-95bc-ec6db3ee108f' class='xr-var-data-in' type='checkbox'><label for='data-26487a8f-7a4e-4f06-95bc-ec6db3ee108f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7c379166-2c1b-46cf-91fd-e4858e80f5d8' class='xr-section-summary-in' type='checkbox'  ><label for='section-7c379166-2c1b-46cf-91fd-e4858e80f5d8' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3391fd4e-a822-40e7-9c56-5bdfad152a3f' class='xr-index-data-in' type='checkbox'/><label for='index-3391fd4e-a822-40e7-9c56-5bdfad152a3f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1994-03-31 00:00:00&#x27;, &#x27;1994-03-31 01:00:00&#x27;,
               &#x27;1994-03-31 02:00:00&#x27;, &#x27;1994-03-31 03:00:00&#x27;,
               &#x27;1994-03-31 04:00:00&#x27;, &#x27;1994-03-31 05:00:00&#x27;,
               &#x27;1994-03-31 06:00:00&#x27;, &#x27;1994-03-31 07:00:00&#x27;,
               &#x27;1994-03-31 08:00:00&#x27;, &#x27;1994-03-31 09:00:00&#x27;,
               ...
               &#x27;2024-12-30 15:00:00&#x27;, &#x27;2024-12-30 16:00:00&#x27;,
               &#x27;2024-12-30 17:00:00&#x27;, &#x27;2024-12-30 18:00:00&#x27;,
               &#x27;2024-12-30 19:00:00&#x27;, &#x27;2024-12-30 20:00:00&#x27;,
               &#x27;2024-12-30 21:00:00&#x27;, &#x27;2024-12-30 22:00:00&#x27;,
               &#x27;2024-12-30 23:00:00&#x27;, &#x27;2024-12-31 00:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=269593, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-57d71a74-4a82-4ec8-b044-8a025c2a5983' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-57d71a74-4a82-4ec8-b044-8a025c2a5983' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>As before, we’ll combine them into one dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##COMMENTED OUT IF DATA HAS ALREADY BEEN COMBINED&lt; TO FIX LATER</span>
<span class="c1"># Load the data</span>

      
<span class="c1"># Get a list of all noaa*.nc files in the data directory</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="s1">&#39;tide_gauge_nc&#39;</span><span class="p">,</span><span class="s1">&#39;noaa*.nc&#39;</span><span class="p">))</span>

<span class="c1"># Open the datasets</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">]</span>
<span class="c1"># add the station_id as a coordinate</span>
<span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">remove_time_dim</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;station_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_id&#39;</span><span class="p">]</span>
<span class="n">rslNOAA</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;station_id&#39;</span><span class="p">)</span>

<span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;sea_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
<span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;sea_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Sea level, relative to station datum&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rslNOAA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 19MB
Dimensions:          (time: 269593, station_id: 8)
Coordinates:
  * time             (time) datetime64[ns] 2MB 1994-03-31 ... 2024-12-31
  * station_id       (station_id) &lt;U7 224B &#x27;1617760&#x27; &#x27;1619910&#x27; ... &#x27;1611400&#x27;
Data variables:
    sea_level        (station_id, time) float64 17MB nan nan nan ... 0.878 0.92
    station_name     (station_id) &lt;U27 864B &#x27;Hilo, Hilo Bay, Kuhio Bay&#x27; ... &#x27;...
    station_country  (station_id) &lt;U3 96B &#x27;USA&#x27; &#x27;USA&#x27; &#x27;USA&#x27; ... &#x27;USA&#x27; &#x27;USA&#x27;
    lat              (station_id) float64 64B 19.73 28.21 20.04 ... 21.3 21.95
    lon              (station_id) float64 64B -155.1 -177.4 ... -157.9 -159.4</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-30514110-34e6-4cb9-bbd2-a3fc09ddbcbc' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-30514110-34e6-4cb9-bbd2-a3fc09ddbcbc' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 269593</li><li><span class='xr-has-index'>station_id</span>: 8</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-12282c05-9b67-418a-b005-920aaf61d50c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-12282c05-9b67-418a-b005-920aaf61d50c' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1994-03-31 ... 2024-12-31</div><input id='attrs-c5cd92e0-d5d0-4bee-bd59-e04522fe2bd4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c5cd92e0-d5d0-4bee-bd59-e04522fe2bd4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20c315c8-1c28-4deb-87d1-4f0818f1daa2' class='xr-var-data-in' type='checkbox'><label for='data-20c315c8-1c28-4deb-87d1-4f0818f1daa2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1994-03-31T00:00:00.000000000&#x27;, &#x27;1994-03-31T01:00:00.000000000&#x27;,
       &#x27;1994-03-31T02:00:00.000000000&#x27;, ..., &#x27;2024-12-30T22:00:00.000000000&#x27;,
       &#x27;2024-12-30T23:00:00.000000000&#x27;, &#x27;2024-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>station_id</span></div><div class='xr-var-dims'>(station_id)</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>&#x27;1617760&#x27; &#x27;1619910&#x27; ... &#x27;1611400&#x27;</div><input id='attrs-43e2a284-d8c3-46f1-9915-221d96ce1b14' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-43e2a284-d8c3-46f1-9915-221d96ce1b14' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-86729689-fbdf-4e62-88ee-a85affe62912' class='xr-var-data-in' type='checkbox'><label for='data-86729689-fbdf-4e62-88ee-a85affe62912' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1617760&#x27;, &#x27;1619910&#x27;, &#x27;1617433&#x27;, &#x27;1612480&#x27;, &#x27;1612401&#x27;, &#x27;1615680&#x27;,
       &#x27;1612340&#x27;, &#x27;1611400&#x27;], dtype=&#x27;&lt;U7&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e598e9ec-a64b-4b28-8ecf-eb331eff1b4d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e598e9ec-a64b-4b28-8ecf-eb331eff1b4d' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sea_level</span></div><div class='xr-var-dims'>(station_id, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.822 0.878 0.92</div><input id='attrs-3aa7d81d-18a4-4968-8fde-9b174d3f3a07' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3aa7d81d-18a4-4968-8fde-9b174d3f3a07' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b276b19e-4905-4dd6-b08d-22311104093b' class='xr-var-data-in' type='checkbox'><label for='data-b276b19e-4905-4dd6-b08d-22311104093b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Sea level, relative to station datum</dd></dl></div><div class='xr-var-data'><pre>array([[  nan,   nan,   nan, ..., 1.626, 1.664, 1.715],
       [0.762, 0.817, 0.897, ..., 1.143, 1.139, 1.127],
       [  nan,   nan,   nan, ..., 0.997, 1.013, 1.072],
       ...,
       [  nan,   nan,   nan, ..., 1.139, 1.175, 1.155],
       [  nan,   nan,   nan, ..., 1.272, 1.298, 1.347],
       [  nan,   nan,   nan, ..., 0.822, 0.878, 0.92 ]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_name</span></div><div class='xr-var-dims'>(station_id)</div><div class='xr-var-dtype'>&lt;U27</div><div class='xr-var-preview xr-preview'>&#x27;Hilo, Hilo Bay, Kuhio Bay&#x27; ... ...</div><input id='attrs-67255f75-178a-4a4e-8418-b24fc4ba3648' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-67255f75-178a-4a4e-8418-b24fc4ba3648' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1a0333d-a402-43b7-ae47-447e0d8035cc' class='xr-var-data-in' type='checkbox'><label for='data-f1a0333d-a402-43b7-ae47-447e0d8035cc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Hilo, Hilo Bay, Kuhio Bay&#x27;, &#x27;Sand Island, Midway Islands&#x27;,
       &#x27;Kawaihae&#x27;, &#x27;Mokuoloe&#x27;, &#x27;Pearl Harbor&#x27;, &#x27;Kahului, Kahului Harbor&#x27;,
       &#x27;Honolulu&#x27;, &#x27;Nawiliwili&#x27;], dtype=&#x27;&lt;U27&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country</span></div><div class='xr-var-dims'>(station_id)</div><div class='xr-var-dtype'>&lt;U3</div><div class='xr-var-preview xr-preview'>&#x27;USA&#x27; &#x27;USA&#x27; &#x27;USA&#x27; ... &#x27;USA&#x27; &#x27;USA&#x27;</div><input id='attrs-ca4a1e41-ccd3-4b7f-8468-0b0d5dc9a108' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ca4a1e41-ccd3-4b7f-8468-0b0d5dc9a108' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6f379071-c65d-446b-ab3c-f4508d31213b' class='xr-var-data-in' type='checkbox'><label for='data-6f379071-c65d-446b-ab3c-f4508d31213b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;USA&#x27;, &#x27;USA&#x27;, &#x27;USA&#x27;, &#x27;USA&#x27;, &#x27;USA&#x27;, &#x27;USA&#x27;, &#x27;USA&#x27;, &#x27;USA&#x27;],
      dtype=&#x27;&lt;U3&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(station_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>19.73 28.21 20.04 ... 21.3 21.95</div><input id='attrs-fc6c2e53-9f33-402e-ae8c-15bfe15eb12b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fc6c2e53-9f33-402e-ae8c-15bfe15eb12b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1e00dd4-cc07-471f-bc5b-cdfd2af01a01' class='xr-var-data-in' type='checkbox'><label for='data-e1e00dd4-cc07-471f-bc5b-cdfd2af01a01' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([19.73028 , 28.211667, 20.0366  , 21.433056, 21.3675  , 20.895   ,
       21.303333, 21.9544  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(station_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-155.1 -177.4 ... -157.9 -159.4</div><input id='attrs-62cf9ef3-fbed-436f-9af3-d786de44d347' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-62cf9ef3-fbed-436f-9af3-d786de44d347' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8036f049-3dbd-40e7-bc12-f21638d55721' class='xr-var-data-in' type='checkbox'><label for='data-8036f049-3dbd-40e7-bc12-f21638d55721' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-155.06    , -177.36    , -155.8294  , -157.79    , -157.963898,
       -156.469167, -157.864528, -159.3561  ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-71d484b8-f518-44cc-827d-c584145dbcb5' class='xr-section-summary-in' type='checkbox'  ><label for='section-71d484b8-f518-44cc-827d-c584145dbcb5' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c77f642e-5e9a-4a07-a359-8c24055d0823' class='xr-index-data-in' type='checkbox'/><label for='index-c77f642e-5e9a-4a07-a359-8c24055d0823' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1994-03-31 00:00:00&#x27;, &#x27;1994-03-31 01:00:00&#x27;,
               &#x27;1994-03-31 02:00:00&#x27;, &#x27;1994-03-31 03:00:00&#x27;,
               &#x27;1994-03-31 04:00:00&#x27;, &#x27;1994-03-31 05:00:00&#x27;,
               &#x27;1994-03-31 06:00:00&#x27;, &#x27;1994-03-31 07:00:00&#x27;,
               &#x27;1994-03-31 08:00:00&#x27;, &#x27;1994-03-31 09:00:00&#x27;,
               ...
               &#x27;2024-12-30 15:00:00&#x27;, &#x27;2024-12-30 16:00:00&#x27;,
               &#x27;2024-12-30 17:00:00&#x27;, &#x27;2024-12-30 18:00:00&#x27;,
               &#x27;2024-12-30 19:00:00&#x27;, &#x27;2024-12-30 20:00:00&#x27;,
               &#x27;2024-12-30 21:00:00&#x27;, &#x27;2024-12-30 22:00:00&#x27;,
               &#x27;2024-12-30 23:00:00&#x27;, &#x27;2024-12-31 00:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=269593, freq=&#x27;h&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>station_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b836eb79-0862-4824-9a78-2e63093f32f4' class='xr-index-data-in' type='checkbox'/><label for='index-b836eb79-0862-4824-9a78-2e63093f32f4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;1617760&#x27;, &#x27;1619910&#x27;, &#x27;1617433&#x27;, &#x27;1612480&#x27;, &#x27;1612401&#x27;, &#x27;1615680&#x27;,
       &#x27;1612340&#x27;, &#x27;1611400&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;station_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-67eb470e-cf7f-46c4-8f99-d95c4eac9baa' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-67eb470e-cf7f-46c4-8f99-d95c4eac9baa' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Let’s add some more metadata to this dataset, including MSL and MHHW datums for each gauge.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MHHW</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;station_id&#39;</span><span class="p">]))</span>
<span class="n">MSL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;station_id&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;station_id&#39;</span><span class="p">])):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://api.tidesandcurrents.noaa.gov/mdapi/prod/webapi/stations/&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;station_id&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;/datums.json?units=metric&#39;</span>
    
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">datums</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">extract_datum_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">datum_name</span><span class="p">):</span>
        <span class="c1"># Iterate through the datums list</span>
        <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;datums&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="c1"># Check if the name matches the desired datum name</span>
            <span class="k">if</span> <span class="n">datum</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">datum_name</span><span class="p">:</span>
                <span class="c1"># Return the value if found</span>
                <span class="k">return</span> <span class="n">datum</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
        <span class="c1"># Return None if the datum name is not found</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="c1">#extract the MHHW and MSL datums</span>
    <span class="n">MHHW</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_datum_value</span><span class="p">(</span><span class="n">datums</span><span class="p">,</span> <span class="s1">&#39;MHHW&#39;</span><span class="p">)</span>
    <span class="n">MSL</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_datum_value</span><span class="p">(</span><span class="n">datums</span><span class="p">,</span> <span class="s1">&#39;MSL&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;MHHW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">MHHW</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s1">&#39;station_id&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;station_id&#39;</span><span class="p">:</span> <span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;station_id&#39;</span><span class="p">]})</span>
<span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;MHHW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
<span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;MHHW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Mean Higher High Water, rel. to station datum&#39;</span>

<span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;MSL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">MSL</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s1">&#39;station_id&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;station_id&#39;</span><span class="p">:</span> <span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;station_id&#39;</span><span class="p">]})</span>
<span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;MSL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
<span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;MSL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Mean Sea Level, rel. to station datum&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Change the longitude to match UHSLC 360-degree convention.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rslNOAA</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">360</span>
<span class="n">rslNOAA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 19MB
Dimensions:          (time: 269593, station_id: 8)
Coordinates:
  * time             (time) datetime64[ns] 2MB 1994-03-31 ... 2024-12-31
  * station_id       (station_id) &lt;U7 224B &#x27;1617760&#x27; &#x27;1619910&#x27; ... &#x27;1611400&#x27;
Data variables:
    sea_level        (station_id, time) float64 17MB nan nan nan ... 0.878 0.92
    station_name     (station_id) &lt;U27 864B &#x27;Hilo, Hilo Bay, Kuhio Bay&#x27; ... &#x27;...
    station_country  (station_id) &lt;U3 96B &#x27;USA&#x27; &#x27;USA&#x27; &#x27;USA&#x27; ... &#x27;USA&#x27; &#x27;USA&#x27;
    lat              (station_id) float64 64B 19.73 28.21 20.04 ... 21.3 21.95
    lon              (station_id) float64 64B 204.9 182.6 204.2 ... 202.1 200.6
    MHHW             (station_id) float64 64B 1.927 1.206 1.444 ... 1.741 1.255
    MSL              (station_id) float64 64B 1.545 1.02 1.08 ... 1.412 0.949</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-575283f9-d670-4b6d-aa85-db9ea7ae016a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-575283f9-d670-4b6d-aa85-db9ea7ae016a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 269593</li><li><span class='xr-has-index'>station_id</span>: 8</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-9fc55200-1433-41c7-b679-7f1abe62f3dc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9fc55200-1433-41c7-b679-7f1abe62f3dc' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1994-03-31 ... 2024-12-31</div><input id='attrs-970c9f5b-f148-4527-8222-745618bf5525' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-970c9f5b-f148-4527-8222-745618bf5525' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d132a793-f746-4457-bdc7-4bd785db5877' class='xr-var-data-in' type='checkbox'><label for='data-d132a793-f746-4457-bdc7-4bd785db5877' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1994-03-31T00:00:00.000000000&#x27;, &#x27;1994-03-31T01:00:00.000000000&#x27;,
       &#x27;1994-03-31T02:00:00.000000000&#x27;, ..., &#x27;2024-12-30T22:00:00.000000000&#x27;,
       &#x27;2024-12-30T23:00:00.000000000&#x27;, &#x27;2024-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>station_id</span></div><div class='xr-var-dims'>(station_id)</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>&#x27;1617760&#x27; &#x27;1619910&#x27; ... &#x27;1611400&#x27;</div><input id='attrs-6212d875-5c54-401c-a26b-fd69446ddd3c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6212d875-5c54-401c-a26b-fd69446ddd3c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-decba43c-2759-40cb-8d13-29f2d1fc4d68' class='xr-var-data-in' type='checkbox'><label for='data-decba43c-2759-40cb-8d13-29f2d1fc4d68' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1617760&#x27;, &#x27;1619910&#x27;, &#x27;1617433&#x27;, &#x27;1612480&#x27;, &#x27;1612401&#x27;, &#x27;1615680&#x27;,
       &#x27;1612340&#x27;, &#x27;1611400&#x27;], dtype=&#x27;&lt;U7&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a6d81a23-1996-4539-ab20-87353c9de4a5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a6d81a23-1996-4539-ab20-87353c9de4a5' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sea_level</span></div><div class='xr-var-dims'>(station_id, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.822 0.878 0.92</div><input id='attrs-d933f8dc-db34-456c-a5d9-ddb2d8dc568a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d933f8dc-db34-456c-a5d9-ddb2d8dc568a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1df3c219-e653-41fa-b5e6-b354f90424b1' class='xr-var-data-in' type='checkbox'><label for='data-1df3c219-e653-41fa-b5e6-b354f90424b1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Sea level, relative to station datum</dd></dl></div><div class='xr-var-data'><pre>array([[  nan,   nan,   nan, ..., 1.626, 1.664, 1.715],
       [0.762, 0.817, 0.897, ..., 1.143, 1.139, 1.127],
       [  nan,   nan,   nan, ..., 0.997, 1.013, 1.072],
       ...,
       [  nan,   nan,   nan, ..., 1.139, 1.175, 1.155],
       [  nan,   nan,   nan, ..., 1.272, 1.298, 1.347],
       [  nan,   nan,   nan, ..., 0.822, 0.878, 0.92 ]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_name</span></div><div class='xr-var-dims'>(station_id)</div><div class='xr-var-dtype'>&lt;U27</div><div class='xr-var-preview xr-preview'>&#x27;Hilo, Hilo Bay, Kuhio Bay&#x27; ... ...</div><input id='attrs-635447a6-9cb1-43eb-abe6-f4856c5852be' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-635447a6-9cb1-43eb-abe6-f4856c5852be' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-147e029a-5180-416c-8963-1bc2d89ec7d3' class='xr-var-data-in' type='checkbox'><label for='data-147e029a-5180-416c-8963-1bc2d89ec7d3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Hilo, Hilo Bay, Kuhio Bay&#x27;, &#x27;Sand Island, Midway Islands&#x27;,
       &#x27;Kawaihae&#x27;, &#x27;Mokuoloe&#x27;, &#x27;Pearl Harbor&#x27;, &#x27;Kahului, Kahului Harbor&#x27;,
       &#x27;Honolulu&#x27;, &#x27;Nawiliwili&#x27;], dtype=&#x27;&lt;U27&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country</span></div><div class='xr-var-dims'>(station_id)</div><div class='xr-var-dtype'>&lt;U3</div><div class='xr-var-preview xr-preview'>&#x27;USA&#x27; &#x27;USA&#x27; &#x27;USA&#x27; ... &#x27;USA&#x27; &#x27;USA&#x27;</div><input id='attrs-76e63024-403e-441d-88e2-19f64c02ca70' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-76e63024-403e-441d-88e2-19f64c02ca70' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7ee86097-7713-4161-bf94-c2764f675dc0' class='xr-var-data-in' type='checkbox'><label for='data-7ee86097-7713-4161-bf94-c2764f675dc0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;USA&#x27;, &#x27;USA&#x27;, &#x27;USA&#x27;, &#x27;USA&#x27;, &#x27;USA&#x27;, &#x27;USA&#x27;, &#x27;USA&#x27;, &#x27;USA&#x27;],
      dtype=&#x27;&lt;U3&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(station_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>19.73 28.21 20.04 ... 21.3 21.95</div><input id='attrs-4e5c2a5c-2aa3-413a-8645-d47d02bf3942' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4e5c2a5c-2aa3-413a-8645-d47d02bf3942' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-83c161d7-7012-488f-9603-0eb1abe05434' class='xr-var-data-in' type='checkbox'><label for='data-83c161d7-7012-488f-9603-0eb1abe05434' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([19.73028 , 28.211667, 20.0366  , 21.433056, 21.3675  , 20.895   ,
       21.303333, 21.9544  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(station_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>204.9 182.6 204.2 ... 202.1 200.6</div><input id='attrs-2a662037-b104-4ec4-8d19-14b785cd22b4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2a662037-b104-4ec4-8d19-14b785cd22b4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e3e3a99a-2abb-4cbe-a6a4-2f8cab4ae13c' class='xr-var-data-in' type='checkbox'><label for='data-e3e3a99a-2abb-4cbe-a6a4-2f8cab4ae13c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([204.94    , 182.64    , 204.1706  , 202.21    , 202.036102,
       203.530833, 202.135472, 200.6439  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>MHHW</span></div><div class='xr-var-dims'>(station_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.927 1.206 1.444 ... 1.741 1.255</div><input id='attrs-1024dd41-efe0-4c5a-a150-7da37552599f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1024dd41-efe0-4c5a-a150-7da37552599f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-76cb5c3d-cf99-4ddd-ad1d-2a3fc372222b' class='xr-var-data-in' type='checkbox'><label for='data-76cb5c3d-cf99-4ddd-ad1d-2a3fc372222b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Mean Higher High Water, rel. to station datum</dd></dl></div><div class='xr-var-data'><pre>array([1.927, 1.206, 1.444, 1.536, 7.673, 1.422, 1.741, 1.255])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>MSL</span></div><div class='xr-var-dims'>(station_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.545 1.02 1.08 ... 1.412 0.949</div><input id='attrs-04ccf5d3-d0ea-4a8e-a550-f70c20c95ddf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-04ccf5d3-d0ea-4a8e-a550-f70c20c95ddf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2383c631-a119-44ac-8101-0920c72305a9' class='xr-var-data-in' type='checkbox'><label for='data-2383c631-a119-44ac-8101-0920c72305a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Mean Sea Level, rel. to station datum</dd></dl></div><div class='xr-var-data'><pre>array([1.545, 1.02 , 1.08 , 1.21 , 7.338, 1.075, 1.412, 0.949])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8605d5f6-766c-4e6e-8617-36b045c2f070' class='xr-section-summary-in' type='checkbox'  ><label for='section-8605d5f6-766c-4e6e-8617-36b045c2f070' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-293cbc04-e9a5-4760-82a1-29776100ed5e' class='xr-index-data-in' type='checkbox'/><label for='index-293cbc04-e9a5-4760-82a1-29776100ed5e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1994-03-31 00:00:00&#x27;, &#x27;1994-03-31 01:00:00&#x27;,
               &#x27;1994-03-31 02:00:00&#x27;, &#x27;1994-03-31 03:00:00&#x27;,
               &#x27;1994-03-31 04:00:00&#x27;, &#x27;1994-03-31 05:00:00&#x27;,
               &#x27;1994-03-31 06:00:00&#x27;, &#x27;1994-03-31 07:00:00&#x27;,
               &#x27;1994-03-31 08:00:00&#x27;, &#x27;1994-03-31 09:00:00&#x27;,
               ...
               &#x27;2024-12-30 15:00:00&#x27;, &#x27;2024-12-30 16:00:00&#x27;,
               &#x27;2024-12-30 17:00:00&#x27;, &#x27;2024-12-30 18:00:00&#x27;,
               &#x27;2024-12-30 19:00:00&#x27;, &#x27;2024-12-30 20:00:00&#x27;,
               &#x27;2024-12-30 21:00:00&#x27;, &#x27;2024-12-30 22:00:00&#x27;,
               &#x27;2024-12-30 23:00:00&#x27;, &#x27;2024-12-31 00:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=269593, freq=&#x27;h&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>station_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-274ec419-c3e4-4a20-a6da-3662bb37c5a4' class='xr-index-data-in' type='checkbox'/><label for='index-274ec419-c3e4-4a20-a6da-3662bb37c5a4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;1617760&#x27;, &#x27;1619910&#x27;, &#x27;1617433&#x27;, &#x27;1612480&#x27;, &#x27;1612401&#x27;, &#x27;1615680&#x27;,
       &#x27;1612340&#x27;, &#x27;1611400&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;station_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-04631609-b01c-4f35-abec-c18c5177860a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-04631609-b01c-4f35-abec-c18c5177860a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#save rsl to the data directory</span>
<span class="n">rslNOAA</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;rsl_hawaii_noaa.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="retrieve-altimetry-data">
<h2>Retrieve altimetry data<a class="headerlink" href="#retrieve-altimetry-data" title="Permalink to this heading">#</a></h2>
<p>We are using the global ocean gridded L4 <a class="reference external" href="https://doi.org/10.48670/moi-00148">Sea Surface Heights and Derived Variables</a> from Copernicus.</p>
<p>To download a subset of the global altimetry data, run get_CMEMS_data.py from this directory in a terminal with python &gt;= 3.9 + copernicus_marine_client installed OR uncomment out the call to get_CMEMS_data and run it in this notebook. To read more about how to download the data from the Copernicus Marine Toolbox (new as of December 2023), visit https://help.marine.copernicus.eu/en/articles/7949409-copernicus-marine-toolbox-introduction.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will need a username and password to access the CMEMS (Copernicus Marine Service) data if this is the first time running the client. To register for data access (free), visit https://data.marine.copernicus.eu/register.</p>
</div>
</aside>
<div class="warning admonition">
<p class="admonition-title">Large data download!</p>
<p>Getting errors on the code block below? Remember to uncomment “get_CMEMS_data()” to download. Note that if you change nothing in the function, it will download ~600 MB of data, which may take a long time!! You will only need to do this once. The dataset will be stored in the data directory you specify (which should be the same data directory we defined above).</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the min and max lat and lon of rsl for altimetry data retrieval</span>
<span class="n">minlat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rsl</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">maxlat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rsl</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">minlon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rsl</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">maxlon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rsl</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_CMEMS_data</span><span class="p">(</span><span class="n">minlat</span><span class="p">,</span> <span class="n">maxlat</span><span class="p">,</span> <span class="n">minlon</span><span class="p">,</span> <span class="n">maxlon</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">):</span>
        
    <span class="c1">#maxlat = 15</span>
    <span class="c1">#minlat = 0</span>
    <span class="c1">#minlon = 125</span>
    <span class="c1">#maxlon = 140</span>
    <span class="n">maxlat</span> <span class="o">=</span> <span class="n">maxlat</span><span class="o">+</span><span class="mi">2</span>
    <span class="n">minlat</span> <span class="o">=</span> <span class="n">minlat</span><span class="o">-</span><span class="mi">2</span>
    <span class="n">maxlon</span> <span class="o">=</span> <span class="n">maxlon</span><span class="o">+</span><span class="mi">2</span>
    <span class="n">minlon</span>  <span class="o">=</span> <span class="n">minlon</span><span class="o">-</span><span class="mi">2</span>
    
    <span class="n">start_date_str</span> <span class="o">=</span> <span class="s2">&quot;1993-01-01T00:00:00&quot;</span>
    <span class="n">end_date_str</span> <span class="o">=</span> <span class="s2">&quot;2024-04-30T23:59:59&quot;</span>
    <span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves Copernicus Marine data for a specified region and time period.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        minlon (float): Minimum longitude of the region.</span>
<span class="sd">        maxlon (float): Maximum longitude of the region.</span>
<span class="sd">        minlat (float): Minimum latitude of the region.</span>
<span class="sd">        maxlat (float): Maximum latitude of the region.</span>
<span class="sd">        start_date_str (str): Start date of the data in ISO 8601 format.</span>
<span class="sd">        end_date_str (str): End date of the data in ISO 8601 format.</span>
<span class="sd">        data_dir (str): Directory to save the retrieved data.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        str: The filename of the retrieved data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">copernicusmarine</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span>
        <span class="n">dataset_id</span><span class="o">=</span><span class="s2">&quot;cmems_obs-sl_glo_phy-ssh_my_allsat-l4-duacs-0.25deg_P1D&quot;</span><span class="p">,</span>
        <span class="n">dataset_version</span><span class="o">=</span><span class="s2">&quot;202112&quot;</span><span class="p">,</span>
        <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sla&quot;</span><span class="p">],</span>
        <span class="n">minimum_longitude</span><span class="o">=</span><span class="n">minlon</span><span class="p">,</span>
        <span class="n">maximum_longitude</span><span class="o">=</span><span class="n">maxlon</span><span class="p">,</span>
        <span class="n">minimum_latitude</span><span class="o">=</span><span class="n">minlat</span><span class="p">,</span>
        <span class="n">maximum_latitude</span><span class="o">=</span><span class="n">maxlat</span><span class="p">,</span>
        <span class="n">start_datetime</span><span class="o">=</span><span class="n">start_date_str</span><span class="p">,</span>
        <span class="n">end_datetime</span><span class="o">=</span><span class="n">end_date_str</span><span class="p">,</span>
        <span class="n">output_directory</span><span class="o">=</span><span class="n">data_dir</span><span class="p">,</span>
        <span class="n">output_filename</span><span class="o">=</span><span class="s2">&quot;cmems_L4_SSH_0.25deg_&quot;</span> <span class="o">+</span> <span class="n">start_date_str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">end_date_str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.nc&quot;</span>
    <span class="p">)</span>
<span class="n">fname_cmems</span> <span class="o">=</span> <span class="s1">&#39;cmems_L4_SSH_0.25deg_1993_2024.nc&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copernicusmarine</span>
<span class="c1"># check if the file exists, if not, download it</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="n">fname_cmems</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;You will need to download the CMEMS data in a separate script&#39;</span><span class="p">)</span>
    <span class="n">get_CMEMS_data</span><span class="p">(</span><span class="n">minlat</span><span class="p">,</span> <span class="n">maxlat</span><span class="p">,</span> <span class="n">minlon</span><span class="p">,</span> <span class="n">maxlon</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span> <span class="c1">#&lt;&lt;--- COMMENT OUT TO AVOID ACCIDENTAL DATA DOWNLOADS.</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CMEMS data already downloaded, good to go!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You will need to download the CMEMS data in a separate script
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">DatasetNotFound</span><span class="g g-Whitespace">                           </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">92</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="n">fname_cmems</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;You will need to download the CMEMS data in a separate script&#39;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">5</span>     <span class="n">get_CMEMS_data</span><span class="p">(</span><span class="n">minlat</span><span class="p">,</span> <span class="n">maxlat</span><span class="p">,</span> <span class="n">minlon</span><span class="p">,</span> <span class="n">maxlon</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span> <span class="c1">#&lt;&lt;--- COMMENT OUT TO AVOID ACCIDENTAL DATA DOWNLOADS.</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CMEMS data already downloaded, good to go!&#39;</span><span class="p">)</span>

<span class="nn">Cell In[90], line 31,</span> in <span class="ni">get_CMEMS_data</span><span class="nt">(minlat, maxlat, minlon, maxlon, data_dir)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span><span class="sd"> Retrieves Copernicus Marine data for a specified region and time period.</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span><span class="sd">     str: The filename of the retrieved data.</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="ne">---&gt; </span><span class="mi">31</span> <span class="n">copernicusmarine</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span>     <span class="n">dataset_id</span><span class="o">=</span><span class="s2">&quot;cmems_obs-sl_glo_phy-ssh_my_allsat-l4-duacs-0.25deg_P1D&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span>     <span class="n">dataset_version</span><span class="o">=</span><span class="s2">&quot;202112&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span>     <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sla&quot;</span><span class="p">],</span>
<span class="g g-Whitespace">     </span><span class="mi">35</span>     <span class="n">minimum_longitude</span><span class="o">=</span><span class="n">minlon</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">36</span>     <span class="n">maximum_longitude</span><span class="o">=</span><span class="n">maxlon</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span>     <span class="n">minimum_latitude</span><span class="o">=</span><span class="n">minlat</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span>     <span class="n">maximum_latitude</span><span class="o">=</span><span class="n">maxlat</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span>     <span class="n">start_datetime</span><span class="o">=</span><span class="n">start_date_str</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span>     <span class="n">end_datetime</span><span class="o">=</span><span class="n">end_date_str</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="n">output_directory</span><span class="o">=</span><span class="n">data_dir</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>     <span class="n">output_filename</span><span class="o">=</span><span class="s2">&quot;cmems_L4_SSH_0.25deg_&quot;</span> <span class="o">+</span> <span class="n">start_date_str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">end_date_str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.nc&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span> <span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/copernicusmarine/core_functions/deprecated_options.py:78,</span> in <span class="ni">deprecated_python_option.&lt;locals&gt;.deco.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">75</span> <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span> <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">77</span>     <span class="n">rename_kwargs</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">aliases</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">78</span>     <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/copernicusmarine/python_interface/exception_handler.py:17,</span> in <span class="ni">log_exception_and_exit.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Abort&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">17</span>     <span class="k">raise</span> <span class="n">exception</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/copernicusmarine/python_interface/exception_handler.py:13,</span> in <span class="ni">log_exception_and_exit.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="nd">@wraps</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">13</span>         <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span>     <span class="k">except</span> <span class="n">click</span><span class="o">.</span><span class="n">Abort</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span>         <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Abort&quot;</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/copernicusmarine/python_interface/subset.py:152,</span> in <span class="ni">subset</span><span class="nt">(dataset_id, dataset_version, dataset_part, username, password, variables, minimum_longitude, maximum_longitude, minimum_latitude, maximum_latitude, minimum_depth, maximum_depth, vertical_axis, start_datetime, end_datetime, coordinates_selection_method, output_filename, file_format, service, request_file, output_directory, credentials_file, motu_api_request, overwrite, skip_existing, dry_run, disable_progress_bar, staging, netcdf_compression_level, netcdf3_compatible, chunk_size_limit)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span> <span class="n">start_datetime</span> <span class="o">=</span> <span class="n">homogenize_datetime</span><span class="p">(</span><span class="n">start_datetime</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span> <span class="n">end_datetime</span> <span class="o">=</span> <span class="n">homogenize_datetime</span><span class="p">(</span><span class="n">end_datetime</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">152</span> <span class="k">return</span> <span class="n">subset_function</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span>     <span class="n">dataset_id</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span>     <span class="n">dataset_version</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span>     <span class="n">dataset_part</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span>     <span class="n">username</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">157</span>     <span class="n">password</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">158</span>     <span class="n">variables</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">159</span>     <span class="n">minimum_longitude</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">160</span>     <span class="n">maximum_longitude</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span>     <span class="n">minimum_latitude</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">162</span>     <span class="n">maximum_latitude</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">163</span>     <span class="n">minimum_depth</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">164</span>     <span class="n">maximum_depth</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">165</span>     <span class="n">vertical_axis</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span>     <span class="n">start_datetime</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">167</span>     <span class="n">end_datetime</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">168</span>     <span class="n">coordinates_selection_method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span>     <span class="n">output_filename</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span>     <span class="n">file_format</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">171</span>     <span class="n">service</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">172</span>     <span class="n">request_file</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">173</span>     <span class="n">output_directory</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">174</span>     <span class="n">credentials_file</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">175</span>     <span class="n">motu_api_request</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">176</span>     <span class="n">overwrite</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span>     <span class="n">skip_existing</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">178</span>     <span class="n">dry_run</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span>     <span class="n">disable_progress_bar</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span>     <span class="n">staging</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span>     <span class="n">netcdf_compression_level</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">182</span>     <span class="n">netcdf3_compatible</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">183</span>     <span class="n">chunk_size_limit</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">184</span> <span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/copernicusmarine/core_functions/subset.py:154,</span> in <span class="ni">subset_function</span><span class="nt">(dataset_id, force_dataset_version, force_dataset_part, username, password, variables, minimum_longitude, maximum_longitude, minimum_latitude, maximum_latitude, minimum_depth, maximum_depth, vertical_axis, start_datetime, end_datetime, coordinates_selection_method, output_filename, file_format, force_service, request_file, output_directory, credentials_file, motu_api_request, overwrite, skip_existing, dry_run, disable_progress_bar, staging, netcdf_compression_level, netcdf3_compatible, chunk_size_limit)</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span> <span class="k">if</span> <span class="n">skip_existing</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span>     <span class="n">subset_request</span><span class="o">.</span><span class="n">skip_existing</span> <span class="o">=</span> <span class="n">skip_existing</span>
<span class="ne">--&gt; </span><span class="mi">154</span> <span class="n">retrieval_service</span><span class="p">:</span> <span class="n">RetrievalService</span> <span class="o">=</span> <span class="n">get_retrieval_service</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span>     <span class="n">subset_request</span><span class="o">.</span><span class="n">dataset_id</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span>     <span class="n">subset_request</span><span class="o">.</span><span class="n">force_dataset_version</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">157</span>     <span class="n">subset_request</span><span class="o">.</span><span class="n">force_dataset_part</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">158</span>     <span class="n">subset_request</span><span class="o">.</span><span class="n">force_service</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">159</span>     <span class="n">CommandType</span><span class="o">.</span><span class="n">SUBSET</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">160</span>     <span class="n">dataset_subset</span><span class="o">=</span><span class="n">subset_request</span><span class="o">.</span><span class="n">get_time_and_space_subset</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span>     <span class="n">staging</span><span class="o">=</span><span class="n">staging</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">162</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">163</span> <span class="n">subset_request</span><span class="o">.</span><span class="n">dataset_url</span> <span class="o">=</span> <span class="n">retrieval_service</span><span class="o">.</span><span class="n">uri</span>
<span class="g g-Whitespace">    </span><span class="mi">164</span> <span class="n">check_dataset_subset_bounds</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">165</span>     <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span>     <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">172</span>     <span class="n">is_original_grid</span><span class="o">=</span><span class="n">retrieval_service</span><span class="o">.</span><span class="n">is_original_grid</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">173</span> <span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/copernicusmarine/core_functions/services_utils.py:283,</span> in <span class="ni">get_retrieval_service</span><span class="nt">(dataset_id, force_dataset_version_label, force_dataset_part_label, force_service_name_or_short_name, command_type, dataset_subset, username, staging)</span>
<span class="g g-Whitespace">    </span><span class="mi">273</span> <span class="k">def</span> <span class="nf">get_retrieval_service</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">274</span>     <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">275</span>     <span class="n">force_dataset_version_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">281</span>     <span class="n">staging</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">282</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RetrievalService</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">283</span>     <span class="n">dataset_metadata</span> <span class="o">=</span> <span class="n">get_dataset_metadata</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">,</span> <span class="n">staging</span><span class="o">=</span><span class="n">staging</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">284</span>     <span class="c1"># logger.debug(dataset_metadata)</span>
<span class="g g-Whitespace">    </span><span class="mi">285</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">dataset_metadata</span><span class="p">:</span>

<span class="nn">File /opt/anaconda3/envs/SLI39/lib/python3.9/site-packages/copernicusmarine/catalogue_parser/catalogue_parser.py:65,</span> in <span class="ni">get_dataset_metadata</span><span class="nt">(dataset_id, staging)</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span> <span class="n">product_ids</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">get_json_file</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span>     <span class="n">dataset_product_mapping_url</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span> <span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">product_ids</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">65</span>     <span class="k">raise</span> <span class="n">DatasetNotFound</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">66</span> <span class="n">dataset_jsons</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">     </span><span class="mi">67</span> <span class="k">for</span> <span class="n">product_id</span> <span class="ow">in</span> <span class="n">product_ids</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>

<span class="ne">DatasetNotFound</span>: cmems_obs-sl_glo_phy-ssh_my_allsat-l4-duacs-0.25deg_P1D Please check that the dataset exists and the input datasetID is correct.
</pre></div>
</div>
</div>
</div>
<p>Open up the CMEMS data and take a look. We will want to make an ASL dataset similar in structure to the RSL data so that we can easily compare the two.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># open the CMEMS data</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="n">fname_cmems</span><span class="p">)</span>

<span class="n">ds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rsl</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract data for the nearest point to the tide gauge location that has data</span>
<span class="n">sla</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="n">sla</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;sla&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
        <span class="n">longitude</span><span class="o">=</span><span class="n">lon</span><span class="o">-</span><span class="mi">360</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span>
    <span class="p">))</span>

    <span class="c1">#if the data is null, nan average over the nearest 4 points</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">0.25</span>
    <span class="k">if</span> <span class="n">sla</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">sla</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;sla&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
            <span class="n">longitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon</span><span class="o">-</span><span class="mi">360</span><span class="o">-</span><span class="n">tol</span><span class="p">,</span> <span class="n">lon</span><span class="o">-</span><span class="mi">360</span><span class="o">+</span><span class="n">tol</span><span class="p">),</span> 
            <span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lat</span><span class="o">-</span><span class="n">tol</span><span class="p">,</span> <span class="n">lat</span><span class="o">+</span><span class="n">tol</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
        <span class="n">sla</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
        <span class="n">sla</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>

<span class="n">sla</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">sla</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;record_id&#39;</span><span class="p">)</span>

<span class="c1"># make sla a dataset with variables from rsl</span>
<span class="n">sla</span> <span class="o">=</span> <span class="n">sla</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;sla&#39;</span><span class="p">)</span>
<span class="n">sla</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span>

<span class="c1"># Creating lat_str and lon_str arrays with &#39;record_id&#39; as their dimension</span>
<span class="n">lat_str</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="se">\u00B0</span><span class="si">{</span><span class="s2">&quot;N&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;S&quot;</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">lat</span> <span class="ow">in</span> <span class="n">sla</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">lon_str</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="se">\u00B0</span><span class="si">{</span><span class="s2">&quot;E&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;W&quot;</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">lon</span> <span class="ow">in</span> <span class="n">sla</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>  

<span class="c1"># Convert lists to DataArrays with &#39;record_id&#39; as their dimension</span>
<span class="n">lat_str_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">lat_str</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;record_id&#39;</span><span class="p">:</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]})</span>
<span class="n">lon_str_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">lon_str</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;record_id&#39;</span><span class="p">:</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]})</span>

<span class="c1"># Assign these DataArrays to the sla dataset</span>
<span class="n">sla</span><span class="p">[</span><span class="s1">&#39;lat_str&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat_str_da</span>
<span class="n">sla</span><span class="p">[</span><span class="s1">&#39;lon_str&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lon_str_da</span>

<span class="c1"># add original data source to attributes</span>
<span class="n">sla</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;original_data_source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;CMEMS L4 SSH 0.25deg&#39;</span>
<span class="n">sla</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="n">sla</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;source_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="n">fname_cmems</span><span class="p">)</span>

<span class="c1"># ensure latitude and longitude are coordinates associated with a location</span>
<span class="n">sla</span> <span class="o">=</span> <span class="n">sla</span><span class="o">.</span><span class="n">set_coords</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span>



<span class="n">sla</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#save sla to the data directory</span>
<span class="n">sla</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;asl_hawaii.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="processing">
<h2>Processing<a class="headerlink" href="#processing" title="Permalink to this heading">#</a></h2>
<section id="process-the-tide-gauge-data-to-match-cmems">
<h3>Process the tide gauge data to match CMEMS<a class="headerlink" href="#process-the-tide-gauge-data-to-match-cmems" title="Permalink to this heading">#</a></h3>
<p>Now we’ll convert tide gauge data into a daily record for the POR in units of meters to match the CMEMS data.</p>
<p>The next code block:</p>
<ul class="simple">
<li><p>extracts tide gauge data for the period 1993-2022</p></li>
<li><p>converts it to meters</p></li>
<li><p>removes any NaN values</p></li>
<li><p>resamples the data to daily mean</p></li>
<li><p>and normalizes it relative to the 1993-2012 epoch.</p></li>
</ul>
<p>The resulting data is stored in the variable ‘rsl_daily’ with units in meters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Next, let&#39;s establish a period of record from 1993-2022.</span>
<span class="c1"># establish the time period of interest</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1993</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># also save them as strings, for plotting</span>
<span class="n">start_date_str</span> <span class="o">=</span> <span class="n">start_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">end_date_str</span> <span class="o">=</span> <span class="n">end_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract the data for the period of record (POR)</span>
<span class="n">tide_gauge_data_POR</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;sea_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">))</span>

<span class="c1"># Convert to meters and drop any NaN values</span>
<span class="n">tide_gauge_data_meters</span> <span class="o">=</span> <span class="n">tide_gauge_data_POR</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># Convert from mm to meters</span>
<span class="c1"># tide_gauge_data_clean = tide_gauge_data_meters.dropna(dim=&#39;time&#39;)</span>

<span class="c1"># Resample the tide gauge data to daily mean before subtracting the epoch mean</span>
<span class="n">tide_gauge_daily_avg</span> <span class="o">=</span> <span class="n">tide_gauge_data_meters</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tide_gauge_daily_avg</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="normalize-the-tide-gauge-data-relative-to-the-1993-2012-epoch">
<h3>Normalize the tide gauge data relative to the 1993-2012 epoch<a class="headerlink" href="#normalize-the-tide-gauge-data-relative-to-the-1993-2012-epoch" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epoch_start</span><span class="p">,</span> <span class="n">epoch_end</span> <span class="o">=</span> <span class="n">start_date</span><span class="p">,</span> <span class="s1">&#39;2011-12-31&#39;</span>
<span class="n">epoch_daily_avg</span> <span class="o">=</span> <span class="n">tide_gauge_daily_avg</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">epoch_start</span><span class="p">,</span> <span class="n">epoch_end</span><span class="p">))</span>
<span class="n">epoch_daily_mean</span> <span class="o">=</span> <span class="n">epoch_daily_avg</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tide_gauge_data_POR</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subtract the epoch daily mean from the tide gauge daily average</span>
<span class="n">rsl_daily</span> <span class="o">=</span> <span class="n">tide_gauge_daily_avg</span> <span class="o">-</span> <span class="n">epoch_daily_mean</span>

<span class="c1"># Set the attributes of the rsl_daily data</span>
<span class="n">rsl_daily</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">tide_gauge_data_POR</span><span class="o">.</span><span class="n">attrs</span>
<span class="n">rsl_daily</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>

<span class="c1"># add lat and lon to the dataset</span>
<span class="n">rsl_daily</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span>
<span class="n">rsl_daily</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span>

<span class="c1"># add the station name and country</span>
<span class="n">rsl_daily</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span>

<span class="c1"># change the variable name to sea level anomaly</span>
<span class="n">rsl_daily</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;rsl_anomaly&#39;</span>

<span class="c1"># change long name of the variable to sea level anomaly</span>
<span class="n">rsl_daily</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Sea Level Anomaly&#39;</span>
<span class="n">rsl_daily</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;epoch&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1993-2001&#39;</span>

<span class="n">rsl_daily</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">rsl_daily</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;record_id&#39;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Use g.axs to iterate over the axes in the FacetGrid</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">rid</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">rsl_daily</span><span class="o">.</span><span class="n">record_id</span><span class="p">):</span>
    <span class="c1"># Accessing the station_name coordinate for the current record_id directly</span>
    <span class="n">station_name</span> <span class="o">=</span> <span class="n">rsl_daily</span><span class="o">.</span><span class="n">station_name</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">record_id</span><span class="o">=</span><span class="n">rid</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">station_name</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set tide gauge daily average relative to MHHW</span>
<span class="n">rsl_daily_mhhw</span> <span class="o">=</span> <span class="n">tide_gauge_daily_avg</span> <span class="o">-</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;MHHW&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span>

<span class="c1"># Set the attributes of the rsl_daily data</span>
<span class="n">rsl_daily_mhhw</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">tide_gauge_data_POR</span><span class="o">.</span><span class="n">attrs</span>
<span class="n">rsl_daily_mhhw</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;water level above MHHW&#39;</span>
<span class="n">rsl_daily_mhhw</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
<span class="c1"># add lat and lon to the dataset</span>
<span class="n">rsl_daily_mhhw</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span>
<span class="n">rsl_daily_mhhw</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span>
<span class="c1"># add the station name and country</span>
<span class="n">rsl_daily_mhhw</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span>

<span class="n">rsl_daily_mhhw</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;rsl_mhhw&#39;</span>
<span class="c1"># save rsl_daily to the data directory</span>
<span class="c1"># rsl_daily_mhhw.to_netcdf(data_dir / &#39;rsl_daily_hawaii_mhhw.nc&#39;)</span>


<span class="c1">#combine the two datasets</span>
<span class="n">rsl_daily_combined</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">rsl_daily</span><span class="p">,</span> <span class="n">rsl_daily_mhhw</span><span class="p">])</span>

<span class="n">rsl_daily_combined</span><span class="p">[</span><span class="s1">&#39;storm_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl_daily_combined</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
<span class="n">rsl_daily_combined</span><span class="p">[</span><span class="s1">&#39;storm_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">rsl_daily_combined</span><span class="p">[</span><span class="s1">&#39;storm_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;=</span> <span class="mi">5</span> <span class="k">else</span> <span class="n">x</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">dims</span><span class="o">=</span><span class="n">rsl_daily_combined</span><span class="p">[</span><span class="s1">&#39;storm_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
    <span class="n">coords</span><span class="o">=</span><span class="n">rsl_daily_combined</span><span class="p">[</span><span class="s1">&#39;storm_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span>
<span class="p">)</span>

<span class="c1">#make storm time a coordinate</span>
<span class="n">rsl_daily_combined</span> <span class="o">=</span> <span class="n">rsl_daily_combined</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">storm_time</span> <span class="o">=</span> <span class="n">rsl_daily_combined</span><span class="o">.</span><span class="n">storm_time</span><span class="p">)</span>

<span class="c1"># save rsl_daily_combined to the data directory</span>
<span class="n">rsl_daily_combined</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;rsl_daily_hawaii.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rsl_daily_combined</span><span class="p">[</span><span class="s1">&#39;storm_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl_daily_combined</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
<span class="n">rsl_daily_combined</span><span class="p">[</span><span class="s1">&#39;storm_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">rsl_daily_combined</span><span class="p">[</span><span class="s1">&#39;storm_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;=</span> <span class="mi">5</span> <span class="k">else</span> <span class="n">x</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">dims</span><span class="o">=</span><span class="n">rsl_daily_combined</span><span class="p">[</span><span class="s1">&#39;storm_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
    <span class="n">coords</span><span class="o">=</span><span class="n">rsl_daily_combined</span><span class="p">[</span><span class="s1">&#39;storm_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span>
<span class="p">)</span>

<span class="c1">#make storm time a coordinate</span>
<span class="n">rsl_daily_combined</span> <span class="o">=</span> <span class="n">rsl_daily_combined</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">storm_time</span> <span class="o">=</span> <span class="n">rsl_daily_combined</span><span class="o">.</span><span class="n">storm_time</span><span class="p">)</span>

<span class="c1"># save rsl_daily_combined to the data directory</span>
<span class="n">rsl_daily_combined</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;rsl_daily_hawaii.nc&#39;</span><span class="p">)</span>

<span class="n">rsl_daily_combined</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="retrieve-climate-indices">
<h2>Retrieve Climate Indices<a class="headerlink" href="#retrieve-climate-indices" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_psl_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
    <span class="c1"># Split the data into lines</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># Collect data lines until we encounter -9999</span>
    <span class="n">data_lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>  <span class="c1"># Skip the first line if it&#39;s a header</span>
        <span class="n">stripped_line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">stripped_line</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">continue</span>  <span class="c1"># Skip empty lines</span>
        <span class="c1"># Detect possible footer lines (either starting with -99.9, -9999, or a textual footer)</span>
        <span class="k">if</span> <span class="n">stripped_line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-99.9&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">stripped_line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-99.99&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">stripped_line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-9999&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">char</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">stripped_line</span><span class="p">):</span>
            <span class="k">break</span>  <span class="c1"># Stop processing when footer is encountered</span>
        <span class="c1"># Add valid data lines to the list</span>
        <span class="n">data_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="c1"># Combine data lines into a single string</span>
    <span class="n">data_str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_lines</span><span class="p">)</span>
    <span class="n">data_io</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_io</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_psl_format</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">varName</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">skipfooter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
    <span class="n">CI</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="n">varName</span><span class="p">)</span>
    <span class="c1">#Replace placeholder values with NaN</span>
    <span class="n">CI</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="mf">9.99</span><span class="p">,</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="o">-</span><span class="mf">9999.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">999.99</span><span class="p">,</span><span class="o">-</span><span class="mf">99.90</span><span class="p">,</span><span class="o">-</span><span class="mf">99.99</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Drop rows with NaN values</span>
    <span class="n">CI</span> <span class="o">=</span> <span class="n">CI</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">varName</span><span class="p">])</span>
    <span class="n">CI</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">({</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="n">CI</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="n">CI</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
    <span class="c1"># Sort by &#39;time&#39;</span>
    <span class="n">CI</span> <span class="o">=</span> <span class="n">CI</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">CI</span> <span class="o">=</span> <span class="n">CI</span><span class="p">[[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">varName</span><span class="p">]]</span>

    <span class="k">return</span> <span class="n">CI</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_ncei_format</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">varName</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skipfooter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
    <span class="n">ClimateIndex</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="n">varName</span><span class="p">)</span>
    <span class="n">ClimateIndex</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ClimateIndex</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">month_mapping</span><span class="p">)</span>
    <span class="c1"># Replace placeholder values with NaN</span>
    <span class="n">ClimateIndex</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mf">99.99</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Drop rows with NaN values</span>
    <span class="n">ClimateIndex</span> <span class="o">=</span> <span class="n">ClimateIndex</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">varName</span><span class="p">])</span>
    <span class="n">ClimateIndex</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">({</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="n">ClimateIndex</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="n">ClimateIndex</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
    <span class="c1"># Sort by &#39;time&#39;</span>
    <span class="n">ClimateIndex</span> <span class="o">=</span> <span class="n">ClimateIndex</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ClimateIndex</span> <span class="o">=</span> <span class="n">ClimateIndex</span><span class="p">[[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">varName</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">ClimateIndex</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">month_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Jan&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s1">&#39;May&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;Aug&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s1">&#39;Sep&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">:</span><span class="mi">12</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to convert fraction of the year to datetime</span>
<span class="k">def</span> <span class="nf">convert_fraction_to_date</span><span class="p">(</span><span class="n">date_float</span><span class="p">):</span>
    <span class="c1"># Extract year and fraction</span>
    <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">date_float</span><span class="p">)</span>
    <span class="n">fraction</span> <span class="o">=</span> <span class="n">date_float</span> <span class="o">-</span> <span class="n">year</span>
    
    <span class="c1"># Calculate the total number of days in the year (consider leap years)</span>
    <span class="n">days_in_year</span> <span class="o">=</span> <span class="mi">366</span> <span class="k">if</span> <span class="p">(</span><span class="n">year</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">year</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">year</span> <span class="o">%</span> <span class="mi">400</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">else</span> <span class="mi">365</span>
    
    <span class="c1"># Calculate the day of the year based on the fraction</span>
    <span class="n">day_of_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">fraction</span> <span class="o">*</span> <span class="n">days_in_year</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
    
    <span class="c1"># Create a datetime object for January 1st of the given year</span>
    <span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-01-01&quot;</span><span class="p">)</span>
    
    <span class="c1"># Add the day offset to get the actual date</span>
    <span class="k">return</span> <span class="n">start_date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">day_of_year</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pacific-meridional-mode">
<h2>Pacific Meridional Mode<a class="headerlink" href="#pacific-meridional-mode" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">retrieve_pmm</span><span class="p">(</span><span class="n">yearStart</span><span class="o">=</span><span class="s1">&#39;1950&#39;</span><span class="p">,</span><span class="n">yearEnd</span><span class="o">=</span><span class="s1">&#39;2024&#39;</span><span class="p">,</span><span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">):</span>

    <span class="n">plottingUrlBase</span> <span class="o">=</span> <span class="s1">&#39;https://psl.noaa.gov/cgi-bin/data/climateindices/corr.pl?&#39;</span>
    <span class="n">plotSpecs1</span> <span class="o">=</span> <span class="s1">&#39;tstype1=45&amp;custname1=&amp;custtitle1=&amp;tstype2=0&amp;custname2=&amp;custtitle2=&amp;&#39;</span>
    <span class="n">timeRange</span> <span class="o">=</span> <span class="s1">&#39;year1=&#39;</span><span class="o">+</span> <span class="n">yearStart</span> <span class="o">+</span> <span class="s1">&#39;&amp;year2=&#39;</span> <span class="o">+</span>  <span class="n">yearEnd</span> <span class="o">+</span> <span class="s1">&#39;&amp;&#39;</span>
    <span class="n">plotSpecs2</span> <span class="o">=</span> <span class="s1">&#39;itypea=0&amp;y1=&amp;y2=&amp;plotstyle=0&amp;length=&amp;lag=&amp;iall=0&amp;iseas=0&amp;mon1=0&amp;mon2=11&amp;anom=0&amp;climo1_yr1=&amp;climo1_yr2=&amp;climo2_yr1=&amp;climo2_yr2=&amp;Submit=Calculate+Results&#39;</span>

    <span class="n">plottingUrl</span> <span class="o">=</span> <span class="n">plottingUrlBase</span> <span class="o">+</span> <span class="n">plotSpecs1</span> <span class="o">+</span> <span class="n">timeRange</span> <span class="o">+</span> <span class="n">plotSpecs2</span>

    <span class="c1"># access this plotting url, and then look for text that says &quot;Data file&quot;, and then extract the url for the data file</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">plottingUrl</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
    <span class="n">data_url</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s1">&#39;Data file&#39;</span><span class="p">)[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span>

    <span class="c1"># download the data</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://psl.noaa.gov/&#39;</span><span class="o">+</span><span class="n">data_url</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>

    <span class="n">data_io</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">pmm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_io</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;PMM&quot;</span><span class="p">])</span>

    <span class="c1"># remove rows with missing values</span>
    <span class="n">pmm</span> <span class="o">=</span> <span class="n">pmm</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c1"># Apply the conversion function to the &#39;Date&#39; column</span>
    <span class="n">pmm</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pmm</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">convert_fraction_to_date</span><span class="p">)</span>

    <span class="c1"># put this time as closest to first day of the month</span>
    <span class="n">pmm</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pmm</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">pmm</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pmm</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">()</span>

    <span class="c1"># save to the data directory without the index</span>
    <span class="n">pmm</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;pmm.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PMM data retrieved and saved to data directory&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pmm</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pdo-pacific-decadal-oscillation">
<h2>PDO: Pacific Decadal Oscillation<a class="headerlink" href="#pdo-pacific-decadal-oscillation" title="Permalink to this heading">#</a></h2>
<p>Monthly SST anomalies in the North Pacific Ocean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">retrieve_pdo_ncei</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.ncei.noaa.gov/pub/data/cmb/ersst/v5/index/ersst.v5.pdo.dat&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
    <span class="n">data_io</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">PDO</span> <span class="o">=</span> <span class="n">read_psl_format</span><span class="p">(</span><span class="n">data_io</span><span class="p">,</span> <span class="s1">&#39;PDO&#39;</span><span class="p">)</span>
    <span class="n">PDO</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;pdo.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PDO data retrieved and saved to data directory&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">PDO</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="best-bivariate-enso-timeseries">
<h2>BEST: Bivariate EnSo Timeseries<a class="headerlink" href="#best-bivariate-enso-timeseries" title="Permalink to this heading">#</a></h2>
<p>This climate index combines the atmospheric component of ENSO (SOI) with the oceanic component (Nino 3.4 SST).</p>
<p>For more info, see: https://psl.noaa.gov/people/cathy.smith/best/details.html
Smith, C.A. and P. Sardeshmukh, 2000, The Effect of ENSO on the Intraseasonal Variance of Surface Temperature in Winter., International J. of Climatology, 20 1543-1557.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">retrieve_climateIndex</span><span class="p">(</span><span class="n">ClimateIndex</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">):</span>
    <span class="n">PSLurlBase</span> <span class="o">=</span> <span class="s1">&#39;https://psl.noaa.gov/data/&#39;</span>

    <span class="c1"># Define the URL based on the ClimateIndex</span>
    <span class="k">if</span> <span class="n">ClimateIndex</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;TNA&#39;</span><span class="p">,</span> <span class="s1">&#39;ONI&#39;</span><span class="p">,</span><span class="s1">&#39;PNA&#39;</span><span class="p">]:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">PSLurlBase</span> <span class="o">+</span> <span class="s1">&#39;correlation/&#39;</span> <span class="o">+</span> <span class="n">ClimateIndex</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;.data&#39;</span>
    
    <span class="k">elif</span> <span class="n">ClimateIndex</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;AAO&#39;</span><span class="p">]:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">PSLurlBase</span> <span class="o">+</span> <span class="s1">&#39;timeseries/month/data/&#39;</span> <span class="o">+</span> <span class="n">ClimateIndex</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;.data&#39;</span>

    <span class="k">elif</span> <span class="n">ClimateIndex</span> <span class="o">==</span> <span class="s1">&#39;AO&#39;</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">PSLurlBase</span> <span class="o">+</span> <span class="s1">&#39;timeseries/month/data/&#39;</span> <span class="o">+</span> <span class="n">ClimateIndex</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;.long.data&#39;</span>

    <span class="k">elif</span> <span class="n">ClimateIndex</span> <span class="o">==</span> <span class="s1">&#39;DMI&#39;</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://psl.noaa.gov/gcos_wgsp/Timeseries/Data/dmieast.had.long.data&#39;</span>

    <span class="k">elif</span> <span class="n">ClimateIndex</span> <span class="o">==</span> <span class="s1">&#39;BEST&#39;</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">PSLurlBase</span> <span class="o">+</span> <span class="s1">&#39;correlation/censo.data&#39;</span>
    
    <span class="k">elif</span> <span class="n">ClimateIndex</span> <span class="o">==</span> <span class="s1">&#39;PDO&#39;</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://psl.noaa.gov/pdo/data/pdo.timeseries.sstens.data&#39;</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ClimateIndex &#39;</span><span class="si">{</span><span class="n">ClimateIndex</span><span class="si">}</span><span class="s2">&#39; is not recognized&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrieving data from: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Fetch and format the data</span>
    <span class="n">data_io</span> <span class="o">=</span> <span class="n">read_psl_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">climate_data</span> <span class="o">=</span> <span class="n">read_psl_format</span><span class="p">(</span><span class="n">data_io</span><span class="p">,</span> <span class="n">ClimateIndex</span><span class="p">)</span>

    <span class="c1"># Save the data to a CSV file</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;climate_indices&#39;</span> <span class="o">/</span> <span class="p">(</span><span class="n">ClimateIndex</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
    <span class="n">climate_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ClimateIndex</span><span class="si">}</span><span class="s2"> data retrieved and saved to </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">climate_data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ONI</span> <span class="o">=</span> <span class="n">retrieve_climateIndex</span><span class="p">(</span><span class="s1">&#39;ONI&#39;</span><span class="p">)</span>
<span class="n">TNA</span> <span class="o">=</span> <span class="n">retrieve_climateIndex</span><span class="p">(</span><span class="s1">&#39;TNA&#39;</span><span class="p">)</span>
<span class="n">PNA</span> <span class="o">=</span> <span class="n">retrieve_climateIndex</span><span class="p">(</span><span class="s1">&#39;PNA&#39;</span><span class="p">)</span>
<span class="n">AAO</span> <span class="o">=</span> <span class="n">retrieve_climateIndex</span><span class="p">(</span><span class="s1">&#39;AAO&#39;</span><span class="p">)</span>
<span class="n">AO</span> <span class="o">=</span> <span class="n">retrieve_climateIndex</span><span class="p">(</span><span class="s1">&#39;AO&#39;</span><span class="p">)</span>
<span class="n">DMI</span> <span class="o">=</span> <span class="n">retrieve_climateIndex</span><span class="p">(</span><span class="s1">&#39;DMI&#39;</span><span class="p">)</span>
<span class="n">BEST</span> <span class="o">=</span> <span class="n">retrieve_climateIndex</span><span class="p">(</span><span class="s1">&#39;BEST&#39;</span><span class="p">)</span>
<span class="n">PMM</span> <span class="o">=</span> <span class="n">retrieve_pmm</span><span class="p">()</span>
<span class="n">PDO</span> <span class="o">=</span> <span class="n">retrieve_climateIndex</span><span class="p">(</span><span class="s1">&#39;PDO&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of all DataFrames and their corresponding names</span>
<span class="n">CIs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;BEST&#39;</span><span class="p">:</span> <span class="n">BEST</span><span class="p">,</span>
    <span class="s1">&#39;DMI&#39;</span><span class="p">:</span> <span class="n">DMI</span><span class="p">,</span>
    <span class="s1">&#39;AO&#39;</span><span class="p">:</span> <span class="n">AO</span><span class="p">,</span>
    <span class="s1">&#39;AAO&#39;</span><span class="p">:</span> <span class="n">AAO</span><span class="p">,</span>
    <span class="s1">&#39;PNA&#39;</span><span class="p">:</span> <span class="n">PNA</span><span class="p">,</span>
    <span class="s1">&#39;TNA&#39;</span><span class="p">:</span> <span class="n">TNA</span><span class="p">,</span>
    <span class="s1">&#39;ONI&#39;</span><span class="p">:</span> <span class="n">ONI</span><span class="p">,</span>
    <span class="s1">&#39;PDO&#39;</span><span class="p">:</span> <span class="n">PDO</span><span class="p">,</span>
    <span class="s1">&#39;PMM&#39;</span><span class="p">:</span> <span class="n">PMM</span>
<span class="p">}</span>

<span class="c1"># Start with the first DataFrame (BEST in this case)</span>
<span class="n">merged_CI</span> <span class="o">=</span> <span class="n">CIs</span><span class="p">[</span><span class="s1">&#39;BEST&#39;</span><span class="p">]</span>

<span class="c1"># Loop through the rest of the DataFrames and merge them on &#39;time&#39;</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">CIs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;BEST&#39;</span><span class="p">:</span>
        <span class="n">merged_CI</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged_CI</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># truncate to 1990 through 2023</span>
<span class="n">merged_CI</span> <span class="o">=</span> <span class="n">merged_CI</span><span class="p">[(</span><span class="n">merged_CI</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s1">&#39;1990-01-01&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">merged_CI</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">)]</span>
<span class="n">merged_CI</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;climate_indices&#39;</span> <span class="o">/</span> <span class="s1">&#39;climate_indices.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get standard deviation of the climate indices</span>
<span class="n">merged_CI</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;climate_indices&#39;</span> <span class="o">/</span> <span class="s1">&#39;climate_indices.csv&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the standard deviation of each column except &#39;time&#39;</span>
<span class="n">std_dev</span> <span class="o">=</span> <span class="n">merged_CI</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># calculate the mean of each column except &#39;time&#39;</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">merged_CI</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># normalize the climate indices such that they have a standard deviation of 1</span>
<span class="n">merged_CI_norm</span> <span class="o">=</span> <span class="n">merged_CI</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">merged_CI_norm</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="c1"># normalize the column by subtracting the mean and dividing by the standard deviation</span>
    <span class="n">merged_CI_norm</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_CI_norm</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
    <span class="n">merged_CI_norm</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_CI_norm</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">/</span> <span class="n">std_dev</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

<span class="n">merged_CI_norm</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">merged_CI_norm</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>

<span class="c1">#save to the data directory</span>
<span class="n">merged_CI_norm</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;climate_indices&#39;</span> <span class="o">/</span> <span class="s1">&#39;climate_indices_norm.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_CI_norm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>

<span class="n">indices</span> <span class="o">=</span> <span class="n">merged_CI_norm</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="c1"># Adjusting the x-axis limits to range from 1993 to 2024</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Loop through each index and its corresponding subplot</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">indices</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">merged_CI_norm</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">merged_CI_norm</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>  
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># Set y-axis limits to</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># Set smaller tick size for y-axis</span>

<span class="c1"># Set the x-axis label only for the last subplot</span>
<span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>

<span class="c1"># Set x-axis major ticks to every 5 years and limit to 1993 to 2024</span>
<span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1990-01-01&#39;</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>

<span class="c1"># Set a common title for the figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Normalized Climate Indices over Time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># Adjust spacing between subplots, reducing vertical gaps</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">],</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "jwfiedler/SL_Hawaii",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="setup.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Setup</p>
      </div>
    </a>
    <a class="right-next"
       href="SL_annual.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Sea Level Magnitude</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-tide-gauge-data">Retrieve Tide Gauge Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-data-from-noaa-co-ops-api">Retrieve data from NOAA CO-OPS API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-altimetry-data">Retrieve altimetry data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#processing">Processing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#process-the-tide-gauge-data-to-match-cmems">Process the tide gauge data to match CMEMS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize-the-tide-gauge-data-relative-to-the-1993-2012-epoch">Normalize the tide gauge data relative to the 1993-2012 epoch</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-climate-indices">Retrieve Climate Indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pacific-meridional-mode">Pacific Meridional Mode</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pdo-pacific-decadal-oscillation">PDO: Pacific Decadal Oscillation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#best-bivariate-enso-timeseries">BEST: Bivariate EnSo Timeseries</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Playground Coordinator
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>