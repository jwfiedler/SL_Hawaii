

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Minor Flood Frequency &#8212; Hawaii Sea Level Indicators</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/FloodFrequency';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Flood Duration" href="FloodDuration.html" />
    <link rel="prev" title="Components of Sea Level" href="regional_and_local/SL_Components.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>


  <div class="bd-header-announcement container-fluid bd-header-announcement">
    <div class="bd-header-announcement__content">In development! Please post issues and suggestions to github.</div>
  </div>

  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/trend_map.png" class="logo__image only-light" alt="Hawaii Sea Level Indicators - Home"/>
    <script>document.write(`<img src="../_static/trend_map.png" class="logo__image only-dark" alt="Hawaii Sea Level Indicators - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../gettingStarted.html">Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="SL_Data_Wrangling.html">Data Wrangling</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Regional and Local Sea Level</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="regional_and_local/SL_magnitude.html">Sea Level Magnitude</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="regional_and_local/SL_anomaly.html">Sea Level Anomalies</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="regional_and_local/SL_anomaly_annual.html">Annual Sea Level Anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="regional_and_local/SL_anomaly_interannual.html">Intra-Annual Sea Level Anomalies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="regional_and_local/SL_Rankings.html">Rankings</a></li>
<li class="toctree-l1"><a class="reference internal" href="regional_and_local/SL_Extremes.html">Extremes</a></li>
<li class="toctree-l1"><a class="reference internal" href="regional_and_local/SL_Components.html">Components of Sea Level</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Minor Flood Frequency and Duration</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Minor Flood Frequency</a></li>
<li class="toctree-l1"><a class="reference internal" href="FloodDuration.html">Flood Duration</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jwfiedler/SL_Hawaii/main?urlpath=tree/notebooks/FloodFrequency.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jwfiedler/SL_Hawaii" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jwfiedler/SL_Hawaii/edit/main/notebooks/FloodFrequency.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jwfiedler/SL_Hawaii/issues/new?title=Issue%20on%20page%20%2Fnotebooks/FloodFrequency.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/FloodFrequency.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Minor Flood Frequency</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-the-tide-station-s-data-set-s">Retrieve the Tide Station(s) Data Set(s)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-datum-to-mhhw">Set the Datum to MHHW</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assess-station-data-quality-for-the-por-1983-2022">Assess Station Data Quality for the POR (1983-2022)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#identify-epoch-for-the-flood-frequency-analysis">Identify epoch for the flood frequency analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adjust-the-data-from-calendar-year-to-storm-year">Adjust the data from calendar year to storm year</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assign-a-threshold">Assign a Threshold</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-and-plot-flood-frequency">Calculate and Plot Flood Frequency</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-flood-frequency-counts">Plot Flood Frequency Counts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-flood-duration">Plot Flood Duration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-percent-change-over-time">Calculate the percent change over time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-map">Create a map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="minor-flood-frequency">
<h1>Minor Flood Frequency<a class="headerlink" href="#minor-flood-frequency" title="Permalink to this heading">#</a></h1>
<figure class="align-left">
<a class="reference internal image-reference" href="../_images/d4d9009f81887fbb93bf22c8fa0e3cd3567be58f76b5e9313d693212f257ad45.png"><img alt="../_images/d4d9009f81887fbb93bf22c8fa0e3cd3567be58f76b5e9313d693212f257ad45.png" src="../_images/d4d9009f81887fbb93bf22c8fa0e3cd3567be58f76b5e9313d693212f257ad45.png" style="width: 525.5px; height: 201.5px;" /></a>
</figure>
<p>In this notebook we will plot two indicators concerning flooding at the Hawaii tide gauges, after first taking a general look at the type of data we are able to plot from the UHSLC. These indicators are based on a ‘flooding’ threshold, using <a class="reference external" href="https://tidesandcurrents.noaa.gov/sltrends/faq.html">relative sea level</a>.</p>
<p>Download Files:
<a class="reference download internal" download="" href="../_downloads/e05c6c2f872e944506979d96f70def7e/SL_FloodFrequency_map.png"><span class="xref download myst">Map</span></a> |
<a class="reference download internal" download="" href="../_downloads/b6ef93868e21657ad682e9077180d8bc/SL_FloodFrequency_threshold_counts_days.png"><span class="xref download myst">Time Series Plot</span></a> |
<a class="reference download internal" download="" href="../_downloads/a91f70b39fb57e187e3f973c4f648c51/SL_FloodFrequency_percent_change.csv"><span class="xref download myst">Table</span></a></p>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">#</a></h2>
<p>We first need to import the necessary libraries, establish our input/output directories, and set up some basic plotting rules. We’ll do this by running another notebook called “setup.”</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">run</span> setup.ipynb
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../data&#39;</span> <span class="p">)</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../output&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="retrieve-the-tide-station-s-data-set-s">
<h2>Retrieve the Tide Station(s) Data Set(s)<a class="headerlink" href="#retrieve-the-tide-station-s-data-set-s" title="Permalink to this heading">#</a></h2>
<p>We stored this previously in our data directory as “rsl_hawaii.nc”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the data</span>
<span class="n">rsl</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;rsl_hawaii.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>and we’ll save a few variables that will come up later for report generation.</p>
<section id="set-the-datum-to-mhhw">
<h3>Set the Datum to MHHW<a class="headerlink" href="#set-the-datum-to-mhhw" title="Permalink to this heading">#</a></h3>
<aside class="margin sidebar">
<p class="sidebar-title">A Note on Datums</p>
<p>The sea level variable in the netcdf file is sea level <strong>relative to the station datum</strong>. For more information on the data processing of this gauge, see the <a class="reference external" href="https://uhslc.soest.hawaii.edu/rqds/pacific/doc/qa007b.dmt">station metdata</a>.</p>
</aside>
<p>In this example, we will set the datum to MHHW. This can be hard coded, or we can read in the <a class="reference external" href="https://uhslc.soest.hawaii.edu/stations/?stn=007#datums">station datum information</a> from UHSLC. I’m not going to do this, because there’s no elegant way to parse the datum table at the moment as far as I can tell. It’s a simple call to the NOAA COOPS API if that’s the data source, though. Instead I have a saved datums_007.csv file that we’ll call from.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_MHHW_uhslc_datums</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">datumname</span><span class="p">):</span> 
    
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://uhslc.soest.hawaii.edu/stations/TIDES_DATUMS/fd/LST/fd&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;/datumTable_&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;_m.html&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span> <span class="c1"># skip header row</span>
    <span class="n">table</span> <span class="o">=</span> <span class="s1">&#39;&lt;table&gt;&#39;</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">table</span><span class="p">])</span> <span class="c1"># add back the table tag</span>
    <span class="n">table_io</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>
    <span class="n">datumtable</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">table_io</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">datum</span> <span class="o">=</span> <span class="n">datumtable</span><span class="p">[</span><span class="n">datumtable</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">datumname</span><span class="p">][</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># ensure datum is a float</span>
    <span class="n">datum</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">datum</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">datum</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add MHHW to the dataset</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;MHHW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="mi">1000</span><span class="o">*</span><span class="n">get_MHHW_uhslc_datums</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s1">&#39;MHHW&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;uhslc_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="s1">&#39;record_id&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;record_id&#39;</span><span class="p">:</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]})</span>

<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;MHHW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mm&#39;</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;MHHW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Mean Higher High Water, rel. to station datum&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rsl</span> <span class="o">=</span> <span class="n">rsl</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert sea level to MHHW</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;sea_level&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;MHHW&#39;</span><span class="p">]</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mm&#39;</span>
<span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Sea Level, relative to MHHW&#39;</span>

<span class="n">rsl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:               (time: 1043870, record_id: 11)
Coordinates:
  * time                  (time) datetime64[ns] 1905-01-01T10:00:00.028800 .....
  * record_id             (record_id) int16 520 600 5520 5480 ... 580 140 500
Data variables:
    sea_level             (record_id, time) float32 ...
    lat                   (record_id) float32 ...
    lon                   (record_id) float32 ...
    station_name          (record_id) &lt;U17 ...
    station_country       (record_id) &lt;U30 ...
    station_country_code  (record_id) float32 ...
    uhslc_id              (record_id) float32 52.0 60.0 552.0 ... 58.0 14.0 50.0
    gloss_id              (record_id) float32 ...
    ssc_id                (record_id) &lt;U4 ...
    last_rq_date          (record_id) datetime64[ns] ...
    MHHW                  (record_id) float64 1.225e+03 1.912e+03 ... 1.204e+03
    sea_level_MHHW        (record_id, time) float64 nan nan ... -134.0 -210.0
Attributes:
    title:                  UHSLC Fast Delivery Tide Gauge Data (hourly)
    ncei_template_version:  NCEI_NetCDF_TimeSeries_Orthogonal_Template_v2.0
    featureType:            timeSeries
    Conventions:            CF-1.6, ACDD-1.3
    date_created:           2024-03-07T14:27:49Z
    publisher_name:         University of Hawaii Sea Level Center (UHSLC)
    publisher_email:        philiprt@hawaii.edu, markm@soest.hawaii.edu
    publisher_url:          http://uhslc.soest.hawaii.edu
    summary:                The UHSLC assembles and distributes the Fast Deli...
    processing_level:       Fast Delivery (FD) data undergo a level 1 quality...
    acknowledgment:         The UHSLC Fast Delivery database is supported by ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-eace368b-b5b8-4477-8680-865a8f105556' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-eace368b-b5b8-4477-8680-865a8f105556' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1043870</li><li><span class='xr-has-index'>record_id</span>: 11</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-8aec7e20-888a-426c-9a6c-6ef2a3eceb74' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8aec7e20-888a-426c-9a6c-6ef2a3eceb74' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1905-01-01T10:00:00.028800 ... 2...</div><input id='attrs-b8400fc4-c7ba-4a59-97e8-0f2d37bcb93e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b8400fc4-c7ba-4a59-97e8-0f2d37bcb93e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-57198094-df37-4216-a7e9-2dd9425729eb' class='xr-var-data-in' type='checkbox'><label for='data-57198094-df37-4216-a7e9-2dd9425729eb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1905-01-01T10:00:00.028800000&#x27;, &#x27;1905-01-01T10:59:59.971200000&#x27;,
       &#x27;1905-01-01T12:00:00.000000000&#x27;, ..., &#x27;2024-01-31T21:00:00.000000000&#x27;,
       &#x27;2024-01-31T22:00:00.028800000&#x27;, &#x27;2024-01-31T22:59:59.971200000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>record_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>int16</div><div class='xr-var-preview xr-preview'>520 600 5520 5480 ... 580 140 500</div><input id='attrs-a0a46bfa-a93d-456d-b29e-8603974be9af' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a0a46bfa-a93d-456d-b29e-8603974be9af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b15b30af-f754-42a9-8140-8ce458e42fa2' class='xr-var-data-in' type='checkbox'><label for='data-b15b30af-f754-42a9-8140-8ce458e42fa2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique identifier for each record (i.e., station and version) in the database</dd></dl></div><div class='xr-var-data'><pre>array([ 520,  600, 5520, 5480,  590,  570, 5470,  610,  580,  140,  500],
      dtype=int16)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-09eebbb0-b3e2-4a39-8e59-51d7df192e73' class='xr-section-summary-in' type='checkbox'  checked><label for='section-09eebbb0-b3e2-4a39-8e59-51d7df192e73' class='xr-section-summary' >Data variables: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sea_level</span></div><div class='xr-var-dims'>(record_id, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-7966170b-d8c1-4cc7-9ac3-729bd10d549a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7966170b-d8c1-4cc7-9ac3-729bd10d549a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0806caec-37ac-4b72-bc33-f330b4c530d3' class='xr-var-data-in' type='checkbox'><label for='data-0806caec-37ac-4b72-bc33-f330b4c530d3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>relative sea level</dd><dt><span>units :</span></dt><dd>millimeters</dd><dt><span>source :</span></dt><dd>in situ tide gauge water level observations</dd><dt><span>platform :</span></dt><dd>station_name, station_country, station_country_code, uhslc_id, gloss_id, ssc_id</dd></dl></div><div class='xr-var-data'><pre>[11482570 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-9c81dd64-ec5d-40eb-a2bd-686b75ba406e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9c81dd64-ec5d-40eb-a2bd-686b75ba406e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4be2f784-05a9-47a3-9151-821e24796128' class='xr-var-data-in' type='checkbox'><label for='data-4be2f784-05a9-47a3-9151-821e24796128' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>valid_min :</span></dt><dd>-90</dd><dt><span>valid_max :</span></dt><dd>90</dd></dl></div><div class='xr-var-data'><pre>[11 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1d9bd2c8-b9ac-45a8-a219-e7bd8ca1a4fc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1d9bd2c8-b9ac-45a8-a219-e7bd8ca1a4fc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb47d16f-e86d-4e52-a16c-087c7c8ddcd9' class='xr-var-data-in' type='checkbox'><label for='data-eb47d16f-e86d-4e52-a16c-087c7c8ddcd9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>360</dd></dl></div><div class='xr-var-data'><pre>[11 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_name</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U17</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8aa2ce56-1bb5-46d5-a99e-4e7eae4bbe68' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8aa2ce56-1bb5-46d5-a99e-4e7eae4bbe68' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-25d1dc02-bb55-4385-804e-2cd0799008f8' class='xr-var-data-in' type='checkbox'><label for='data-25d1dc02-bb55-4385-804e-2cd0799008f8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>station name</dd></dl></div><div class='xr-var-data'><pre>[11 values with dtype=&lt;U17]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U30</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2858c364-b4a8-4968-ada5-5a2fd7eca268' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2858c364-b4a8-4968-ada5-5a2fd7eca268' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-313fb1ca-a017-4240-ad89-7c8a85e61e0f' class='xr-var-data-in' type='checkbox'><label for='data-313fb1ca-a017-4240-ad89-7c8a85e61e0f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>station country (ISO 3166-1)</dd></dl></div><div class='xr-var-data'><pre>[11 values with dtype=&lt;U30]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country_code</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-c35bcfb6-9c9f-4eac-86d3-7028633480bc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c35bcfb6-9c9f-4eac-86d3-7028633480bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-929ab366-b2b1-405d-bd69-1f345e19ce64' class='xr-var-data-in' type='checkbox'><label for='data-929ab366-b2b1-405d-bd69-1f345e19ce64' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>station country code (ISO 3166-1 numeric)</dd><dt><span>comment :</span></dt><dd>These are 3-digit country codes (e.g., 003) stored as integers.</dd></dl></div><div class='xr-var-data'><pre>[11 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>uhslc_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>52.0 60.0 552.0 ... 58.0 14.0 50.0</div><input id='attrs-64670b80-d793-43db-a75b-a9f197f52390' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-64670b80-d793-43db-a75b-a9f197f52390' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-79927ac7-8957-4254-8257-81d261694928' class='xr-var-data-in' type='checkbox'><label for='data-79927ac7-8957-4254-8257-81d261694928' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique station ID number used by the University of Hawaii Sea Level Center (UHSLC)</dd></dl></div><div class='xr-var-data'><pre>array([ 52.,  60., 552., 548.,  59.,  57., 547.,  61.,  58.,  14.,  50.],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>gloss_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-cf806e95-ed8f-493e-b230-0fb680e24c52' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cf806e95-ed8f-493e-b230-0fb680e24c52' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-07f033f0-235a-478a-adcd-351965a0f419' class='xr-var-data-in' type='checkbox'><label for='data-07f033f0-235a-478a-adcd-351965a0f419' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique station ID number used by the WMO/IOC Global Sea Level Observing System (GLOSS)</dd></dl></div><div class='xr-var-data'><pre>[11 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ssc_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-b31b85fa-3f47-4f14-9ddd-4798c351f112' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b31b85fa-3f47-4f14-9ddd-4798c351f112' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-04e796d6-cb3d-4951-a669-01943a4905ae' class='xr-var-data-in' type='checkbox'><label for='data-04e796d6-cb3d-4951-a669-01943a4905ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique station ID code in the Sealevel Station Catalog (SSC) produced by the WMO/IOC Sea Level Monitoring Facility (VLIZ)</dd><dt><span>comment :</span></dt><dd>Note that SSC IDs vary in length. The IDs are padded with space characters to produce the retangular character matrix provided here.</dd></dl></div><div class='xr-var-data'><pre>[11 values with dtype=&lt;U4]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>last_rq_date</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-959a98e7-1d39-4163-b354-95b968f99639' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-959a98e7-1d39-4163-b354-95b968f99639' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cbd8b04c-5672-4a13-84f1-7330ebf06416' class='xr-var-data-in' type='checkbox'><label for='data-cbd8b04c-5672-4a13-84f1-7330ebf06416' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>date of last Research Quality sea level value</dd><dt><span>comment :</span></dt><dd>Values in last_rq_date correspond to an identical value in the time vector. Dates less than or equal to last_rq_date for a given station correspond to Research Quality (RQ) data. Dates after last_rq_date correspond to Fast Delivery (FD) data. Missing values indicate no RQ data for a station.</dd></dl></div><div class='xr-var-data'><pre>[11 values with dtype=datetime64[ns]]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>MHHW</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.225e+03 1.912e+03 ... 1.204e+03</div><input id='attrs-d2876b5e-5cd8-48b0-b740-a8cee09f47e7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d2876b5e-5cd8-48b0-b740-a8cee09f47e7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bb0788e4-151a-43f8-b9d2-4726b9c33ef1' class='xr-var-data-in' type='checkbox'><label for='data-bb0788e4-151a-43f8-b9d2-4726b9c33ef1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd><dt><span>long_name :</span></dt><dd>Mean Higher High Water, rel. to station datum</dd></dl></div><div class='xr-var-data'><pre>array([1225., 1912., 1406., 2261., 1364., 1722., 3865., 1533., 1240.,
        997., 1204.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sea_level_MHHW</span></div><div class='xr-var-dims'>(record_id, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... -64.0 -134.0 -210.0</div><input id='attrs-9cdbbb47-29dc-413e-b672-e1e1e9914f32' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9cdbbb47-29dc-413e-b672-e1e1e9914f32' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b39484cb-9dc2-48db-a820-25a538fd411b' class='xr-var-data-in' type='checkbox'><label for='data-b39484cb-9dc2-48db-a820-25a538fd411b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd><dt><span>long_name :</span></dt><dd>Sea Level, relative to MHHW</dd></dl></div><div class='xr-var-data'><pre>array([[  nan,   nan,   nan, ..., -101., -228., -366.],
       [  nan,   nan,   nan, ...,   nan,   nan,   nan],
       [  nan,   nan,   nan, ...,   nan,   nan,   nan],
       ...,
       [  nan,   nan,   nan, ...,   nan,   nan,   nan],
       [  nan,   nan,   nan, ...,   nan,   nan,   nan],
       [  nan,   nan,   nan, ...,  -64., -134., -210.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8cad3774-c443-4a50-b39e-1d8c3436872e' class='xr-section-summary-in' type='checkbox'  ><label for='section-8cad3774-c443-4a50-b39e-1d8c3436872e' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a668a653-b755-49bc-9d7b-7b41cf7090ba' class='xr-index-data-in' type='checkbox'/><label for='index-a668a653-b755-49bc-9d7b-7b41cf7090ba' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1905-01-01 10:00:00.028800&#x27;, &#x27;1905-01-01 10:59:59.971200&#x27;,
                      &#x27;1905-01-01 12:00:00&#x27;, &#x27;1905-01-01 13:00:00.028800&#x27;,
               &#x27;1905-01-01 13:59:59.971200&#x27;,        &#x27;1905-01-01 15:00:00&#x27;,
               &#x27;1905-01-01 16:00:00.028800&#x27;, &#x27;1905-01-01 16:59:59.971200&#x27;,
                      &#x27;1905-01-01 18:00:00&#x27;, &#x27;1905-01-01 19:00:00.028800&#x27;,
               ...
               &#x27;2024-01-31 13:59:59.971200&#x27;,        &#x27;2024-01-31 15:00:00&#x27;,
               &#x27;2024-01-31 16:00:00.028800&#x27;, &#x27;2024-01-31 16:59:59.971200&#x27;,
                      &#x27;2024-01-31 18:00:00&#x27;, &#x27;2024-01-31 19:00:00.028800&#x27;,
               &#x27;2024-01-31 19:59:59.971200&#x27;,        &#x27;2024-01-31 21:00:00&#x27;,
               &#x27;2024-01-31 22:00:00.028800&#x27;, &#x27;2024-01-31 22:59:59.971200&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1043870, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>record_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-96cb7e5a-12c4-44a2-8ea4-a54da7e232e8' class='xr-index-data-in' type='checkbox'/><label for='index-96cb7e5a-12c4-44a2-8ea4-a54da7e232e8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([520, 600, 5520, 5480, 590, 570, 5470, 610, 580, 140, 500], dtype=&#x27;int16&#x27;, name=&#x27;record_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4b230896-f46f-4110-8021-fd2ff2bda382' class='xr-section-summary-in' type='checkbox'  ><label for='section-4b230896-f46f-4110-8021-fd2ff2bda382' class='xr-section-summary' >Attributes: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>UHSLC Fast Delivery Tide Gauge Data (hourly)</dd><dt><span>ncei_template_version :</span></dt><dd>NCEI_NetCDF_TimeSeries_Orthogonal_Template_v2.0</dd><dt><span>featureType :</span></dt><dd>timeSeries</dd><dt><span>Conventions :</span></dt><dd>CF-1.6, ACDD-1.3</dd><dt><span>date_created :</span></dt><dd>2024-03-07T14:27:49Z</dd><dt><span>publisher_name :</span></dt><dd>University of Hawaii Sea Level Center (UHSLC)</dd><dt><span>publisher_email :</span></dt><dd>philiprt@hawaii.edu, markm@soest.hawaii.edu</dd><dt><span>publisher_url :</span></dt><dd>http://uhslc.soest.hawaii.edu</dd><dt><span>summary :</span></dt><dd>The UHSLC assembles and distributes the Fast Delivery (FD) dataset of hourly- and daily-averaged tide gauge water-level observations. Tide gauge operators, or data creators, provide FD data to UHSLC after a level 1 quality assessment (see processing_level attribute). The UHSLC provides an independent quality assessment of the time series and makes FD data available within 4-6 weeks of collection. This is a &quot;fast&quot; turnaround time compared to Research Quality (RQ) data, which are available on an annual cycle after a level 2 quality assessment. RQ data replace FD data in the data stream as the former becomes available. This file contains hybrid time series composed of RQ data when available with FD data appended to the end of each RQ series.</dd><dt><span>processing_level :</span></dt><dd>Fast Delivery (FD) data undergo a level 1 quality assessment (e.g., unit and timing evaluation, outlier detection, combination of multiple channels into a primary channel, etc.). In this file, FD data are appended to Research Quality (RQ) data that have received a level 2 quality assessment (e.g., tide gauge datum evaluation, assessment of level ties to tide gauge benchmarks, comparison with nearby stations, etc.).</dd><dt><span>acknowledgment :</span></dt><dd>The UHSLC Fast Delivery database is supported by the National Oceanic and Atmospheric Administration (NOAA) Office of Climate Observations (OCO).</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="assess-station-data-quality-for-the-por-1983-2022">
<h3>Assess Station Data Quality for the POR (1983-2022)<a class="headerlink" href="#assess-station-data-quality-for-the-por-1983-2022" title="Permalink to this heading">#</a></h3>
<p>To do this, we’ll plot all the sea level data to make sure our data looks correct, and then we’ll truncate the data set to the time period of record (POR).</p>
<aside class="margin sidebar">
<p class="sidebar-title">Watch the units!</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Note that the sea_level variable here is in millimeters (mm)! If we want to plot things on a centimeter (cm) scale, we have to divide by 10.</p>
</div>
</aside>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="c1"># ax.plot(rsl.time.values,rsl.sea_level_MHHW.T.values/10)</span>

<span class="c1"># ax.set_ylabel(rsl[&#39;sea_level_MHHW&#39;].long_name) #divide by 10 to convert to cm</span>

<span class="c1"># # add legend to bottom of plot</span>
<span class="c1"># ax.legend(rsl[&#39;station_name&#39;].values, bbox_to_anchor=(0.5, -0.2), loc=&#39;upper center&#39;, ncol=3)  </span>


<span class="c1"># Initial offset</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># The amount to offset each successive line</span>
<span class="n">offset_increment</span> <span class="o">=</span> <span class="mi">150</span>  <span class="c1"># Adjust this value based on your data scale and visual preference</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">record_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="c1"># Extract the series for this station</span>
    <span class="n">sea_level_data</span> <span class="o">=</span> <span class="n">rsl</span><span class="o">.</span><span class="n">sea_level_MHHW</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">record_id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="mi">10</span>  <span class="c1"># Convert to cm</span>
    <span class="c1"># Plot, adding the offset</span>
    <span class="c1">#add horizontal line for each station</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rsl</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">sea_level_data</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">rsl</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
    <span class="c1"># Increment the offset for the next series</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="n">offset_increment</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">rsl</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">long_name</span> <span class="o">+</span> <span class="s1">&#39; (cm, offset by 150cm per station)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Sea Level, relative to MHHW (cm, offset by 150cm per station)&#39;)
</pre></div>
</div>
<img alt="../_images/b5089d14505cb7838c1732b3027e0ad8151d2ad71d2f38536e92b87a47577b71.png" src="../_images/b5089d14505cb7838c1732b3027e0ad8151d2ad71d2f38536e92b87a47577b71.png" />
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># take only a subset of the data: Hilo, Kawaihae, Kahului, Mokuoloe, Honolulu, Nawiliwili, Johnston and Midway Island</span>
<span class="n">subset</span> <span class="o">=</span> <span class="n">rsl</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">record_id</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span><span class="mi">520</span><span class="p">,</span><span class="mi">570</span><span class="p">,</span><span class="mi">580</span><span class="p">,</span><span class="mi">590</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">610</span><span class="p">,</span><span class="mi">5520</span><span class="p">])</span>

<span class="n">subset</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="c1"># ax.plot(rsl.time.values,rsl.sea_level_MHHW.T.values/10)</span>
<span class="c1"># ax.set_ylabel(rsl[&#39;sea_level_MHHW&#39;].long_name) #divide by 10 to convert to cm</span>
<span class="c1"># # add legend to bottom of plot</span>
<span class="c1"># ax.legend(rsl[&#39;station_name&#39;].values, bbox_to_anchor=(0.5, -0.2), loc=&#39;upper center&#39;, ncol=3)  </span>
<span class="c1"># Initial offset</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># The amount to offset each successive line</span>
<span class="n">offset_increment</span> <span class="o">=</span> <span class="mi">150</span>  <span class="c1"># Adjust this value based on your data scale and visual preference</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">record_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subset</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="c1"># Extract the series for this station</span>
    <span class="n">sea_level_data</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">sea_level_MHHW</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">record_id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="mi">10</span>  <span class="c1"># Convert to cm</span>
    <span class="c1"># Plot, adding the offset</span>
    <span class="c1">#add horizontal line for each station</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">sea_level_data</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">subset</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">subset</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
    <span class="c1"># Increment the offset for the next series</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="n">offset_increment</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">subset</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">long_name</span> <span class="o">+</span> <span class="s1">&#39; (cm, offset by 150cm per station)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Sea Level, relative to MHHW (cm, offset by 150cm per station)&#39;)
</pre></div>
</div>
<img alt="../_images/6d52f505d8289451d04ae20276460941a51401f0410545e45aef52a4c1c233f5.png" src="../_images/6d52f505d8289451d04ae20276460941a51401f0410545e45aef52a4c1c233f5.png" />
</div>
</div>
<section id="identify-epoch-for-the-flood-frequency-analysis">
<h4>Identify epoch for the flood frequency analysis<a class="headerlink" href="#identify-epoch-for-the-flood-frequency-analysis" title="Permalink to this heading">#</a></h4>
<p>Now, we’ll calculate trend starting from the beginning of the tidal datum analysis period epoch to the last time processed. The  epoch information is given in the datums table.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make epoch_start equal to Jan 1 1983 in datetime format</span>
<span class="n">epoch_start</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1983</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># and for now, end time will be the end of 2023</span>
<span class="n">epoch_end</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">)</span>


<span class="n">hourly_data</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">epoch_start</span><span class="p">,</span> <span class="n">epoch_end</span><span class="p">)))</span>
<span class="n">hourly_data</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">station_group</span> <span class="o">=</span> <span class="s1">&#39;Hawaiian Islands&#39;</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;startEpochDateTime&quot;</span><span class="p">,</span><span class="n">epoch_start</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;endEpochDateTime&quot;</span><span class="p">,</span><span class="n">epoch_end</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;stationGroup&quot;</span><span class="p">,</span><span class="n">station_group</span><span class="p">,</span><span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>and plot the hourly time series</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fig, ax = plt.subplots(sharex=True)</span>
<span class="c1"># fig.autofmt_xdate()</span>
<span class="c1"># ax.plot(hourly_data.time.values,hourly_data.sea_level_MHHW.T.values/10) #divide by 10 to convert to cm</span>
<span class="c1"># </span>
<span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW_cm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10</span>

<span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW_cm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cm&#39;</span>
<span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW_cm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Sea Level, relative to MHHW&#39;</span>

<span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW_cm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">hourly_data</span><span class="o">.</span><span class="n">station_name</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="c1">#put the legend outside the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>

<span class="c1"># set xlimits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">epoch_start</span><span class="p">,</span> <span class="n">epoch_end</span><span class="p">])</span>

<span class="c1"># set title </span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Tide Gauges (1993-2023)&#39;</span><span class="p">)</span>


<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;TS_full_fig&quot;</span><span class="p">,</span><span class="n">fig</span><span class="p">,</span><span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../_images/70cbc9a48d8fc47f8b65b4b8c42281e88de90d53137019b063e2190edd60f86f.png" src="../_images/70cbc9a48d8fc47f8b65b4b8c42281e88de90d53137019b063e2190edd60f86f.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-ts-full">
<img alt="../_images/6d52f505d8289451d04ae20276460941a51401f0410545e45aef52a4c1c233f5.png" src="../_images/6d52f505d8289451d04ae20276460941a51401f0410545e45aef52a4c1c233f5.png" />
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Full time series at , tide gauge for the entire record from  to . Note that the sea level is plotted in units of cm, relative to .</span><a class="headerlink" href="#fig-ts-full" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="adjust-the-data-from-calendar-year-to-storm-year">
<h3>Adjust the data from calendar year to storm year<a class="headerlink" href="#adjust-the-data-from-calendar-year-to-storm-year" title="Permalink to this heading">#</a></h3>
<p>Storm year goes from May-April. Need to consult with Ayesha about this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#IGNORING FOR NOW, DOES HAWAII DO STORM YEAR?</span>

<span class="c1"># hourly_data[&#39;day&#39;] = ((&#39;time&#39;), hourly_data.time.dt.dayofyear.data)</span>
<span class="c1"># hourly_data[&#39;month&#39;] = ((&#39;time&#39;), hourly_data.time.dt.month.data)    </span>
<span class="c1"># hourly_data[&#39;year&#39;] = ((&#39;time&#39;), hourly_data.time.dt.year.data)</span>

<span class="c1"># # adjust year to storm year, where the storm year starts on May 1st</span>
<span class="c1"># # if the month is less than 5, subtract a year</span>
<span class="c1"># hourly_data[&#39;year_storm&#39;] = ((&#39;time&#39;), hourly_data.year.data - (hourly_data.month.data &lt; 5))</span>

<span class="c1"># hourly_data[&#39;year_storm&#39;] = hourly_data[&#39;year_storm&#39;].astype(int)</span>

<span class="c1"># hourly_data[&#39;year_storm&#39;].values</span>

<span class="c1"># # get the year_storm value for April 15, 1997</span>
<span class="c1"># hourly_data.sel(time=&#39;1997-04-15&#39;)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="assign-a-threshold">
<h3>Assign a Threshold<a class="headerlink" href="#assign-a-threshold" title="Permalink to this heading">#</a></h3>
<p>The threshold used here to determine a flood event is 30 cm above MHHW.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">threshold</span> <span class="o">=</span> <span class="mi">30</span> <span class="c1"># in cm</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">,</span><span class="n">threshold</span><span class="p">,</span><span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">hourly_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:               (time: 359377, record_id: 8)
Coordinates:
  * time                  (time) datetime64[ns] 1983-01-01 ... 2023-12-31
  * record_id             (record_id) int16 520 600 5520 590 570 610 580 500
Data variables: (12/13)
    sea_level             (record_id, time) float32 ...
    lat                   (record_id) float32 ...
    lon                   (record_id) float32 ...
    station_name          (record_id) &lt;U17 &#x27;Johnston&#x27; ... &#x27;Midway&#x27;
    station_country       (record_id) &lt;U30 ...
    station_country_code  (record_id) float32 ...
    ...                    ...
    gloss_id              (record_id) float32 ...
    ssc_id                (record_id) &lt;U4 ...
    last_rq_date          (record_id) datetime64[ns] ...
    MHHW                  (record_id) float64 1.225e+03 1.912e+03 ... 1.204e+03
    sea_level_MHHW        (record_id, time) float64 -920.0 -764.0 ... -3.0 -36.0
    sea_level_MHHW_cm     (record_id, time) float64 -92.0 -76.4 ... -0.3 -3.6
Attributes:
    title:                  UHSLC Fast Delivery Tide Gauge Data (hourly)
    ncei_template_version:  NCEI_NetCDF_TimeSeries_Orthogonal_Template_v2.0
    featureType:            timeSeries
    Conventions:            CF-1.6, ACDD-1.3
    date_created:           2024-03-07T14:27:49Z
    publisher_name:         University of Hawaii Sea Level Center (UHSLC)
    publisher_email:        philiprt@hawaii.edu, markm@soest.hawaii.edu
    publisher_url:          http://uhslc.soest.hawaii.edu
    summary:                The UHSLC assembles and distributes the Fast Deli...
    processing_level:       Fast Delivery (FD) data undergo a level 1 quality...
    acknowledgment:         The UHSLC Fast Delivery database is supported by ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-86d6e634-46d2-43dc-8935-2ee7a73f87d2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-86d6e634-46d2-43dc-8935-2ee7a73f87d2' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 359377</li><li><span class='xr-has-index'>record_id</span>: 8</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-7adcbc73-abb6-4dd4-a7b1-3e8e70965faa' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7adcbc73-abb6-4dd4-a7b1-3e8e70965faa' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1983-01-01 ... 2023-12-31</div><input id='attrs-c8dd58a0-06da-45af-a0d8-0a928dbc125c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c8dd58a0-06da-45af-a0d8-0a928dbc125c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-782debb0-1df1-4fd2-a49b-a30698436c47' class='xr-var-data-in' type='checkbox'><label for='data-782debb0-1df1-4fd2-a49b-a30698436c47' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1983-01-01T00:00:00.000000000&#x27;, &#x27;1983-01-01T01:00:00.028800000&#x27;,
       &#x27;1983-01-01T01:59:59.971200000&#x27;, ..., &#x27;2023-12-30T22:00:00.028800000&#x27;,
       &#x27;2023-12-30T22:59:59.971200000&#x27;, &#x27;2023-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>record_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>int16</div><div class='xr-var-preview xr-preview'>520 600 5520 590 570 610 580 500</div><input id='attrs-2f3dfb49-e08a-4b04-a4cd-5720ba0af1b5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2f3dfb49-e08a-4b04-a4cd-5720ba0af1b5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d7dbb3ea-4ebc-4f73-b7af-b07558cbd12d' class='xr-var-data-in' type='checkbox'><label for='data-d7dbb3ea-4ebc-4f73-b7af-b07558cbd12d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique identifier for each record (i.e., station and version) in the database</dd></dl></div><div class='xr-var-data'><pre>array([ 520,  600, 5520,  590,  570,  610,  580,  500], dtype=int16)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3f0f2f76-2c1e-4791-9d24-547a0b278144' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3f0f2f76-2c1e-4791-9d24-547a0b278144' class='xr-section-summary' >Data variables: <span>(13)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sea_level</span></div><div class='xr-var-dims'>(record_id, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5f5e4968-653b-4c50-ace8-7acce1a117b6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5f5e4968-653b-4c50-ace8-7acce1a117b6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3bb45773-4068-46e1-b06a-e048c760e2f5' class='xr-var-data-in' type='checkbox'><label for='data-3bb45773-4068-46e1-b06a-e048c760e2f5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>relative sea level</dd><dt><span>units :</span></dt><dd>millimeters</dd><dt><span>source :</span></dt><dd>in situ tide gauge water level observations</dd><dt><span>platform :</span></dt><dd>station_name, station_country, station_country_code, uhslc_id, gloss_id, ssc_id</dd></dl></div><div class='xr-var-data'><pre>[2875016 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ef36527c-1a53-4039-bb07-8796f1a0e458' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ef36527c-1a53-4039-bb07-8796f1a0e458' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f839b71f-910a-4901-bc91-d28830dba598' class='xr-var-data-in' type='checkbox'><label for='data-f839b71f-910a-4901-bc91-d28830dba598' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>valid_min :</span></dt><dd>-90</dd><dt><span>valid_max :</span></dt><dd>90</dd></dl></div><div class='xr-var-data'><pre>[8 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e1052d51-55e2-43ef-bf65-cb43bec9a1c9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e1052d51-55e2-43ef-bf65-cb43bec9a1c9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-053fe03e-7c9c-42e1-9b6b-f5d591a9e400' class='xr-var-data-in' type='checkbox'><label for='data-053fe03e-7c9c-42e1-9b6b-f5d591a9e400' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>360</dd></dl></div><div class='xr-var-data'><pre>[8 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_name</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U17</div><div class='xr-var-preview xr-preview'>&#x27;Johnston&#x27; ... &#x27;Midway&#x27;</div><input id='attrs-f6d2cf8c-0560-4436-aa8c-4926fed039b8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f6d2cf8c-0560-4436-aa8c-4926fed039b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20180d9f-a25f-4667-a986-b997177ee705' class='xr-var-data-in' type='checkbox'><label for='data-20180d9f-a25f-4667-a986-b997177ee705' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>station name</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;Johnston&#x27;, &#x27;Hilo, Hawaii&#x27;, &#x27;Kawaihae&#x27;, &#x27;Kahului&#x27;, &#x27;Honolulu, Hawaii&#x27;,
       &#x27;Mokuoloe&#x27;, &#x27;Nawiliwili&#x27;, &#x27;Midway&#x27;], dtype=&#x27;&lt;U17&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U30</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-cd83451a-5a4c-4539-9fa1-25c9b3fd6c3c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cd83451a-5a4c-4539-9fa1-25c9b3fd6c3c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b06924d2-3796-463f-8db8-61ccd2f68da4' class='xr-var-data-in' type='checkbox'><label for='data-b06924d2-3796-463f-8db8-61ccd2f68da4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>station country (ISO 3166-1)</dd></dl></div><div class='xr-var-data'><pre>[8 values with dtype=&lt;U30]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country_code</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-7203259e-2b82-4f8c-8404-984b1a6dbef4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7203259e-2b82-4f8c-8404-984b1a6dbef4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fcea7b57-0d1f-46e8-babd-6dfc6d7d9356' class='xr-var-data-in' type='checkbox'><label for='data-fcea7b57-0d1f-46e8-babd-6dfc6d7d9356' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>station country code (ISO 3166-1 numeric)</dd><dt><span>comment :</span></dt><dd>These are 3-digit country codes (e.g., 003) stored as integers.</dd></dl></div><div class='xr-var-data'><pre>[8 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>uhslc_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>52.0 60.0 552.0 ... 61.0 58.0 50.0</div><input id='attrs-7f8d72d5-5ad1-4c27-8d7f-4415f970916c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7f8d72d5-5ad1-4c27-8d7f-4415f970916c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ad6021b7-7f0c-4421-a5a5-5256293b3638' class='xr-var-data-in' type='checkbox'><label for='data-ad6021b7-7f0c-4421-a5a5-5256293b3638' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique station ID number used by the University of Hawaii Sea Level Center (UHSLC)</dd></dl></div><div class='xr-var-data'><pre>array([ 52.,  60., 552.,  59.,  57.,  61.,  58.,  50.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>gloss_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ae30aac7-1e88-494e-b4c8-bdaaa14b186c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ae30aac7-1e88-494e-b4c8-bdaaa14b186c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a9fff7c1-e86b-4a95-a0f3-f3088f8c84ae' class='xr-var-data-in' type='checkbox'><label for='data-a9fff7c1-e86b-4a95-a0f3-f3088f8c84ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique station ID number used by the WMO/IOC Global Sea Level Observing System (GLOSS)</dd></dl></div><div class='xr-var-data'><pre>[8 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ssc_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0e3dfa00-b755-4f0e-a4ce-86f751775c84' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e3dfa00-b755-4f0e-a4ce-86f751775c84' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc69d375-d856-474f-93b7-157af6f89d51' class='xr-var-data-in' type='checkbox'><label for='data-fc69d375-d856-474f-93b7-157af6f89d51' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique station ID code in the Sealevel Station Catalog (SSC) produced by the WMO/IOC Sea Level Monitoring Facility (VLIZ)</dd><dt><span>comment :</span></dt><dd>Note that SSC IDs vary in length. The IDs are padded with space characters to produce the retangular character matrix provided here.</dd></dl></div><div class='xr-var-data'><pre>[8 values with dtype=&lt;U4]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>last_rq_date</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1bd9aa23-3580-4286-88cd-58cd76ea52fa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1bd9aa23-3580-4286-88cd-58cd76ea52fa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9755a26a-da8b-4080-b8c8-13be7ded0cb1' class='xr-var-data-in' type='checkbox'><label for='data-9755a26a-da8b-4080-b8c8-13be7ded0cb1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>date of last Research Quality sea level value</dd><dt><span>comment :</span></dt><dd>Values in last_rq_date correspond to an identical value in the time vector. Dates less than or equal to last_rq_date for a given station correspond to Research Quality (RQ) data. Dates after last_rq_date correspond to Fast Delivery (FD) data. Missing values indicate no RQ data for a station.</dd></dl></div><div class='xr-var-data'><pre>[8 values with dtype=datetime64[ns]]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>MHHW</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.225e+03 1.912e+03 ... 1.204e+03</div><input id='attrs-05da5af5-cca7-42ea-89be-1904f5799092' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-05da5af5-cca7-42ea-89be-1904f5799092' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b3abfa5-5a41-4aa5-9551-9e3f18764047' class='xr-var-data-in' type='checkbox'><label for='data-9b3abfa5-5a41-4aa5-9551-9e3f18764047' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd><dt><span>long_name :</span></dt><dd>Mean Higher High Water, rel. to station datum</dd></dl></div><div class='xr-var-data'><pre>array([1225., 1912., 1406., 1364., 1722., 1533., 1240., 1204.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sea_level_MHHW</span></div><div class='xr-var-dims'>(record_id, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-920.0 -764.0 -581.0 ... -3.0 -36.0</div><input id='attrs-892f7a5a-37b5-49df-8c11-c47495d9249d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-892f7a5a-37b5-49df-8c11-c47495d9249d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-05de4e29-794e-4673-932e-c5696fb57f3f' class='xr-var-data-in' type='checkbox'><label for='data-05de4e29-794e-4673-932e-c5696fb57f3f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd><dt><span>long_name :</span></dt><dd>Sea Level, relative to MHHW</dd></dl></div><div class='xr-var-data'><pre>array([[-920., -764., -581., ..., -490., -599., -636.],
       [-318., -248., -248., ..., -359., -377., -358.],
       [  nan,   nan,   nan, ..., -365., -428., -441.],
       ...,
       [-299., -286., -329., ..., -324., -325., -300.],
       [-411., -371., -341., ..., -350., -404., -424.],
       [-326., -268., -256., ...,   63.,   -3.,  -36.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sea_level_MHHW_cm</span></div><div class='xr-var-dims'>(record_id, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-92.0 -76.4 -58.1 ... 6.3 -0.3 -3.6</div><input id='attrs-10a2a89b-6050-454f-9c5c-c903b6aa2b0a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-10a2a89b-6050-454f-9c5c-c903b6aa2b0a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-200c29ec-7893-464b-aaf0-201357aa0350' class='xr-var-data-in' type='checkbox'><label for='data-200c29ec-7893-464b-aaf0-201357aa0350' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>cm</dd><dt><span>long_name :</span></dt><dd>Sea Level, relative to MHHW</dd></dl></div><div class='xr-var-data'><pre>array([[-92. , -76.4, -58.1, ..., -49. , -59.9, -63.6],
       [-31.8, -24.8, -24.8, ..., -35.9, -37.7, -35.8],
       [  nan,   nan,   nan, ..., -36.5, -42.8, -44.1],
       ...,
       [-29.9, -28.6, -32.9, ..., -32.4, -32.5, -30. ],
       [-41.1, -37.1, -34.1, ..., -35. , -40.4, -42.4],
       [-32.6, -26.8, -25.6, ...,   6.3,  -0.3,  -3.6]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b24040ed-0686-4d74-bbff-07324f7a6c40' class='xr-section-summary-in' type='checkbox'  ><label for='section-b24040ed-0686-4d74-bbff-07324f7a6c40' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-01426940-809b-4028-bcb8-595f6f8d2d10' class='xr-index-data-in' type='checkbox'/><label for='index-01426940-809b-4028-bcb8-595f6f8d2d10' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([       &#x27;1983-01-01 00:00:00&#x27;, &#x27;1983-01-01 01:00:00.028800&#x27;,
               &#x27;1983-01-01 01:59:59.971200&#x27;,        &#x27;1983-01-01 03:00:00&#x27;,
               &#x27;1983-01-01 04:00:00.028800&#x27;, &#x27;1983-01-01 04:59:59.971200&#x27;,
                      &#x27;1983-01-01 06:00:00&#x27;, &#x27;1983-01-01 07:00:00.028800&#x27;,
               &#x27;1983-01-01 07:59:59.971200&#x27;,        &#x27;1983-01-01 09:00:00&#x27;,
               ...
                      &#x27;2023-12-30 15:00:00&#x27;, &#x27;2023-12-30 16:00:00.028800&#x27;,
               &#x27;2023-12-30 16:59:59.971200&#x27;,        &#x27;2023-12-30 18:00:00&#x27;,
               &#x27;2023-12-30 19:00:00.028800&#x27;, &#x27;2023-12-30 19:59:59.971200&#x27;,
                      &#x27;2023-12-30 21:00:00&#x27;, &#x27;2023-12-30 22:00:00.028800&#x27;,
               &#x27;2023-12-30 22:59:59.971200&#x27;,        &#x27;2023-12-31 00:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=359377, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>record_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e8e6d884-f1ad-4e2b-b017-dc4f0ac8472d' class='xr-index-data-in' type='checkbox'/><label for='index-e8e6d884-f1ad-4e2b-b017-dc4f0ac8472d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([520, 600, 5520, 590, 570, 610, 580, 500], dtype=&#x27;int16&#x27;, name=&#x27;record_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b6904946-988f-4152-bd05-b9fc103a2b7e' class='xr-section-summary-in' type='checkbox'  ><label for='section-b6904946-988f-4152-bd05-b9fc103a2b7e' class='xr-section-summary' >Attributes: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>UHSLC Fast Delivery Tide Gauge Data (hourly)</dd><dt><span>ncei_template_version :</span></dt><dd>NCEI_NetCDF_TimeSeries_Orthogonal_Template_v2.0</dd><dt><span>featureType :</span></dt><dd>timeSeries</dd><dt><span>Conventions :</span></dt><dd>CF-1.6, ACDD-1.3</dd><dt><span>date_created :</span></dt><dd>2024-03-07T14:27:49Z</dd><dt><span>publisher_name :</span></dt><dd>University of Hawaii Sea Level Center (UHSLC)</dd><dt><span>publisher_email :</span></dt><dd>philiprt@hawaii.edu, markm@soest.hawaii.edu</dd><dt><span>publisher_url :</span></dt><dd>http://uhslc.soest.hawaii.edu</dd><dt><span>summary :</span></dt><dd>The UHSLC assembles and distributes the Fast Delivery (FD) dataset of hourly- and daily-averaged tide gauge water-level observations. Tide gauge operators, or data creators, provide FD data to UHSLC after a level 1 quality assessment (see processing_level attribute). The UHSLC provides an independent quality assessment of the time series and makes FD data available within 4-6 weeks of collection. This is a &quot;fast&quot; turnaround time compared to Research Quality (RQ) data, which are available on an annual cycle after a level 2 quality assessment. RQ data replace FD data in the data stream as the former becomes available. This file contains hybrid time series composed of RQ data when available with FD data appended to the end of each RQ series.</dd><dt><span>processing_level :</span></dt><dd>Fast Delivery (FD) data undergo a level 1 quality assessment (e.g., unit and timing evaluation, outlier detection, combination of multiple channels into a primary channel, etc.). In this file, FD data are appended to Research Quality (RQ) data that have received a level 2 quality assessment (e.g., tide gauge datum evaluation, assessment of level ties to tide gauge benchmarks, comparison with nearby stations, etc.).</dd><dt><span>acknowledgment :</span></dt><dd>The UHSLC Fast Delivery database is supported by the National Oceanic and Atmospheric Administration (NOAA) Office of Climate Observations (OCO).</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assuming year_storm is created from the &#39;time&#39; column</span>
<span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;year_storm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;year_storm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;year_storm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="calculate-and-plot-flood-frequency">
<h2>Calculate and Plot Flood Frequency<a class="headerlink" href="#calculate-and-plot-flood-frequency" title="Permalink to this heading">#</a></h2>
<p>To analyze flood frequency, we will look for daily maximum sea levels for each day in our dataset, following <span id="id1">Thompson <em>et al.</em> [<a class="reference internal" href="#id4" title="Philip R. Thompson, Matthew J. Widlansky, Mark A. Merrifield, Janet M. Becker, and John J. Marra. A Statistical Model for Frequency of Coastal Flooding in Honolulu, Hawaii, During the 21st Century. Journal of Geophysical Research: Oceans, 124(4):2787–2802, 2019. URL: https://onlinelibrary.wiley.com/doi/abs/10.1029/2018JC014741, doi:10.1029/2018JC014741.">TWM+19</a>]</span> and others. Then, we can group our data by year and month to visualize temporal patterns in daily SWL exceedance.</p>
<figure class="margin align-default" id="fig-histogram">
<img alt="../_images/3e14d2e8705329c44d39acd2da7bf7e1fe06c7379c9d15d0eda6439bec527fdd.png" src="../_images/3e14d2e8705329c44d39acd2da7bf7e1fe06c7379c9d15d0eda6439bec527fdd.png" />
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">Histogram of daily maximum water levels at <span class="pasted-text">Hawaiian Islands</span> tide gauges for the entire record from <span class="pasted-text">1983-01-01</span> to <span class="pasted-text">2023-12-31</span>, relative to . The dashed red line indicates the chosen threshold of <span class="pasted-text">30</span> cm.</span><a class="headerlink" href="#fig-histogram" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Note this next code block takes a bit of time. Patience!</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resample the hourly data to daily maximum sea level</span>
<span class="n">SL_daily_max</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">SL_daily_max</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Resample the hourly data to daily maximum sea level</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">SL_daily_max</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">SL_daily_max</span>

<span class="nn">File ~/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/core/_aggregations.py:4252,</span> in <span class="ni">DatasetResampleAggregations.max</span><span class="nt">(self, dim, skipna, keep_attrs, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">4242</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flox_reduce</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4243</span>         <span class="n">func</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4244</span>         <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4249</span>         <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4250</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4251</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">4252</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4253</span>         <span class="n">duck_array_ops</span><span class="o">.</span><span class="n">max</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4254</span>         <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4255</span>         <span class="n">skipna</span><span class="o">=</span><span class="n">skipna</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4256</span>         <span class="n">numeric_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4257</span>         <span class="n">keep_attrs</span><span class="o">=</span><span class="n">keep_attrs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4258</span>         <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4259</span>     <span class="p">)</span>

<span class="nn">File ~/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/core/resample.py:387,</span> in <span class="ni">DatasetResample.reduce</span><span class="nt">(self, func, dim, axis, keep_attrs, keepdims, shortcut, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">352</span> <span class="k">def</span> <span class="nf">reduce</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">353</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">354</span>     <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">361</span>     <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">362</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dataset</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">363</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Reduce the items in this group by applying `func` along the</span>
<span class="g g-Whitespace">    </span><span class="mi">364</span><span class="sd">     pre-defined resampling dimension.</span>
<span class="g g-Whitespace">    </span><span class="mi">365</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">385</span><span class="sd">         removed.</span>
<span class="g g-Whitespace">    </span><span class="mi">386</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">387</span>     <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">388</span>         <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">389</span>         <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">390</span>         <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">391</span>         <span class="n">keep_attrs</span><span class="o">=</span><span class="n">keep_attrs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">392</span>         <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">393</span>         <span class="n">shortcut</span><span class="o">=</span><span class="n">shortcut</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">394</span>         <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">395</span>     <span class="p">)</span>

<span class="nn">File ~/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/core/groupby.py:1654,</span> in <span class="ni">DatasetGroupByBase.reduce</span><span class="nt">(self, func, dim, axis, keep_attrs, keepdims, shortcut, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1643</span>     <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1644</span>         <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1645</span>         <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1649</span>         <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1650</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1652</span> <span class="n">check_reduce_dims</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1654</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">reduce_dataset</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/core/resample.py:323,</span> in <span class="ni">DatasetResample.map</span><span class="nt">(self, func, args, shortcut, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span> <span class="c1"># ignore shortcut if set (for now)</span>
<span class="nn">    322 applied = (func(ds, *args, **kwargs) for ds</span> in <span class="ni">self._iter_grouped</span><span class="nt">())</span>
<span class="ne">--&gt; </span><span class="mi">323</span> <span class="n">combined</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_combine</span><span class="p">(</span><span class="n">applied</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span> <span class="c1"># If the aggregation function didn&#39;t drop the original resampling</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span> <span class="c1"># dimension, then we need to do so before we can rename the proxy</span>
<span class="g g-Whitespace">    </span><span class="mi">327</span> <span class="c1"># dimension we used.</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dim</span> <span class="ow">in</span> <span class="n">combined</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>

<span class="nn">File ~/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/core/groupby.py:1584,</span> in <span class="ni">DatasetGroupByBase._combine</span><span class="nt">(self, applied)</span>
<span class="g g-Whitespace">   </span><span class="mi">1582</span> <span class="n">applied_example</span><span class="p">,</span> <span class="n">applied</span> <span class="o">=</span> <span class="n">peek_at</span><span class="p">(</span><span class="n">applied</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1583</span> <span class="n">coord</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infer_concat_args</span><span class="p">(</span><span class="n">applied_example</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1584</span> <span class="n">combined</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">applied</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1585</span> <span class="p">(</span><span class="n">grouper</span><span class="p">,)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupers</span>
<span class="g g-Whitespace">   </span><span class="mi">1586</span> <span class="n">combined</span> <span class="o">=</span> <span class="n">_maybe_reorder</span><span class="p">(</span><span class="n">combined</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">grouper</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/core/concat.py:252,</span> in <span class="ni">concat</span><span class="nt">(objs, dim, data_vars, coords, compat, positions, fill_value, join, combine_attrs)</span>
<span class="g g-Whitespace">    </span><span class="mi">240</span>     <span class="k">return</span> <span class="n">_dataarray_concat</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">241</span>         <span class="n">objs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">242</span>         <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span>         <span class="n">combine_attrs</span><span class="o">=</span><span class="n">combine_attrs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">250</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">251</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_obj</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">252</span>     <span class="k">return</span> <span class="n">_dataset_concat</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">253</span>         <span class="n">objs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">254</span>         <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">255</span>         <span class="n">data_vars</span><span class="o">=</span><span class="n">data_vars</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">256</span>         <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">257</span>         <span class="n">compat</span><span class="o">=</span><span class="n">compat</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">258</span>         <span class="n">positions</span><span class="o">=</span><span class="n">positions</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">259</span>         <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="n">join</span><span class="o">=</span><span class="n">join</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="n">combine_attrs</span><span class="o">=</span><span class="n">combine_attrs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">262</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span>     <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">265</span>         <span class="s2">&quot;can only concatenate xarray Dataset and DataArray &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">266</span>         <span class="sa">f</span><span class="s2">&quot;objects, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">first_obj</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">267</span>     <span class="p">)</span>

<span class="nn">File ~/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/core/concat.py:591,</span> in <span class="ni">_dataset_concat</span><span class="nt">(datasets, dim, data_vars, coords, compat, positions, fill_value, join, combine_attrs)</span>
<span class="g g-Whitespace">    </span><span class="mi">589</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">590</span>     <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">591</span>         <span class="n">variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">592</span>         <span class="n">var_concat_dim_length</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">concat_dim_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">593</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">594</span>         <span class="c1"># raise if coordinate not in all datasets</span>

<span class="nn">File ~/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/core/dataset.py:1545,</span> in <span class="ni">Dataset.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">1543</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="o">**</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1544</span> <span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">hashable</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1545</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_dataarray</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1546</span> <span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">iterable_of_hashable</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1547</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_copy_listed</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/core/dataset.py:1461,</span> in <span class="ni">Dataset._construct_dataarray</span><span class="nt">(self, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">1457</span>         <span class="n">coords</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1459</span> <span class="n">indexes</span> <span class="o">=</span> <span class="n">filter_indexes_from_coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indexes</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">coords</span><span class="p">))</span>
<span class="ne">-&gt; </span><span class="mi">1461</span> <span class="k">return</span> <span class="n">DataArray</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">indexes</span><span class="o">=</span><span class="n">indexes</span><span class="p">,</span> <span class="n">fastpath</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/envs/SLI39/lib/python3.9/site-packages/xarray/core/dataarray.py:400,</span> in <span class="ni">DataArray.__init__</span><span class="nt">(self, data, coords, dims, name, attrs, indexes, fastpath)</span>
<span class="g g-Whitespace">    </span><span class="mi">388</span> <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">389</span>     <span class="s2">&quot;_cache&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">390</span>     <span class="s2">&quot;_coords&quot;</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">395</span>     <span class="s2">&quot;__weakref__&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">UncachedAccessor</span><span class="p">(</span><span class="n">CombinedDatetimelikeAccessor</span><span class="p">[</span><span class="s2">&quot;DataArray&quot;</span><span class="p">])</span>
<span class="ne">--&gt; </span><span class="mi">400</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">401</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">402</span>     <span class="n">data</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">NA</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">403</span>     <span class="n">coords</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="n">DataArray</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">404</span>     <span class="o">|</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">405</span>     <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">406</span>     <span class="n">dims</span><span class="p">:</span> <span class="n">Hashable</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Hashable</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">407</span>     <span class="n">name</span><span class="p">:</span> <span class="n">Hashable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">408</span>     <span class="n">attrs</span><span class="p">:</span> <span class="n">Mapping</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">409</span>     <span class="c1"># internal parameters</span>
<span class="g g-Whitespace">    </span><span class="mi">410</span>     <span class="n">indexes</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Index</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">411</span>     <span class="n">fastpath</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">412</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">413</span>     <span class="k">if</span> <span class="n">fastpath</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">414</span>         <span class="n">variable</span> <span class="o">=</span> <span class="n">data</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a new figure that is 15 x 5</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SL_daily_max</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">SL_daily_max</span><span class="o">.</span><span class="n">sea_level_MHHW</span><span class="o">.</span><span class="n">values</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date (Calendar Year)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sea Level (cm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sea Level Daily Maximum Time Series&#39;</span><span class="p">)</span>

<span class="c1"># # add a horizontal line at the threshold</span>
<span class="c1"># plt.axhline(threshold, color=&#39;r&#39;, linestyle=&#39;--&#39;, label=&#39;Threshold&#39;)</span>


<span class="c1"># # Correcting the threshold to find days when sea_level_MHHW is greater than 300 mm</span>
<span class="c1"># days_above_threshold = SL_daily_max.where(SL_daily_max.sea_level_MHHW/10 &gt; threshold, drop=True)</span>

<span class="c1"># # Highlighting the days above the threshold for each record_id</span>
<span class="c1"># for record_id in days_above_threshold.record_id.values:</span>
<span class="c1">#     above_threshold_per_record = days_above_threshold.sea_level_MHHW.sel(record_id=record_id)</span>
<span class="c1">#     ax.scatter(above_threshold_per_record.time.values, above_threshold_per_record.values / 10)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Sea Level Daily Maximum Time Series&#39;)
</pre></div>
</div>
<img alt="../_images/8a5e46df7183c908bc349ac491df6fbe160d72c2690a609f9b0ca9dfa4827ac7.png" src="../_images/8a5e46df7183c908bc349ac491df6fbe160d72c2690a609f9b0ca9dfa4827ac7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sea_level_data_cm</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">/</span><span class="mi">10</span> <span class="c1"># convert to cm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW_cm&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,:],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sea Level Data&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW_cm&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,:],</span> <span class="mi">99</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;97.5th Percentile&#39;</span><span class="p">)</span>

    <span class="c1"># remove y-axis label for all</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sea Level (cm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># set xlim to -150,75</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>

<span class="n">threshold_percentile</span> <span class="o">=</span> <span class="mi">99</span>
<span class="c1">#make threshold for (XX))th percentile on each gauge</span>
<span class="n">thresholds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW_cm&#39;</span><span class="p">],</span> <span class="n">threshold_percentile</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;threshold_percentile&quot;</span><span class="p">,</span><span class="n">threshold_percentile</span><span class="p">,</span><span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6c44b4673f68373330ba71d0af80a7f3e6beed5f7e99b083cbc37590a9284666.png" src="../_images/6c44b4673f68373330ba71d0af80a7f3e6beed5f7e99b083cbc37590a9284666.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">thresholds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([18.3, 20.6, 27.7, 23.7, 19.5, 18.3, 19.5, 20.8])
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a pdf of the data with 95th percentile threshold</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;sea_level_MHHW_cm&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,:],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sea Level Data&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Threshold: </span><span class="si">{:.4f}</span><span class="s1"> cm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">threshold</span><span class="p">))</span>

    <span class="c1"># remove y-axis label for all</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sea Level (cm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sea Level (cm)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="c1"># make the title two lines</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sea Level Histogram</span><span class="se">\n</span><span class="s1">with Defined Threshold&#39;</span><span class="p">)</span>

<span class="c1"># add label to dashed line</span>
<span class="c1"># get value of middle of y-axis for label placement</span>
<span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
<span class="n">yrange</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span>
<span class="n">y_middle</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">+</span> <span class="n">yrange</span><span class="o">/</span><span class="mi">2</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="n">y_middle</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:.1f}</span><span class="s1"> cm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">threshold</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;histogram_fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../_images/3e14d2e8705329c44d39acd2da7bf7e1fe06c7379c9d15d0eda6439bec527fdd.png" src="../_images/3e14d2e8705329c44d39acd2da7bf7e1fe06c7379c9d15d0eda6439bec527fdd.png" />
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flood_day</span> <span class="o">=</span> <span class="p">(</span><span class="n">SL_daily_max</span><span class="o">.</span><span class="n">sea_level_MHHW_cm</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">thresholds</span><span class="p">)</span>
<span class="n">SL_daily_max</span>

<span class="n">flood_hour</span> <span class="o">=</span> <span class="p">(</span><span class="n">hourly_data</span><span class="o">.</span><span class="n">sea_level_MHHW_cm</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">thresholds</span><span class="p">[:,</span><span class="kc">None</span><span class="p">])</span>
<span class="n">flood_hour</span>

<span class="c1"># flip the array so that the first dimension is time</span>
<span class="n">flood_hour</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">flood_hour</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add the &#39;flood_day&#39; variable to the dataset</span>
<span class="n">SL_daily_max</span><span class="p">[</span><span class="s1">&#39;flood_day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">flood_day</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Filtering for flood days again now that &#39;flood_day&#39; has been correctly added</span>
<span class="n">flood_days_data</span> <span class="o">=</span> <span class="n">SL_daily_max</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">SL_daily_max</span><span class="o">.</span><span class="n">flood_day</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Initialize an empty DataFrame again for the loop</span>
<span class="n">flood_days_per_year</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">record_id</span> <span class="ow">in</span> <span class="n">SL_daily_max</span><span class="o">.</span><span class="n">record_id</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="c1"># Extracting flood days for each record_id</span>
    <span class="n">flood_days_df</span> <span class="o">=</span> <span class="n">flood_days_data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">record_id</span><span class="o">=</span><span class="n">record_id</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    
    <span class="c1"># Extract year from the &#39;time&#39; column and count flood days</span>
    <span class="n">flood_days_df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flood_days_df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
    <span class="n">flood_days_count</span> <span class="o">=</span> <span class="n">flood_days_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">record_id</span><span class="p">)</span>
    
    <span class="c1"># Merge this count with the main DataFrame</span>
    <span class="k">if</span> <span class="n">flood_days_per_year</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">flood_days_per_year</span> <span class="o">=</span> <span class="n">flood_days_count</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">flood_days_per_year</span> <span class="o">=</span> <span class="n">flood_days_per_year</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flood_days_count</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>

<span class="c1"># Replace missing values with 0</span>
<span class="n">flood_days_per_year</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">flood_days_per_year</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">flood_days_per_year</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="n">flood_days_per_year</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;record_id&#39;</span><span class="p">:</span> <span class="n">flood_days_per_year</span><span class="o">.</span><span class="n">columns</span><span class="p">})</span>

<span class="n">flood_days_per_year</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (year: 41, record_id: 8)&gt; Size: 3kB
array([[ 37.,  30.,   0.,  19.,  13.,  16.,  19.,   9.],
       [ 36.,  40.,   0.,  41.,  61.,  51.,  43.,  13.],
       [ 14.,  14.,   0.,  27.,  25.,  24.,  48.,   5.],
       [ 15.,  11.,   0.,   4.,   5.,   3.,   6.,  16.],
       [ 12.,  33.,   0.,  27.,  17.,  13.,   6.,  12.],
       [ 53.,  32.,   0.,  77.,  61.,  59.,  51.,   7.],
       [ 22.,  17.,   3.,   9.,  19.,  20.,  21.,   6.],
       [ 12.,   6.,   1.,   7.,   3.,  10.,  21.,   4.],
       [ 11.,  23.,   3.,  21.,  23.,   8.,  24.,   2.],
       [ 33.,  38.,   0.,  42.,  30.,  37.,  29.,   8.],
       [ 19.,  39.,   3.,  28.,   8.,  17.,  25.,  11.],
       [ 24.,   4.,   0.,  16.,  15.,   9.,  13.,   2.],
       [ 31.,  14.,   2.,  35.,  42.,  35.,  25.,  13.],
       [ 49.,  43.,   3.,  47.,  34.,  34.,  36.,   8.],
       [ 21.,  29.,   1.,  16.,  11.,  14.,  12.,   4.],
       [ 30.,   9.,   0.,   5.,   1.,   4.,   0.,  29.],
       [ 22.,  15.,   4.,  16.,  11.,   8.,  11.,   8.],
       [  4.,   3.,   0.,  13.,   7.,   7.,   6.,  14.],
       [ 44.,  29.,  10.,  33.,  19.,  25.,   7.,  10.],
       [ 27.,  22.,   0.,  15.,   7.,   6.,  10.,   9.],
...
       [ 23.,  91.,  33.,  87.,  76.,  85.,  37.,  27.],
       [  0.,  53.,  13.,  61.,  43.,  42.,  31.,  16.],
       [  0.,  46.,  31.,  79.,  67.,  73.,  63.,  10.],
       [  0.,  45.,  56.,  49.,  43.,  57.,  30.,  12.],
       [ 25.,  36.,  53.,  42.,  44.,  37.,  43.,  18.],
       [  4.,  30.,  30.,  21.,  13.,  15.,  11.,  28.],
       [ 54.,  38.,  48.,  41.,  31.,  38.,  29.,  38.],
       [ 63.,  20.,  32.,  32.,  17.,  21.,  21.,  11.],
       [ 31.,   7.,  12.,  11.,   8.,   8.,  16.,  69.],
       [ 41.,  18.,  30.,  29.,  14.,  17.,  35.,  35.],
       [ 20.,  49.,  49.,  47.,  29.,  35.,  46.,  44.],
       [ 32.,  46.,  63.,  42.,  12.,  15.,  35.,  20.],
       [ 69.,  72.,  82.,  69.,  66.,  62.,  73.,   7.],
       [ 84., 129., 144., 122., 118., 130., 112.,  31.],
       [ 31.,  80.,  92.,  60.,  52.,  50.,  46.,  31.],
       [ 36.,  98., 123.,  84.,  81.,  72.,  73.,  39.],
       [ 47., 140., 163., 147., 173., 155.,  98.,   8.],
       [ 58.,  52.,  45.,  53.,  74.,  54.,  67.,  46.],
       [ 32.,  43.,  15.,  51.,  44.,  31.,  62.,  55.],
       [ 67.,  72.,  54.,  77.,  69.,  72., 126.,  58.]])
Coordinates:
  * year       (year) int32 164B 1983 1984 1985 1986 ... 2020 2021 2022 2023
  * record_id  (record_id) int64 64B 520 600 5520 590 570 610 580 500</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 41</li><li><span class='xr-has-index'>record_id</span>: 8</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-b6488ccf-46c1-4257-977b-7fce440d56c7' class='xr-array-in' type='checkbox' checked><label for='section-b6488ccf-46c1-4257-977b-7fce440d56c7' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>37.0 30.0 0.0 19.0 13.0 16.0 19.0 ... 54.0 77.0 69.0 72.0 126.0 58.0</span></div><div class='xr-array-data'><pre>array([[ 37.,  30.,   0.,  19.,  13.,  16.,  19.,   9.],
       [ 36.,  40.,   0.,  41.,  61.,  51.,  43.,  13.],
       [ 14.,  14.,   0.,  27.,  25.,  24.,  48.,   5.],
       [ 15.,  11.,   0.,   4.,   5.,   3.,   6.,  16.],
       [ 12.,  33.,   0.,  27.,  17.,  13.,   6.,  12.],
       [ 53.,  32.,   0.,  77.,  61.,  59.,  51.,   7.],
       [ 22.,  17.,   3.,   9.,  19.,  20.,  21.,   6.],
       [ 12.,   6.,   1.,   7.,   3.,  10.,  21.,   4.],
       [ 11.,  23.,   3.,  21.,  23.,   8.,  24.,   2.],
       [ 33.,  38.,   0.,  42.,  30.,  37.,  29.,   8.],
       [ 19.,  39.,   3.,  28.,   8.,  17.,  25.,  11.],
       [ 24.,   4.,   0.,  16.,  15.,   9.,  13.,   2.],
       [ 31.,  14.,   2.,  35.,  42.,  35.,  25.,  13.],
       [ 49.,  43.,   3.,  47.,  34.,  34.,  36.,   8.],
       [ 21.,  29.,   1.,  16.,  11.,  14.,  12.,   4.],
       [ 30.,   9.,   0.,   5.,   1.,   4.,   0.,  29.],
       [ 22.,  15.,   4.,  16.,  11.,   8.,  11.,   8.],
       [  4.,   3.,   0.,  13.,   7.,   7.,   6.,  14.],
       [ 44.,  29.,  10.,  33.,  19.,  25.,   7.,  10.],
       [ 27.,  22.,   0.,  15.,   7.,   6.,  10.,   9.],
...
       [ 23.,  91.,  33.,  87.,  76.,  85.,  37.,  27.],
       [  0.,  53.,  13.,  61.,  43.,  42.,  31.,  16.],
       [  0.,  46.,  31.,  79.,  67.,  73.,  63.,  10.],
       [  0.,  45.,  56.,  49.,  43.,  57.,  30.,  12.],
       [ 25.,  36.,  53.,  42.,  44.,  37.,  43.,  18.],
       [  4.,  30.,  30.,  21.,  13.,  15.,  11.,  28.],
       [ 54.,  38.,  48.,  41.,  31.,  38.,  29.,  38.],
       [ 63.,  20.,  32.,  32.,  17.,  21.,  21.,  11.],
       [ 31.,   7.,  12.,  11.,   8.,   8.,  16.,  69.],
       [ 41.,  18.,  30.,  29.,  14.,  17.,  35.,  35.],
       [ 20.,  49.,  49.,  47.,  29.,  35.,  46.,  44.],
       [ 32.,  46.,  63.,  42.,  12.,  15.,  35.,  20.],
       [ 69.,  72.,  82.,  69.,  66.,  62.,  73.,   7.],
       [ 84., 129., 144., 122., 118., 130., 112.,  31.],
       [ 31.,  80.,  92.,  60.,  52.,  50.,  46.,  31.],
       [ 36.,  98., 123.,  84.,  81.,  72.,  73.,  39.],
       [ 47., 140., 163., 147., 173., 155.,  98.,   8.],
       [ 58.,  52.,  45.,  53.,  74.,  54.,  67.,  46.],
       [ 32.,  43.,  15.,  51.,  44.,  31.,  62.,  55.],
       [ 67.,  72.,  54.,  77.,  69.,  72., 126.,  58.]])</pre></div></div></li><li class='xr-section-item'><input id='section-3f5cde25-70f7-4f3d-abde-7d113fce5f74' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3f5cde25-70f7-4f3d-abde-7d113fce5f74' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1983 1984 1985 ... 2021 2022 2023</div><input id='attrs-9c9f8b4e-d39d-448c-86b0-698dba3edf42' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9c9f8b4e-d39d-448c-86b0-698dba3edf42' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5c29f2ec-885e-40a7-947e-94b3827cf754' class='xr-var-data-in' type='checkbox'><label for='data-5c29f2ec-885e-40a7-947e-94b3827cf754' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994,
       1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006,
       2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,
       2019, 2020, 2021, 2022, 2023], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>record_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>520 600 5520 590 570 610 580 500</div><input id='attrs-b94fd081-5361-458f-adee-ba507e0a65f2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b94fd081-5361-458f-adee-ba507e0a65f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c478108b-b181-419d-bae6-9af3e8e413bc' class='xr-var-data-in' type='checkbox'><label for='data-c478108b-b181-419d-bae6-9af3e8e413bc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 520,  600, 5520,  590,  570,  610,  580,  500])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-51479a1b-de72-4e33-8771-ce448c2acd9c' class='xr-section-summary-in' type='checkbox'  ><label for='section-51479a1b-de72-4e33-8771-ce448c2acd9c' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7ccbf8b6-3929-4f9b-b1e9-65c193b42e38' class='xr-index-data-in' type='checkbox'/><label for='index-7ccbf8b6-3929-4f9b-b1e9-65c193b42e38' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994,
       1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006,
       2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,
       2019, 2020, 2021, 2022, 2023],
      dtype=&#x27;int32&#x27;, name=&#x27;year&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>record_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3e61d236-e1fa-4fbb-9145-967455a1d934' class='xr-index-data-in' type='checkbox'/><label for='index-3e61d236-e1fa-4fbb-9145-967455a1d934' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([520, 600, 5520, 590, 570, 610, 580, 500], dtype=&#x27;int64&#x27;, name=&#x27;record_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-00260d0c-528c-4478-881c-0d260274b97a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-00260d0c-528c-4478-881c-0d260274b97a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add the &#39;flood_day&#39; variable to the dataset</span>
<span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;flood_hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">flood_hour</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># Filtering for flood days again now that &#39;flood_hour&#39; has been correctly added</span>
<span class="n">flood_hours_data</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">hourly_data</span><span class="o">.</span><span class="n">flood_hour</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Initialize an empty DataFrame again for the loop</span>
<span class="n">flood_hours_per_year</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">record_id</span> <span class="ow">in</span> <span class="n">hourly_data</span><span class="o">.</span><span class="n">record_id</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="c1"># Extracting flood days for each record_id</span>
    <span class="n">flood_hours_df</span> <span class="o">=</span> <span class="n">flood_hours_data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">record_id</span><span class="o">=</span><span class="n">record_id</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
  
    <span class="c1"># Extract year from the &#39;time&#39; column and count flood days</span>
    <span class="n">flood_hours_df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flood_hours_df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
    <span class="n">flood_hours_count</span> <span class="o">=</span> <span class="n">flood_hours_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">record_id</span><span class="p">)</span>
  
    <span class="c1"># Merge this count with the main DataFrame</span>
    <span class="k">if</span> <span class="n">flood_hours_per_year</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">flood_hours_per_year</span> <span class="o">=</span> <span class="n">flood_hours_count</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">flood_hours_per_year</span> <span class="o">=</span> <span class="n">flood_hours_per_year</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flood_hours_count</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="c1"># Replace missing values with 0</span>
<span class="n">flood_hours_per_year</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">flood_hours_per_year</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">flood_hours_per_year</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="n">flood_hours_per_year</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;record_id&#39;</span><span class="p">:</span> <span class="n">flood_hours_per_year</span><span class="o">.</span><span class="n">columns</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#make new xarray dataset with attributes from SL_daily_max</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>

<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;flood_hours_per_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">flood_hours_per_year</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;flood_days_per_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">flood_days_per_year</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;flood_days_per_year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of flood days per year&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;days&#39;</span><span class="p">}</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;flood_hours_per_year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of flood hours per year&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;hours&#39;</span><span class="p">}</span>

<span class="c1"># set year and record_id as coordinates</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flood_hours_per_year</span><span class="o">.</span><span class="n">year</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flood_hours_per_year</span><span class="o">.</span><span class="n">record_id</span>

<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;calendar year&#39;</span><span class="p">}</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Record ID&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">}</span>


<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SL_daily_max</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_north&#39;</span><span class="p">}</span>

<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SL_daily_max</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_east&#39;</span><span class="p">}</span>

<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SL_daily_max</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Station Name&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">}</span>

<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SL_daily_max</span><span class="p">[</span><span class="s1">&#39;station_country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Station Country&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">}</span>

<span class="c1">#remove time as coordinate</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 7kB
Dimensions:               (year: 41, record_id: 8)
Coordinates:
  * year                  (year) int32 164B 1983 1984 1985 ... 2021 2022 2023
  * record_id             (record_id) int16 16B 520 600 5520 590 570 610 580 500
Data variables:
    flood_hours_per_year  (year, record_id) float64 3kB 71.0 56.0 ... 221.0
    flood_days_per_year   (year, record_id) float64 3kB 37.0 30.0 ... 126.0 58.0
    lat                   (record_id) float32 32B 16.75 19.73 ... 21.97 28.22
    lon                   (record_id) float32 32B 190.5 204.9 ... 200.6 182.6
    station_name          (record_id) &lt;U17 544B &#x27;Johnston&#x27; ... &#x27;Midway&#x27;
    station_country       (record_id) &lt;U30 960B &#x27;United States of America (th...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a5729adc-b5f7-4152-b28d-3f9332360419' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a5729adc-b5f7-4152-b28d-3f9332360419' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 41</li><li><span class='xr-has-index'>record_id</span>: 8</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-9f391d88-6f1d-49f6-b133-e161c615fe4e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9f391d88-6f1d-49f6-b133-e161c615fe4e' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1983 1984 1985 ... 2021 2022 2023</div><input id='attrs-dde2dc5a-ee28-4976-ac11-4b54160b267e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dde2dc5a-ee28-4976-ac11-4b54160b267e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1e4733a-3f4e-42f3-9906-4b29bed0c324' class='xr-var-data-in' type='checkbox'><label for='data-e1e4733a-3f4e-42f3-9906-4b29bed0c324' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Year</dd><dt><span>units :</span></dt><dd>calendar year</dd></dl></div><div class='xr-var-data'><pre>array([1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994,
       1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006,
       2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,
       2019, 2020, 2021, 2022, 2023], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>record_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>int16</div><div class='xr-var-preview xr-preview'>520 600 5520 590 570 610 580 500</div><input id='attrs-c8550dbf-5d8e-4769-a234-9b0c02b87467' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c8550dbf-5d8e-4769-a234-9b0c02b87467' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-148f321d-2027-49b1-9bf4-164d21f3ea88' class='xr-var-data-in' type='checkbox'><label for='data-148f321d-2027-49b1-9bf4-164d21f3ea88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique identifier for each record (i.e., station and version) in the database</dd></dl></div><div class='xr-var-data'><pre>array([ 520,  600, 5520,  590,  570,  610,  580,  500], dtype=int16)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4ee21865-0960-45ff-953c-6786c3c7d2e8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4ee21865-0960-45ff-953c-6786c3c7d2e8' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>flood_hours_per_year</span></div><div class='xr-var-dims'>(year, record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>71.0 56.0 0.0 ... 169.0 374.0 221.0</div><input id='attrs-f2358c06-4782-4dbc-835b-5b269dbce9a7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f2358c06-4782-4dbc-835b-5b269dbce9a7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dec675a5-5b5b-48f7-8c08-29f3db6eb1d9' class='xr-var-data-in' type='checkbox'><label for='data-dec675a5-5b5b-48f7-8c08-29f3db6eb1d9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Number of flood hours per year</dd><dt><span>units :</span></dt><dd>hours</dd></dl></div><div class='xr-var-data'><pre>array([[ 71.,  56.,   0.,  35.,  28.,  26.,  32.,  19.],
       [ 75.,  73.,   0.,  70., 115., 102.,  97.,  77.],
       [ 25.,  19.,   0.,  39.,  53.,  54., 128.,  17.],
       [ 40.,  21.,   0.,   7.,   8.,   6.,  11.,  83.],
       [ 25.,  69.,   0.,  57.,  38.,  27.,  17.,  48.],
       [109.,  67.,   0., 145., 117., 113., 114.,  26.],
       [ 44.,  25.,   4.,  16.,  33.,  36.,  35.,  47.],
       [ 20.,  12.,   1.,  10.,   4.,  15.,  41.,  12.],
       [ 16.,  50.,   5.,  31.,  46.,  18.,  49.,   4.],
       [ 62.,  78.,   0.,  74.,  63.,  78.,  52.,  46.],
       [ 35.,  75.,   6.,  52.,  17.,  34.,  45.,  19.],
       [ 78.,   4.,   0.,  19.,  24.,  14.,  24.,  15.],
       [ 76.,  22.,   2.,  72., 105.,  82.,  57.,  46.],
       [124.,  81.,   5.,  82.,  68.,  71.,  68.,  44.],
       [ 46.,  53.,   2.,  24.,  16.,  16.,  20.,   7.],
       [ 60.,  15.,   0.,   6.,   1.,   6.,   0., 156.],
       [ 48.,  27.,   5.,  25.,  22.,  15.,  20.,  31.],
       [  4.,   5.,   0.,  21.,  14.,  13.,   9.,  53.],
       [ 98.,  63.,  17.,  65.,  29.,  45.,  11.,  46.],
       [ 48.,  36.,   0.,  25.,  13.,  11.,  18.,  21.],
...
       [ 53., 196.,  68., 163., 180., 206.,  74., 218.],
       [  0., 109.,  23., 110.,  83.,  83.,  74., 108.],
       [  0.,  88.,  70., 158., 145., 156., 164.,  30.],
       [  0.,  84., 127.,  96.,  88., 114.,  66.,  53.],
       [ 52.,  75., 125.,  95., 106.,  84.,  94.,  68.],
       [  6.,  57.,  58.,  38.,  25.,  27.,  24.,  81.],
       [137.,  73.,  94.,  70.,  64.,  72.,  61., 140.],
       [188.,  35.,  57.,  53.,  24.,  30.,  38.,  91.],
       [ 75.,  13.,  22.,  17.,  15.,  16.,  22., 289.],
       [ 84.,  32.,  60.,  46.,  23.,  29.,  70., 122.],
       [ 49.,  99., 102.,  86.,  55.,  67.,  92., 155.],
       [ 91.,  76., 125.,  66.,  14.,  22.,  93.,  92.],
       [196., 171., 198., 133., 145., 150., 166.,  33.],
       [240., 289., 359., 288., 308., 301., 269., 133.],
       [ 67., 178., 209., 118., 124., 121., 109., 120.],
       [ 95., 255., 331., 190., 212., 206., 181., 146.],
       [105., 365., 510., 386., 496., 440., 271.,  24.],
       [136., 126., 123., 110., 169., 128., 163., 157.],
       [ 81.,  81.,  26.,  93.,  82.,  67., 130., 249.],
       [187., 164., 106., 173., 151., 169., 374., 221.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>flood_days_per_year</span></div><div class='xr-var-dims'>(year, record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>37.0 30.0 0.0 ... 72.0 126.0 58.0</div><input id='attrs-6f7260ff-0a77-4e6e-813a-0ad60cc9753f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6f7260ff-0a77-4e6e-813a-0ad60cc9753f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d8da580a-442e-4d0f-b2df-042fe4a877da' class='xr-var-data-in' type='checkbox'><label for='data-d8da580a-442e-4d0f-b2df-042fe4a877da' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Number of flood days per year</dd><dt><span>units :</span></dt><dd>days</dd></dl></div><div class='xr-var-data'><pre>array([[ 37.,  30.,   0.,  19.,  13.,  16.,  19.,   9.],
       [ 36.,  40.,   0.,  41.,  61.,  51.,  43.,  13.],
       [ 14.,  14.,   0.,  27.,  25.,  24.,  48.,   5.],
       [ 15.,  11.,   0.,   4.,   5.,   3.,   6.,  16.],
       [ 12.,  33.,   0.,  27.,  17.,  13.,   6.,  12.],
       [ 53.,  32.,   0.,  77.,  61.,  59.,  51.,   7.],
       [ 22.,  17.,   3.,   9.,  19.,  20.,  21.,   6.],
       [ 12.,   6.,   1.,   7.,   3.,  10.,  21.,   4.],
       [ 11.,  23.,   3.,  21.,  23.,   8.,  24.,   2.],
       [ 33.,  38.,   0.,  42.,  30.,  37.,  29.,   8.],
       [ 19.,  39.,   3.,  28.,   8.,  17.,  25.,  11.],
       [ 24.,   4.,   0.,  16.,  15.,   9.,  13.,   2.],
       [ 31.,  14.,   2.,  35.,  42.,  35.,  25.,  13.],
       [ 49.,  43.,   3.,  47.,  34.,  34.,  36.,   8.],
       [ 21.,  29.,   1.,  16.,  11.,  14.,  12.,   4.],
       [ 30.,   9.,   0.,   5.,   1.,   4.,   0.,  29.],
       [ 22.,  15.,   4.,  16.,  11.,   8.,  11.,   8.],
       [  4.,   3.,   0.,  13.,   7.,   7.,   6.,  14.],
       [ 44.,  29.,  10.,  33.,  19.,  25.,   7.,  10.],
       [ 27.,  22.,   0.,  15.,   7.,   6.,  10.,   9.],
...
       [ 23.,  91.,  33.,  87.,  76.,  85.,  37.,  27.],
       [  0.,  53.,  13.,  61.,  43.,  42.,  31.,  16.],
       [  0.,  46.,  31.,  79.,  67.,  73.,  63.,  10.],
       [  0.,  45.,  56.,  49.,  43.,  57.,  30.,  12.],
       [ 25.,  36.,  53.,  42.,  44.,  37.,  43.,  18.],
       [  4.,  30.,  30.,  21.,  13.,  15.,  11.,  28.],
       [ 54.,  38.,  48.,  41.,  31.,  38.,  29.,  38.],
       [ 63.,  20.,  32.,  32.,  17.,  21.,  21.,  11.],
       [ 31.,   7.,  12.,  11.,   8.,   8.,  16.,  69.],
       [ 41.,  18.,  30.,  29.,  14.,  17.,  35.,  35.],
       [ 20.,  49.,  49.,  47.,  29.,  35.,  46.,  44.],
       [ 32.,  46.,  63.,  42.,  12.,  15.,  35.,  20.],
       [ 69.,  72.,  82.,  69.,  66.,  62.,  73.,   7.],
       [ 84., 129., 144., 122., 118., 130., 112.,  31.],
       [ 31.,  80.,  92.,  60.,  52.,  50.,  46.,  31.],
       [ 36.,  98., 123.,  84.,  81.,  72.,  73.,  39.],
       [ 47., 140., 163., 147., 173., 155.,  98.,   8.],
       [ 58.,  52.,  45.,  53.,  74.,  54.,  67.,  46.],
       [ 32.,  43.,  15.,  51.,  44.,  31.,  62.,  55.],
       [ 67.,  72.,  54.,  77.,  69.,  72., 126.,  58.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>16.75 19.73 20.03 ... 21.97 28.22</div><input id='attrs-2c8d7c6e-9dac-41da-8821-bb55be3643f5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2c8d7c6e-9dac-41da-8821-bb55be3643f5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-01091e9e-57cd-46cb-a624-aaf5e9d20bbc' class='xr-var-data-in' type='checkbox'><label for='data-01091e9e-57cd-46cb-a624-aaf5e9d20bbc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([16.75 , 19.733, 20.033, 20.9  , 21.307, 21.433, 21.967, 28.217],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>190.5 204.9 204.2 ... 200.6 182.6</div><input id='attrs-31b2b45f-0904-4344-9852-d5013ffa0e12' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-31b2b45f-0904-4344-9852-d5013ffa0e12' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-43173e5a-6ac5-4ab6-a3a6-08b11dd5c7b2' class='xr-var-data-in' type='checkbox'><label for='data-43173e5a-6ac5-4ab6-a3a6-08b11dd5c7b2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([190.483, 204.933, 204.167, 203.533, 202.133, 202.2  , 200.65 ,
       182.633], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_name</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U17</div><div class='xr-var-preview xr-preview'>&#x27;Johnston&#x27; ... &#x27;Midway&#x27;</div><input id='attrs-7ef00ff1-e4e0-4616-bd04-d4e94f45eeef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7ef00ff1-e4e0-4616-bd04-d4e94f45eeef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3a4255fb-9554-4517-85d8-67035c4cd92c' class='xr-var-data-in' type='checkbox'><label for='data-3a4255fb-9554-4517-85d8-67035c4cd92c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Station Name</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;Johnston&#x27;, &#x27;Hilo, Hawaii&#x27;, &#x27;Kawaihae&#x27;, &#x27;Kahului&#x27;,
       &#x27;Honolulu, Hawaii&#x27;, &#x27;Mokuoloe&#x27;, &#x27;Nawiliwili&#x27;, &#x27;Midway&#x27;],
      dtype=&#x27;&lt;U17&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U30</div><div class='xr-var-preview xr-preview'>&#x27;United States of America (the)&#x27;...</div><input id='attrs-e51e59e8-76f6-4c18-8542-affb3189b916' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e51e59e8-76f6-4c18-8542-affb3189b916' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ed69557a-3f0a-4484-b924-60a9349823a2' class='xr-var-data-in' type='checkbox'><label for='data-ed69557a-3f0a-4484-b924-60a9349823a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Station Country</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;],
      dtype=&#x27;&lt;U30&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-556369e7-e359-43bc-aaac-7d41894c05fe' class='xr-section-summary-in' type='checkbox'  ><label for='section-556369e7-e359-43bc-aaac-7d41894c05fe' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-fe378ce8-1232-40c5-8d04-747a84977468' class='xr-index-data-in' type='checkbox'/><label for='index-fe378ce8-1232-40c5-8d04-747a84977468' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994,
       1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006,
       2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,
       2019, 2020, 2021, 2022, 2023],
      dtype=&#x27;int32&#x27;, name=&#x27;year&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>record_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-950c7ae7-6e7c-4446-b1a6-cfffc76990cd' class='xr-index-data-in' type='checkbox'/><label for='index-950c7ae7-6e7c-4446-b1a6-cfffc76990cd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([520, 600, 5520, 590, 570, 610, 580, 500], dtype=&#x27;int16&#x27;, name=&#x27;record_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f7db6a8b-283c-400d-a640-3c2214a45a19' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f7db6a8b-283c-400d-a640-3c2214a45a19' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#find minimum value in flood_days_per_year</span>
<span class="n">min_flood_days</span> <span class="o">=</span> <span class="n">flood_days_per_year</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">max_flood_days</span> <span class="o">=</span> <span class="n">flood_days_per_year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="plot-flood-frequency-counts">
<h3>Plot Flood Frequency Counts<a class="headerlink" href="#plot-flood-frequency-counts" title="Permalink to this heading">#</a></h3>
<p>The flood frequency counts are defined as the number of time periods that exceed a given threshold within a year. This plot follows <span id="id2">Sweet <em>et al.</em> [<a class="reference internal" href="#id5" title="William Sweet, Joseph Park, John Marra, Chris Zervas, and Stephen Gill. Sea level rise and nuisance flood frequency changes around the United States. Technical Report, NOAA, 2014. URL: https://repository.library.noaa.gov/view/noaa/30823.">SPM+14</a>]</span>.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adjusting the heatmap palette to improve readability</span>
<span class="n">adjusted_heatmap_palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;YlOrRd&quot;</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">flood_days_per_year</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">flood_days_per_year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">adjusted_heatmap_palette</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">flood_days_per_year</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="c1"># do a pcolormesh plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;flood_days_per_year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">adjusted_heatmap_palette</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

<span class="c1"># add a colorbar</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>  <span class="c1"># adjust the position and size of the colorbar</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">adjusted_heatmap_palette</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">label</span><span class="o">=</span> <span class="s1">&#39;Number of Flood Days&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Number of Flood Days Per Year&#39;</span><span class="p">)</span>             

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;threshold_counts_days_fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># save the figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="s1">&#39;SL_FloodFrequency_threshold_counts_days.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../_images/d4d9009f81887fbb93bf22c8fa0e3cd3567be58f76b5e9313d693212f257ad45.png" src="../_images/d4d9009f81887fbb93bf22c8fa0e3cd3567be58f76b5e9313d693212f257ad45.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-threshold-counts">
<img alt="../_images/d4d9009f81887fbb93bf22c8fa0e3cd3567be58f76b5e9313d693212f257ad45.png" src="../_images/d4d9009f81887fbb93bf22c8fa0e3cd3567be58f76b5e9313d693212f257ad45.png" />
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">Flood frequency counts above <span class="pasted-text">99.000</span>th percentile threshold per year at <span class="pasted-text">Hawaiian Islands</span> tide gauges from <span class="pasted-text">1983-01-01</span> to <span class="pasted-text">2023-12-31</span>.</span><a class="headerlink" href="#fig-threshold-counts" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="plot-flood-duration">
<h3>Plot Flood Duration<a class="headerlink" href="#plot-flood-duration" title="Permalink to this heading">#</a></h3>
<p>This next plot examines the average duration of flooding events as defined by the threshold.
I have a few issues with this plot being “duration,” as it’s just counts of hours above the threshold. These hours need not be continuous…which to me is what duration is all about. Anyway, we carry on.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>There are some dissimilarities here that give me pause. Going to look into it.</p>
</aside>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adjusting the heatmap palette to improve readability</span>
<span class="n">adjusted_heatmap_palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;YlOrRd&quot;</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">flood_hours_per_year</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">flood_hours_per_year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">adjusted_heatmap_palette</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">flood_hours_per_year</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="c1"># do a pcolormesh plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;flood_hours_per_year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">adjusted_heatmap_palette</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

<span class="c1"># add a colorbar</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>  <span class="c1"># adjust the position and size of the colorbar</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">adjusted_heatmap_palette</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">label</span><span class="o">=</span> <span class="s1">&#39;Number of Flood Hours&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Number of Flood Hours Per Year&#39;</span><span class="p">)</span>             
<span class="c1"># ax.set_yticklabels(SL_daily_max[&#39;station_name&#39;].values[0])</span>

<span class="c1"># save the figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="s1">&#39;SL_FloodFrequency_threshold_counts_hours.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>



<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;duration_fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../_images/240f88f9b04efe9686c3a0fd3aa59d45f2f0490ec1c8cc41659c348183b1155e.png" src="../_images/240f88f9b04efe9686c3a0fd3aa59d45f2f0490ec1c8cc41659c348183b1155e.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-duration">
<img alt="../_images/240f88f9b04efe9686c3a0fd3aa59d45f2f0490ec1c8cc41659c348183b1155e.png" src="../_images/240f88f9b04efe9686c3a0fd3aa59d45f2f0490ec1c8cc41659c348183b1155e.png" />
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Average flood duration in hours above a threshold of <span class="pasted-text">30.000</span> cm per year at , tide gauge from <span class="pasted-text">1983-01-01</span> to <span class="pasted-text">2023-12-31</span>.</span><a class="headerlink" href="#fig-duration" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="calculate-the-percent-change-over-time">
<h2>Calculate the percent change over time<a class="headerlink" href="#calculate-the-percent-change-over-time" title="Permalink to this heading">#</a></h2>
<p>Next we’ll calculate the percent change over the POR at the tide station/s, for both Frequency and Duration.</p>
<p>The next code cell fits a trend line to the flood days per year data and calculates the trend line.
It then plots the data and the trend line in a figure, and calculates the percent change in flood days per year using the trend line. The same process is repeated for flood hours per year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_flood_trend</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">timescale</span> <span class="o">=</span> <span class="s1">&#39;days&#39;</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">timescale</span> <span class="o">==</span> <span class="s1">&#39;days&#39;</span><span class="p">:</span>
        <span class="n">dsvar</span> <span class="o">=</span> <span class="s1">&#39;flood_days_per_year&#39;</span>
    <span class="k">elif</span> <span class="n">timescale</span> <span class="o">==</span> <span class="s1">&#39;hours&#39;</span><span class="p">:</span>
        <span class="n">dsvar</span> <span class="o">=</span> <span class="s1">&#39;flood_hours_per_year&#39;</span>

    <span class="n">slopes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">intercepts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">percent_changes</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1">#trends is an empty array the length of ds[&#39;year&#39;] and the number of records</span>
    <span class="n">trends</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">])))</span>

    <span class="k">for</span> <span class="n">record_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">])):</span>
        <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="n">dsvar</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">record_id</span><span class="o">=</span><span class="n">record_id</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">trend</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">trend</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">percent_change</span> <span class="o">=</span> <span class="n">trend</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">*</span><span class="mi">100</span> <span class="c1">#this needs help, how to define percent change when the first value is less than 0?</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">percent_change</span> <span class="o">=</span> <span class="p">(</span><span class="n">trend</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">trend</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">trend</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="n">slopes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>
        <span class="n">intercepts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">intercept</span><span class="p">)</span>
        <span class="n">percent_changes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">percent_change</span><span class="p">)</span>
        <span class="n">trends</span><span class="p">[:,</span> <span class="n">record_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">trend</span>

    <span class="k">return</span> <span class="n">slopes</span><span class="p">,</span> <span class="n">intercepts</span><span class="p">,</span> <span class="n">percent_changes</span><span class="p">,</span> <span class="n">trends</span>

<span class="n">slopes</span><span class="p">,</span> <span class="n">intercepts</span><span class="p">,</span> <span class="n">percent_changes</span><span class="p">,</span> <span class="n">trends</span> <span class="o">=</span> <span class="n">calculate_flood_trend</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s1">&#39;days&#39;</span><span class="p">)</span>

<span class="c1">#add to dataset</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;slope_days&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">slopes</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;intercept_days&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">intercepts</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;percent_change_days&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">percent_changes</span><span class="p">))</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;trend_days&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">trends</span><span class="p">)</span>

<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;slope_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Slope of the trend line&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;days/year&#39;</span><span class="p">}</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;intercept_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Intercept of the trend line&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;days&#39;</span><span class="p">}</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;percent_change_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent change in flood days per year&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;%&#39;</span><span class="p">}</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;trend_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Trend line of flood days per year&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;days&#39;</span><span class="p">}</span>


<span class="n">slopes</span><span class="p">,</span> <span class="n">intercepts</span><span class="p">,</span> <span class="n">percent_changes</span><span class="p">,</span> <span class="n">trends</span> <span class="o">=</span> <span class="n">calculate_flood_trend</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s1">&#39;hours&#39;</span><span class="p">)</span>

<span class="c1">#add to dataset</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;slope_hours&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">slopes</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;intercept_hours&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">intercepts</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;percent_change_hours&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">percent_changes</span><span class="p">))</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;trend_hours&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;record_id&#39;</span><span class="p">),</span> <span class="n">trends</span><span class="p">)</span>

<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;slope_hours&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Slope of the trend line&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;hours/year&#39;</span><span class="p">}</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;intercept_hours&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Intercept of the trend line&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;hours&#39;</span><span class="p">}</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;percent_change_hours&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent change in flood hours per year&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;%&#39;</span><span class="p">}</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;trend_hours&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Trend line of flood hours per year&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;hours&#39;</span><span class="p">}</span>

<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 13kB
Dimensions:               (year: 41, record_id: 8)
Coordinates:
  * year                  (year) int32 164B 1983 1984 1985 ... 2021 2022 2023
  * record_id             (record_id) int16 16B 520 600 5520 590 570 610 580 500
Data variables: (12/14)
    flood_hours_per_year  (year, record_id) float64 3kB 71.0 56.0 ... 221.0
    flood_days_per_year   (year, record_id) float64 3kB 37.0 30.0 ... 126.0 58.0
    lat                   (record_id) float32 32B 16.75 19.73 ... 21.97 28.22
    lon                   (record_id) float32 32B 190.5 204.9 ... 200.6 182.6
    station_name          (record_id) &lt;U17 544B &#x27;Johnston&#x27; ... &#x27;Midway&#x27;
    station_country       (record_id) &lt;U30 960B &#x27;United States of America (th...
    ...                    ...
    percent_change_days   (record_id) float64 64B 151.8 567.1 ... 2.452e+03
    trend_days            (year, record_id) float64 3kB 17.85 10.68 ... 38.68
    slope_hours           (record_id) float64 64B 2.194 3.795 ... 3.883 3.555
    intercept_hours       (record_id) float64 64B -4.318e+03 ... -7.035e+03
    percent_change_hours  (record_id) float64 64B 278.6 1.368e+03 ... 953.2
    trend_hours           (year, record_id) float64 3kB 31.49 11.09 ... 157.1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d41c5414-21e8-43ef-9964-836514b2d6dc' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d41c5414-21e8-43ef-9964-836514b2d6dc' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 41</li><li><span class='xr-has-index'>record_id</span>: 8</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-779d88a0-996d-4f75-abe7-4aa357c81342' class='xr-section-summary-in' type='checkbox'  checked><label for='section-779d88a0-996d-4f75-abe7-4aa357c81342' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1983 1984 1985 ... 2021 2022 2023</div><input id='attrs-58e497ee-8bbf-43fb-8f57-79be6933a817' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-58e497ee-8bbf-43fb-8f57-79be6933a817' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-39b6d6cd-2975-485e-b51c-df3e34f3e9b2' class='xr-var-data-in' type='checkbox'><label for='data-39b6d6cd-2975-485e-b51c-df3e34f3e9b2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Year</dd><dt><span>units :</span></dt><dd>calendar year</dd></dl></div><div class='xr-var-data'><pre>array([1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994,
       1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006,
       2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,
       2019, 2020, 2021, 2022, 2023], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>record_id</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>int16</div><div class='xr-var-preview xr-preview'>520 600 5520 590 570 610 580 500</div><input id='attrs-f36826c2-a5d0-401b-8aef-0677caba6e7c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f36826c2-a5d0-401b-8aef-0677caba6e7c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2a89aa2a-4dcf-4f9d-9288-c08751da2235' class='xr-var-data-in' type='checkbox'><label for='data-2a89aa2a-4dcf-4f9d-9288-c08751da2235' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>unique identifier for each record (i.e., station and version) in the database</dd></dl></div><div class='xr-var-data'><pre>array([ 520,  600, 5520,  590,  570,  610,  580,  500], dtype=int16)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-abedc844-230e-4b29-995a-2102cf9f1984' class='xr-section-summary-in' type='checkbox'  checked><label for='section-abedc844-230e-4b29-995a-2102cf9f1984' class='xr-section-summary' >Data variables: <span>(14)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>flood_hours_per_year</span></div><div class='xr-var-dims'>(year, record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>71.0 56.0 0.0 ... 169.0 374.0 221.0</div><input id='attrs-adcf0127-4681-4254-acc8-b6313ceb6bb6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-adcf0127-4681-4254-acc8-b6313ceb6bb6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-23d4327c-5d7f-4f7a-9e78-f8c7142e9fc7' class='xr-var-data-in' type='checkbox'><label for='data-23d4327c-5d7f-4f7a-9e78-f8c7142e9fc7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Number of flood hours per year</dd><dt><span>units :</span></dt><dd>hours</dd></dl></div><div class='xr-var-data'><pre>array([[ 71.,  56.,   0.,  35.,  28.,  26.,  32.,  19.],
       [ 75.,  73.,   0.,  70., 115., 102.,  97.,  77.],
       [ 25.,  19.,   0.,  39.,  53.,  54., 128.,  17.],
       [ 40.,  21.,   0.,   7.,   8.,   6.,  11.,  83.],
       [ 25.,  69.,   0.,  57.,  38.,  27.,  17.,  48.],
       [109.,  67.,   0., 145., 117., 113., 114.,  26.],
       [ 44.,  25.,   4.,  16.,  33.,  36.,  35.,  47.],
       [ 20.,  12.,   1.,  10.,   4.,  15.,  41.,  12.],
       [ 16.,  50.,   5.,  31.,  46.,  18.,  49.,   4.],
       [ 62.,  78.,   0.,  74.,  63.,  78.,  52.,  46.],
       [ 35.,  75.,   6.,  52.,  17.,  34.,  45.,  19.],
       [ 78.,   4.,   0.,  19.,  24.,  14.,  24.,  15.],
       [ 76.,  22.,   2.,  72., 105.,  82.,  57.,  46.],
       [124.,  81.,   5.,  82.,  68.,  71.,  68.,  44.],
       [ 46.,  53.,   2.,  24.,  16.,  16.,  20.,   7.],
       [ 60.,  15.,   0.,   6.,   1.,   6.,   0., 156.],
       [ 48.,  27.,   5.,  25.,  22.,  15.,  20.,  31.],
       [  4.,   5.,   0.,  21.,  14.,  13.,   9.,  53.],
       [ 98.,  63.,  17.,  65.,  29.,  45.,  11.,  46.],
       [ 48.,  36.,   0.,  25.,  13.,  11.,  18.,  21.],
...
       [ 53., 196.,  68., 163., 180., 206.,  74., 218.],
       [  0., 109.,  23., 110.,  83.,  83.,  74., 108.],
       [  0.,  88.,  70., 158., 145., 156., 164.,  30.],
       [  0.,  84., 127.,  96.,  88., 114.,  66.,  53.],
       [ 52.,  75., 125.,  95., 106.,  84.,  94.,  68.],
       [  6.,  57.,  58.,  38.,  25.,  27.,  24.,  81.],
       [137.,  73.,  94.,  70.,  64.,  72.,  61., 140.],
       [188.,  35.,  57.,  53.,  24.,  30.,  38.,  91.],
       [ 75.,  13.,  22.,  17.,  15.,  16.,  22., 289.],
       [ 84.,  32.,  60.,  46.,  23.,  29.,  70., 122.],
       [ 49.,  99., 102.,  86.,  55.,  67.,  92., 155.],
       [ 91.,  76., 125.,  66.,  14.,  22.,  93.,  92.],
       [196., 171., 198., 133., 145., 150., 166.,  33.],
       [240., 289., 359., 288., 308., 301., 269., 133.],
       [ 67., 178., 209., 118., 124., 121., 109., 120.],
       [ 95., 255., 331., 190., 212., 206., 181., 146.],
       [105., 365., 510., 386., 496., 440., 271.,  24.],
       [136., 126., 123., 110., 169., 128., 163., 157.],
       [ 81.,  81.,  26.,  93.,  82.,  67., 130., 249.],
       [187., 164., 106., 173., 151., 169., 374., 221.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>flood_days_per_year</span></div><div class='xr-var-dims'>(year, record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>37.0 30.0 0.0 ... 72.0 126.0 58.0</div><input id='attrs-21253f91-ff55-4f42-85cc-232ac9255b70' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-21253f91-ff55-4f42-85cc-232ac9255b70' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cbb30680-4c9e-4438-965f-79a2b3987024' class='xr-var-data-in' type='checkbox'><label for='data-cbb30680-4c9e-4438-965f-79a2b3987024' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Number of flood days per year</dd><dt><span>units :</span></dt><dd>days</dd></dl></div><div class='xr-var-data'><pre>array([[ 37.,  30.,   0.,  19.,  13.,  16.,  19.,   9.],
       [ 36.,  40.,   0.,  41.,  61.,  51.,  43.,  13.],
       [ 14.,  14.,   0.,  27.,  25.,  24.,  48.,   5.],
       [ 15.,  11.,   0.,   4.,   5.,   3.,   6.,  16.],
       [ 12.,  33.,   0.,  27.,  17.,  13.,   6.,  12.],
       [ 53.,  32.,   0.,  77.,  61.,  59.,  51.,   7.],
       [ 22.,  17.,   3.,   9.,  19.,  20.,  21.,   6.],
       [ 12.,   6.,   1.,   7.,   3.,  10.,  21.,   4.],
       [ 11.,  23.,   3.,  21.,  23.,   8.,  24.,   2.],
       [ 33.,  38.,   0.,  42.,  30.,  37.,  29.,   8.],
       [ 19.,  39.,   3.,  28.,   8.,  17.,  25.,  11.],
       [ 24.,   4.,   0.,  16.,  15.,   9.,  13.,   2.],
       [ 31.,  14.,   2.,  35.,  42.,  35.,  25.,  13.],
       [ 49.,  43.,   3.,  47.,  34.,  34.,  36.,   8.],
       [ 21.,  29.,   1.,  16.,  11.,  14.,  12.,   4.],
       [ 30.,   9.,   0.,   5.,   1.,   4.,   0.,  29.],
       [ 22.,  15.,   4.,  16.,  11.,   8.,  11.,   8.],
       [  4.,   3.,   0.,  13.,   7.,   7.,   6.,  14.],
       [ 44.,  29.,  10.,  33.,  19.,  25.,   7.,  10.],
       [ 27.,  22.,   0.,  15.,   7.,   6.,  10.,   9.],
...
       [ 23.,  91.,  33.,  87.,  76.,  85.,  37.,  27.],
       [  0.,  53.,  13.,  61.,  43.,  42.,  31.,  16.],
       [  0.,  46.,  31.,  79.,  67.,  73.,  63.,  10.],
       [  0.,  45.,  56.,  49.,  43.,  57.,  30.,  12.],
       [ 25.,  36.,  53.,  42.,  44.,  37.,  43.,  18.],
       [  4.,  30.,  30.,  21.,  13.,  15.,  11.,  28.],
       [ 54.,  38.,  48.,  41.,  31.,  38.,  29.,  38.],
       [ 63.,  20.,  32.,  32.,  17.,  21.,  21.,  11.],
       [ 31.,   7.,  12.,  11.,   8.,   8.,  16.,  69.],
       [ 41.,  18.,  30.,  29.,  14.,  17.,  35.,  35.],
       [ 20.,  49.,  49.,  47.,  29.,  35.,  46.,  44.],
       [ 32.,  46.,  63.,  42.,  12.,  15.,  35.,  20.],
       [ 69.,  72.,  82.,  69.,  66.,  62.,  73.,   7.],
       [ 84., 129., 144., 122., 118., 130., 112.,  31.],
       [ 31.,  80.,  92.,  60.,  52.,  50.,  46.,  31.],
       [ 36.,  98., 123.,  84.,  81.,  72.,  73.,  39.],
       [ 47., 140., 163., 147., 173., 155.,  98.,   8.],
       [ 58.,  52.,  45.,  53.,  74.,  54.,  67.,  46.],
       [ 32.,  43.,  15.,  51.,  44.,  31.,  62.,  55.],
       [ 67.,  72.,  54.,  77.,  69.,  72., 126.,  58.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>16.75 19.73 20.03 ... 21.97 28.22</div><input id='attrs-39223dac-0613-4cb3-9bdd-87bed894dd07' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-39223dac-0613-4cb3-9bdd-87bed894dd07' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e5385314-7c64-407e-86cd-5aa5522d1c12' class='xr-var-data-in' type='checkbox'><label for='data-e5385314-7c64-407e-86cd-5aa5522d1c12' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([16.75 , 19.733, 20.033, 20.9  , 21.307, 21.433, 21.967, 28.217],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>190.5 204.9 204.2 ... 200.6 182.6</div><input id='attrs-b2019148-9248-43b4-abf6-e85cc3e4c711' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b2019148-9248-43b4-abf6-e85cc3e4c711' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-33d0c155-50d4-4ae9-8dfd-a45bb821045e' class='xr-var-data-in' type='checkbox'><label for='data-33d0c155-50d4-4ae9-8dfd-a45bb821045e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([190.483, 204.933, 204.167, 203.533, 202.133, 202.2  , 200.65 ,
       182.633], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_name</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U17</div><div class='xr-var-preview xr-preview'>&#x27;Johnston&#x27; ... &#x27;Midway&#x27;</div><input id='attrs-1968af64-1ac1-4ba0-af74-d45fa1e4b2f8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1968af64-1ac1-4ba0-af74-d45fa1e4b2f8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c62f1b3d-d59e-44a8-bc61-2f6ac4ae429f' class='xr-var-data-in' type='checkbox'><label for='data-c62f1b3d-d59e-44a8-bc61-2f6ac4ae429f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Station Name</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;Johnston&#x27;, &#x27;Hilo, Hawaii&#x27;, &#x27;Kawaihae&#x27;, &#x27;Kahului&#x27;,
       &#x27;Honolulu, Hawaii&#x27;, &#x27;Mokuoloe&#x27;, &#x27;Nawiliwili&#x27;, &#x27;Midway&#x27;],
      dtype=&#x27;&lt;U17&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station_country</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>&lt;U30</div><div class='xr-var-preview xr-preview'>&#x27;United States of America (the)&#x27;...</div><input id='attrs-c07e9bbf-0037-4f09-8bb4-75d13f110bee' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c07e9bbf-0037-4f09-8bb4-75d13f110bee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f82007c-1a45-448a-8ee6-3297db754b05' class='xr-var-data-in' type='checkbox'><label for='data-1f82007c-1a45-448a-8ee6-3297db754b05' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Station Country</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;,
       &#x27;United States of America (the)&#x27;, &#x27;United States of America (the)&#x27;],
      dtype=&#x27;&lt;U30&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>slope_days</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6772 1.515 2.49 ... 1.437 0.9291</div><input id='attrs-0e4a06d4-29e1-4a75-a4fa-2f16a2684aac' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e4a06d4-29e1-4a75-a4fa-2f16a2684aac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49f38bb5-f50f-4563-ada7-ca6a03959bc0' class='xr-var-data-in' type='checkbox'><label for='data-49f38bb5-f50f-4563-ada7-ca6a03959bc0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Slope of the trend line</dd><dt><span>units :</span></dt><dd>days/year</dd></dl></div><div class='xr-var-data'><pre>array([0.6771777 , 1.51463415, 2.48989547, 1.4238676 , 1.37874564,
       1.31289199, 1.43728223, 0.92909408])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>intercept_days</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.325e+03 ... -1.841e+03</div><input id='attrs-38ef739d-c81e-4f9f-9387-ec9c4a650957' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-38ef739d-c81e-4f9f-9387-ec9c4a650957' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d30c3c28-2f35-469f-95a8-a7a1fb122313' class='xr-var-data-in' type='checkbox'><label for='data-d30c3c28-2f35-469f-95a8-a7a1fb122313' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Intercept of the trend line</dd><dt><span>units :</span></dt><dd>days</dd></dl></div><div class='xr-var-data'><pre>array([-1324.9966899 , -2992.83658537, -4957.79721254, -2808.20191638,
       -2723.09094077, -2591.52752613, -2841.48606272, -1840.87787456])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>percent_change_days</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>151.8 567.1 ... 665.1 2.452e+03</div><input id='attrs-1b909686-247d-4f32-a2c7-d86c350035b9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1b909686-247d-4f32-a2c7-d86c350035b9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc3c1f20-153f-497e-a37d-3fce47744490' class='xr-var-data-in' type='checkbox'><label for='data-cc3c1f20-153f-497e-a37d-3fce47744490' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Percent change in flood days per year</dd><dt><span>units :</span></dt><dd>%</dd></dl></div><div class='xr-var-data'><pre>array([ 151.77664975,  567.12328767, 7926.13240418,  371.58445101,
        503.11506675,  439.92994746,  665.05441354, 2451.95402299])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>trend_days</span></div><div class='xr-var-dims'>(year, record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>17.85 10.68 -20.33 ... 66.14 38.68</div><input id='attrs-6b46be52-f301-45c4-86dc-83c6bece8872' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6b46be52-f301-45c4-86dc-83c6bece8872' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3724214-0330-48b3-84c7-bb06017320be' class='xr-var-data-in' type='checkbox'><label for='data-a3724214-0330-48b3-84c7-bb06017320be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Trend line of flood days per year</dd><dt><span>units :</span></dt><dd>days</dd></dl></div><div class='xr-var-data'><pre>array([[ 17.8466899 ,  10.68292683, -20.33449477,  15.32752613,
         10.96167247,  11.93728223,   8.6445993 ,   1.51567944],
       [ 18.5238676 ,  12.19756098, -17.8445993 ,  16.75139373,
         12.34041812,  13.25017422,  10.08188153,   2.44477352],
       [ 19.2010453 ,  13.71219512, -15.35470383,  18.17526132,
         13.71916376,  14.5630662 ,  11.51916376,   3.3738676 ],
       [ 19.878223  ,  15.22682927, -12.86480836,  19.59912892,
         15.09790941,  15.87595819,  12.95644599,   4.30296167],
       [ 20.5554007 ,  16.74146341, -10.37491289,  21.02299652,
         16.47665505,  17.18885017,  14.39372822,   5.23205575],
       [ 21.2325784 ,  18.25609756,  -7.88501742,  22.44686411,
         17.8554007 ,  18.50174216,  15.83101045,   6.16114983],
       [ 21.9097561 ,  19.77073171,  -5.39512195,  23.87073171,
         19.23414634,  19.81463415,  17.26829268,   7.0902439 ],
       [ 22.5869338 ,  21.28536585,  -2.90522648,  25.2945993 ,
         20.61289199,  21.12752613,  18.70557491,   8.01933798],
       [ 23.2641115 ,  22.8       ,  -0.41533101,  26.7184669 ,
         21.99163763,  22.44041812,  20.14285714,   8.94843206],
       [ 23.9412892 ,  24.31463415,   2.07456446,  28.14233449,
         23.37038328,  23.7533101 ,  21.58013937,   9.87752613],
...
       [ 38.83919861,  57.63658537,  56.85226481,  59.4674216 ,
         53.70278746,  52.6369338 ,  53.20034843,  30.31759582],
       [ 39.51637631,  59.15121951,  59.34216028,  60.8912892 ,
         55.0815331 ,  53.94982578,  54.63763066,  31.2466899 ],
       [ 40.19355401,  60.66585366,  61.83205575,  62.31515679,
         56.46027875,  55.26271777,  56.07491289,  32.17578397],
       [ 40.87073171,  62.1804878 ,  64.32195122,  63.73902439,
         57.83902439,  56.57560976,  57.51219512,  33.10487805],
       [ 41.54790941,  63.69512195,  66.81184669,  65.16289199,
         59.21777003,  57.88850174,  58.94947735,  34.03397213],
       [ 42.22508711,  65.2097561 ,  69.30174216,  66.58675958,
         60.59651568,  59.20139373,  60.38675958,  34.9630662 ],
       [ 42.90226481,  66.72439024,  71.79163763,  68.01062718,
         61.97526132,  60.51428571,  61.82404181,  35.89216028],
       [ 43.57944251,  68.23902439,  74.2815331 ,  69.43449477,
         63.35400697,  61.8271777 ,  63.26132404,  36.82125436],
       [ 44.25662021,  69.75365854,  76.77142857,  70.85836237,
         64.73275261,  63.14006969,  64.69860627,  37.75034843],
       [ 44.93379791,  71.26829268,  79.26132404,  72.28222997,
         66.11149826,  64.45296167,  66.1358885 ,  38.67944251]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>slope_hours</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.194 3.795 6.195 ... 3.883 3.555</div><input id='attrs-c50f81dd-318c-45a6-b486-0cd135e30a94' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c50f81dd-318c-45a6-b486-0cd135e30a94' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fafd4c4e-adcf-4d73-908a-b2b6c4c99c3a' class='xr-var-data-in' type='checkbox'><label for='data-fafd4c4e-adcf-4d73-908a-b2b6c4c99c3a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Slope of the trend line</dd><dt><span>units :</span></dt><dd>hours/year</dd></dl></div><div class='xr-var-data'><pre>array([2.19355401, 3.79529617, 6.19547038, 3.43867596, 3.68135889,
       3.55261324, 3.88344948, 3.55522648])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>intercept_hours</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-4.318e+03 ... -7.035e+03</div><input id='attrs-755153cb-c0b9-4700-ad07-34be07e819ae' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-755153cb-c0b9-4700-ad07-34be07e819ae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d428bc0-6f96-4936-ba4a-ed942ce8208e' class='xr-var-data-in' type='checkbox'><label for='data-3d428bc0-6f96-4936-ba4a-ed942ce8208e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Intercept of the trend line</dd><dt><span>units :</span></dt><dd>hours</dd></dl></div><div class='xr-var-data'><pre>array([ -4318.3228223 ,  -7514.978223  , -12339.89303136,  -6800.91184669,
        -7287.37160279,  -7030.27456446,  -7692.40296167,  -7035.09425087])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>percent_change_hours</span></div><div class='xr-var-dims'>(record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>278.6 1.368e+03 ... 1.832e+03 953.2</div><input id='attrs-e305ebaf-6021-4974-881d-9d8efdb93b8b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e305ebaf-6021-4974-881d-9d8efdb93b8b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4b94d2b9-c24c-464d-a6e3-6ebb5cdc249d' class='xr-var-data-in' type='checkbox'><label for='data-4b94d2b9-c24c-464d-a6e3-6ebb5cdc249d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Percent change in flood hours per year</dd><dt><span>units :</span></dt><dd>%</dd></dl></div><div class='xr-var-data'><pre>array([  278.59276469,  1368.40452261, 19354.3554007 ,   764.89052509,
        1153.75375375,   976.16084251,  1832.38799836,   953.15273237])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>trend_hours</span></div><div class='xr-var-dims'>(year, record_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>31.49 11.09 -54.28 ... 163.8 157.1</div><input id='attrs-37a5fb14-9ecc-4898-a785-c56b5d9faa11' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-37a5fb14-9ecc-4898-a785-c56b5d9faa11' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8105ce16-2def-4d2e-8efe-67280a8940ee' class='xr-var-data-in' type='checkbox'><label for='data-8105ce16-2def-4d2e-8efe-67280a8940ee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Trend line of flood hours per year</dd><dt><span>units :</span></dt><dd>hours</dd></dl></div><div class='xr-var-data'><pre>array([[ 31.49477352,  11.09407666, -54.27526132,  17.9825784 ,
         12.7630662 ,  14.55749129,   8.47735192,  14.91986063],
       [ 33.68832753,  14.88937282, -48.07979094,  21.42125436,
         16.44442509,  18.11010453,  12.36080139,  18.47508711],
       [ 35.88188153,  18.68466899, -41.88432056,  24.85993031,
         20.12578397,  21.66271777,  16.24425087,  22.03031359],
       [ 38.07543554,  22.47996516, -35.68885017,  28.29860627,
         23.80714286,  25.21533101,  20.12770035,  25.58554007],
       [ 40.26898955,  26.27526132, -29.49337979,  31.73728223,
         27.48850174,  28.76794425,  24.01114983,  29.14076655],
       [ 42.46254355,  30.07055749, -23.29790941,  35.17595819,
         31.16986063,  32.32055749,  27.8945993 ,  32.69599303],
       [ 44.65609756,  33.86585366, -17.10243902,  38.61463415,
         34.85121951,  35.87317073,  31.77804878,  36.25121951],
       [ 46.84965157,  37.66114983, -10.90696864,  42.0533101 ,
         38.5325784 ,  39.42578397,  35.66149826,  39.80644599],
       [ 49.04320557,  41.45644599,  -4.71149826,  45.49198606,
         42.21393728,  42.97839721,  39.54494774,  43.36167247],
       [ 51.23675958,  45.25174216,   1.48397213,  48.93066202,
         45.89529617,  46.53101045,  43.42839721,  46.91689895],
...
       [ 99.49494774, 128.74825784, 137.78432056, 124.5815331 ,
        126.88519164, 124.68850174, 128.86428571, 125.13188153],
       [101.68850174, 132.54355401, 143.97979094, 128.02020906,
        130.56655052, 128.24111498, 132.74773519, 128.68710801],
       [103.88205575, 136.33885017, 150.17526132, 131.45888502,
        134.24790941, 131.79372822, 136.63118467, 132.24233449],
       [106.07560976, 140.13414634, 156.37073171, 134.89756098,
        137.92926829, 135.34634146, 140.51463415, 135.79756098],
       [108.26916376, 143.92944251, 162.56620209, 138.33623693,
        141.61062718, 138.8989547 , 144.39808362, 139.35278746],
       [110.46271777, 147.72473868, 168.76167247, 141.77491289,
        145.29198606, 142.45156794, 148.2815331 , 142.90801394],
       [112.65627178, 151.52003484, 174.95714286, 145.21358885,
        148.97334495, 146.00418118, 152.16498258, 146.46324042],
       [114.84982578, 155.31533101, 181.15261324, 148.65226481,
        152.65470383, 149.55679443, 156.04843206, 150.0184669 ],
       [117.04337979, 159.11062718, 187.34808362, 152.09094077,
        156.33606272, 153.10940767, 159.93188153, 153.57369338],
       [119.2369338 , 162.90592334, 193.54355401, 155.52961672,
        160.0174216 , 156.66202091, 163.81533101, 157.12891986]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-66f96d62-c6d0-447a-b421-15b42930e0fe' class='xr-section-summary-in' type='checkbox'  ><label for='section-66f96d62-c6d0-447a-b421-15b42930e0fe' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-954278d2-141f-446b-8a37-904d058f834a' class='xr-index-data-in' type='checkbox'/><label for='index-954278d2-141f-446b-8a37-904d058f834a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994,
       1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006,
       2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,
       2019, 2020, 2021, 2022, 2023],
      dtype=&#x27;int32&#x27;, name=&#x27;year&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>record_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c92589c2-b631-42f4-9e84-80cdc5ab569e' class='xr-index-data-in' type='checkbox'/><label for='index-c92589c2-b631-42f4-9e84-80cdc5ab569e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([520, 600, 5520, 590, 570, 610, 580, 500], dtype=&#x27;int16&#x27;, name=&#x27;record_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-70fd38ea-25a5-49c4-a2bd-10b1b0b6ade0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-70fd38ea-25a5-49c4-a2bd-10b1b0b6ade0' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Set the color for each station</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Dark2&#39;</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]))</span>

<span class="c1"># Plot the data for each station with the same color</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">record_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]):</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;flood_days_per_year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">record_id</span><span class="o">=</span><span class="n">record_id</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;flood_hours_per_year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">record_id</span><span class="o">=</span><span class="n">record_id</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

    <span class="c1"># Plot the trend lines</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;trend_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">record_id</span><span class="o">=</span><span class="n">record_id</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;trend_hours&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">record_id</span><span class="o">=</span><span class="n">record_id</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">record_id</span><span class="o">=</span><span class="n">record_id</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c1"># Set the labels and tick labels</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flood Days&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flood Hours&#39;</span><span class="p">)</span>

<span class="c1"># add a legend </span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">columnspacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.25</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

<span class="c1">#color the legend text the same as the lines and then remove the lines</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">record_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;record_id&#39;</span><span class="p">]):</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">get_texts</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">get_texts</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
    <span class="c1"># axs[1].get_legend().get_lines()[i].set_linewidth(0)</span>

<span class="c1">#remove box around legend</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/de5f2061f3a74ce36308361833a04f4b6af29f5fa74c47b7ab68391bef0f1049.png" src="../_images/de5f2061f3a74ce36308361833a04f4b6af29f5fa74c47b7ab68391bef0f1049.png" />
</div>
</div>
<p>Now we’ll generate a table with this information, which will be saved as a .csv in the output directory specified at the top of this notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a dataframe with the percent change in flood days and hours per year, with given threshold</span>
<span class="n">percent_change_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;percent_change_days&#39;</span><span class="p">:</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;percent_change_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;percent_change_hours&#39;</span><span class="p">:</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;percent_change_hours&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="n">thresholds</span><span class="p">})</span>

<span class="c1"># add the station name and country</span>
<span class="n">percent_change_df</span><span class="p">[</span><span class="s1">&#39;station&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">percent_change_df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;station_country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># reorder the columns</span>
<span class="n">percent_change_df</span> <span class="o">=</span> <span class="n">percent_change_df</span><span class="p">[[</span><span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;percent_change_days&#39;</span><span class="p">,</span> <span class="s1">&#39;percent_change_hours&#39;</span><span class="p">]]</span>

<span class="c1"># Define your attributes</span>
<span class="n">attributes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;station&#39;</span><span class="p">:</span> <span class="s1">&#39;Station name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="s1">&#39;Country name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="s1">&#39;Threshold in cm above MHHW&#39;</span><span class="p">,</span>
    <span class="s1">&#39;percent_change_days&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent change in flood days per year&#39;</span><span class="p">,</span>
    <span class="s1">&#39;percent_change_hours&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent change in flood hours per year&#39;</span>
<span class="p">}</span>

<span class="c1"># Open the file in write mode</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="s1">&#39;SL_FloodFrequency_percent_change.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="c1"># Write the attributes as comments</span>
    <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;# </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Write the DataFrame to the file</span>
    <span class="n">percent_change_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">percent_change_df</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>station</th>
      <th>country</th>
      <th>threshold</th>
      <th>percent_change_days</th>
      <th>percent_change_hours</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Johnston</td>
      <td>United States of America (the)</td>
      <td>18.3</td>
      <td>151.776650</td>
      <td>278.592765</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Hilo, Hawaii</td>
      <td>United States of America (the)</td>
      <td>20.6</td>
      <td>567.123288</td>
      <td>1368.404523</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Kawaihae</td>
      <td>United States of America (the)</td>
      <td>27.7</td>
      <td>7926.132404</td>
      <td>19354.355401</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kahului</td>
      <td>United States of America (the)</td>
      <td>23.7</td>
      <td>371.584451</td>
      <td>764.890525</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Honolulu, Hawaii</td>
      <td>United States of America (the)</td>
      <td>19.5</td>
      <td>503.115067</td>
      <td>1153.753754</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Mokuoloe</td>
      <td>United States of America (the)</td>
      <td>18.3</td>
      <td>439.929947</td>
      <td>976.160843</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Nawiliwili</td>
      <td>United States of America (the)</td>
      <td>19.5</td>
      <td>665.054414</td>
      <td>1832.387998</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Midway</td>
      <td>United States of America (the)</td>
      <td>20.8</td>
      <td>2451.954023</td>
      <td>953.152732</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="create-a-map">
<h2>Create a map<a class="headerlink" href="#create-a-map" title="Permalink to this heading">#</a></h2>
<p>In this next section we’ll create a map with an icon depicting the percent change over the Period of Record at the tide station/s, for both Frequency and Duration.</p>
<p>The following cell defines a function that creates a “zebra stripe” pattern for the map borders.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_zebra_frame</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">segment_length</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()):</span>
    <span class="c1"># Get the current extent of the map</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bot</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_extent</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>

    <span class="c1"># Calculate the nearest 0 or 0.5 degree mark within the current extent</span>
    <span class="n">left_start</span> <span class="o">=</span> <span class="n">left</span> <span class="o">-</span> <span class="n">left</span> <span class="o">%</span> <span class="n">segment_length</span>
    <span class="n">bot_start</span> <span class="o">=</span> <span class="n">bot</span> <span class="o">-</span> <span class="n">bot</span> <span class="o">%</span> <span class="n">segment_length</span>

    <span class="c1"># Adjust the start if it does not align with the desired segment start</span>
    <span class="k">if</span> <span class="n">left</span> <span class="o">%</span> <span class="n">segment_length</span> <span class="o">&gt;=</span> <span class="n">segment_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">left_start</span> <span class="o">+=</span> <span class="n">segment_length</span>
    <span class="k">if</span> <span class="n">bot</span> <span class="o">%</span> <span class="n">segment_length</span> <span class="o">&gt;=</span> <span class="n">segment_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">bot_start</span> <span class="o">+=</span> <span class="n">segment_length</span>

    <span class="c1"># Extend the frame slightly beyond the map extent to ensure full coverage</span>
    <span class="n">right_end</span> <span class="o">=</span> <span class="n">right</span> <span class="o">+</span> <span class="p">(</span><span class="n">segment_length</span> <span class="o">-</span> <span class="n">right</span> <span class="o">%</span> <span class="n">segment_length</span><span class="p">)</span>
    <span class="n">top_end</span> <span class="o">=</span> <span class="n">top</span> <span class="o">+</span> <span class="p">(</span><span class="n">segment_length</span> <span class="o">-</span> <span class="n">top</span> <span class="o">%</span> <span class="n">segment_length</span><span class="p">)</span>

    <span class="c1"># Calculate the number of segments needed for each side</span>
    <span class="n">num_segments_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">right_end</span> <span class="o">-</span> <span class="n">left_start</span><span class="p">)</span> <span class="o">/</span> <span class="n">segment_length</span><span class="p">))</span>
    <span class="n">num_segments_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">top_end</span> <span class="o">-</span> <span class="n">bot_start</span><span class="p">)</span> <span class="o">/</span> <span class="n">segment_length</span><span class="p">))</span>

    <span class="c1"># Draw horizontal stripes at the top and bottom</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_segments_x</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">left_start</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">segment_length</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">segment_length</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;white&#39;</span>
        <span class="n">start_x</span> <span class="o">=</span> <span class="n">left_start</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">segment_length</span>
        <span class="n">end_x</span> <span class="o">=</span> <span class="n">start_x</span> <span class="o">+</span> <span class="n">segment_length</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">([</span><span class="n">bot</span><span class="p">,</span> <span class="n">top</span><span class="p">],</span> <span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>

    <span class="c1"># Draw vertical stripes on the left and right</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_segments_y</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">bot_start</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">segment_length</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">segment_length</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;white&#39;</span>
        <span class="n">start_y</span> <span class="o">=</span> <span class="n">bot_start</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">segment_length</span>
        <span class="n">end_y</span> <span class="o">=</span> <span class="n">start_y</span> <span class="o">+</span> <span class="n">segment_length</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">],</span> <span class="n">start_y</span><span class="p">,</span> <span class="n">end_y</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following cell defines a function to implement the zebra stripes on a given axis.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_zebra_frame</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">segment_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a zebra frame on the given axes.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - ax: The axes object on which to plot the zebra frame.</span>
<span class="sd">    - lw: The line width of the zebra frame. Default is 5.</span>
<span class="sd">    - segment_length: The length of each segment in the zebra frame. Default is 2.</span>
<span class="sd">    - crs: The coordinate reference system of the axes. Default is ccrs.PlateCarree().</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Call the function to add the zebra frame</span>
    <span class="n">add_zebra_frame</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">segment_length</span><span class="o">=</span><span class="n">segment_length</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
    <span class="c1"># add map grid</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">xlocs</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span><span class="n">ylocs</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">())</span>
    <span class="c1">#remove labels from top and right axes</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following cell defines a function to add arrow icons denoting percent change.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a function for adding the arrows</span>
<span class="k">def</span> <span class="nf">add_arrow</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">percent_change</span><span class="p">,</span><span class="n">crs</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">):</span>
<span class="c1"># make colormap of percent change</span>
    <span class="n">adjusted_heatmap_palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;YlOrRd&quot;</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Prepare data for quiver plot</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>  <span class="c1"># Dummy U component (no horizontal movement)</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">percent_change</span><span class="o">/</span><span class="mi">100</span>   <span class="c1"># V component scaled by percent change</span>
    <span class="n">arrow_scale</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Adjust as necessary for arrow size</span>
    <span class="n">arrow_width</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># Adjust for desired arrow thickness</span>

    <span class="c1"># Quiver plot</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">arrow_scale</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="n">adjusted_heatmap_palette</span><span class="p">(</span><span class="n">percent_change</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> 
              <span class="n">cmap</span><span class="o">=</span><span class="n">adjusted_heatmap_palette</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">arrow_width</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>And here is our final plotting code:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlims</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">185</span><span class="p">,</span><span class="o">-</span><span class="mi">152</span><span class="p">]</span>
<span class="n">ylims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span><span class="mi">40</span><span class="p">]</span>

<span class="c1">#fig, ax, crs,cmap = plot_map(vmin,vmax,xlims,ylims)</span>
<span class="n">crs</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">crs</span><span class="p">})</span>

<span class="c1">#convert subset[&#39;lon&#39;] to negative from 360</span>
<span class="n">subset</span><span class="p">[</span><span class="s1">&#39;lon_west&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">subset</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>


<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>

     <span class="c1"># Fill in water</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
    
 <span class="c1"># add a) b) labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="nb">chr</span><span class="p">(</span><span class="mi">97</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> 
         <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>

    <span class="c1"># add map grid</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">xlocs</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span><span class="n">ylocs</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">())</span>
  
    <span class="c1">#remove labels from top and right axes</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">left_labels</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">add_arrow</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;lon_west&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;slope_days&#39;</span><span class="p">],</span> <span class="n">crs</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;slope_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;slope_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">add_arrow</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;lon_west&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;slope_hours&#39;</span><span class="p">],</span> <span class="n">crs</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;slope_hours&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;slope_hours&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="c1"># Plot zebra frame</span>
<span class="c1">#plot_zebra_frame(axs[0], lw=5, segment_length=2, crs=crs)</span>
<span class="c1">#plot_zebra_frame(axs[1], lw=5, segment_length=2, crs=crs)</span>

<span class="c1">## Add text for percent change</span>
<span class="c1">#for i in range(len(subset[&#39;lon&#39;])):</span>
<span class="c1">#    if ds[&#39;percent_change_hours&#39;].values[i] &lt;200:</span>
        <span class="c1">#axs[0].text(subset[&#39;lon&#39;][i], subset[&#39;lat&#39;][i], &#39;{:.1f}&#39;.format(ds[&#39;slope_days&#39;].values[i]),</span>
                    <span class="c1">#color=adjusted_heatmap_palette(ds[&#39;slope_days&#39;].values[i] / vmax))</span>
        <span class="c1">#axs[1].text(subset[&#39;lon_west&#39;][i]+0.25, subset[&#39;lat&#39;][i]+0.5 , &#39;{:.1f}&#39;.format(ds[&#39;slope_hours&#39;].values[i]), fontsize=10,</span>
                    <span class="c1">#color=adjusted_heatmap_palette(ds[&#39;slope_hours&#39;].values[i] / vmax))</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;mag_fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># # Save the figure</span>
<span class="n">output_file_path</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="s1">&#39;SL_FloodFrequency_map.png&#39;</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_file_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../_images/5d2ced76e312a8e6cb97ad2a1dde49cdbabb48c4c3dfc88194d18fa1f56665b3.png" src="../_images/5d2ced76e312a8e6cb97ad2a1dde49cdbabb48c4c3dfc88194d18fa1f56665b3.png" />
</div>
</details>
</div>
<figure class="align-default" id="mag-fig">
<img alt="../_images/5d2ced76e312a8e6cb97ad2a1dde49cdbabb48c4c3dfc88194d18fa1f56665b3.png" src="../_images/5d2ced76e312a8e6cb97ad2a1dde49cdbabb48c4c3dfc88194d18fa1f56665b3.png" />
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Map of the rate of change in average flood (a) days and (b) hours per year above the <span class="pasted-text">99.000</span>th threshold of water levels at at <span class="pasted-text">Hawaiian Islands</span> tide gauges from <span class="pasted-text">1983-01-01</span> to <span class="pasted-text">2023-12-31</span></span><a class="headerlink" href="#mag-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<hr class="docutils" />
<section id="citations">
<h2>Citations<a class="headerlink" href="#citations" title="Permalink to this heading">#</a></h2>
<div class="docutils container" id="id3">
<dl class="citation">
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id2">SPM+14</a></span></dt>
<dd><p>William Sweet, Joseph Park, John Marra, Chris Zervas, and Stephen Gill. Sea level rise and nuisance flood frequency changes around the United States. Technical Report, NOAA, 2014. URL: <a class="reference external" href="https://repository.library.noaa.gov/view/noaa/30823">https://repository.library.noaa.gov/view/noaa/30823</a>.</p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id1">TWM+19</a></span></dt>
<dd><p>Philip R. Thompson, Matthew J. Widlansky, Mark A. Merrifield, Janet M. Becker, and John J. Marra. A Statistical Model for Frequency of Coastal Flooding in Honolulu, Hawaii, During the 21st Century. <em>Journal of Geophysical Research: Oceans</em>, 124(4):2787–2802, 2019. URL: <a class="reference external" href="https://onlinelibrary.wiley.com/doi/abs/10.1029/2018JC014741">https://onlinelibrary.wiley.com/doi/abs/10.1029/2018JC014741</a>, <a class="reference external" href="https://doi.org/10.1029/2018JC014741">doi:10.1029/2018JC014741</a>.</p>
</dd>
</dl>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "jwfiedler/SL_Hawaii",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="regional_and_local/SL_Components.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Components of Sea Level</p>
      </div>
    </a>
    <a class="right-next"
       href="FloodDuration.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Flood Duration</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-the-tide-station-s-data-set-s">Retrieve the Tide Station(s) Data Set(s)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-datum-to-mhhw">Set the Datum to MHHW</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assess-station-data-quality-for-the-por-1983-2022">Assess Station Data Quality for the POR (1983-2022)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#identify-epoch-for-the-flood-frequency-analysis">Identify epoch for the flood frequency analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adjust-the-data-from-calendar-year-to-storm-year">Adjust the data from calendar year to storm year</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assign-a-threshold">Assign a Threshold</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-and-plot-flood-frequency">Calculate and Plot Flood Frequency</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-flood-frequency-counts">Plot Flood Frequency Counts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-flood-duration">Plot Flood Duration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-percent-change-over-time">Calculate the percent change over time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-map">Create a map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Playground Coordinator
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>