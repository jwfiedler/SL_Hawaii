%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother


\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{Components of Sea Level}
\date{Jun 03, 2024}
\release{}
\author{Playground Coordinator}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{notebooks/regional_and_local/SL_Components_intra-annual::doc}}


\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Eventually stuff will go here}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
Hi, I am stuff.


\part{Following Merrifield, Firing \& Marra:}
\label{\detokenize{notebooks/regional_and_local/SL_Components_intra-annual:following-merrifield-firing-marra}}
\sphinxAtStartPar
This technique uses the Peaks Over Treshold (POT) technique to obtain extrema. This treshold is based on annual climatologies, obtained with the following steps:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Obtain hourly and daily mean tide gauge data from UHSLC

\item {} 
\sphinxAtStartPar
Deconstruct the time series into components with different timescales

\item {} 
\sphinxAtStartPar
Get high\sphinxhyphen{}pass filtered data:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
Remove linear trend

\item {} 
\sphinxAtStartPar
Obtain low\sphinxhyphen{}frequency SL variability by smoothing daily data with a running Gaussian\sphinxhyphen{}shaped low\sphinxhyphen{}pass filter (half power period at \textasciitilde{}5 months).

\item {} 
\sphinxAtStartPar
Compute seasonal cycle by averaging daily mean WL over all years for each year day

\item {} 
\sphinxAtStartPar
High\sphinxhyphen{}frequency SL is the residual of the daily means after removing \#3,\#4,\#5

\end{enumerate}

\item {} 
\sphinxAtStartPar
Tidal component is predicted with fits to hourly data

\item {} 
\sphinxAtStartPar
Reference all data to MHHW

\item {} 
\sphinxAtStartPar
Extreme events are the superposition of seasonal sea level, tidal and high frequency water level components.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
Tidal contribution is 95\% exceedence threshold of daily highest water above MHHW on each day.

\item {} 
\sphinxAtStartPar
HF variability is the 95\% exceedance threshold of the HF filtered data on each year day.

\end{enumerate}

\item {} 
\sphinxAtStartPar
Obtain TWL (H95) by stacking the seasonal sea level, 95\% tide contribution, and 95\% HF contribution

\end{enumerate}


\part{Deconstruct the time series into components with different timescales.}
\label{\detokenize{notebooks/regional_and_local/SL_Components_intra-annual:deconstruct-the-time-series-into-components-with-different-timescales}}

\chapter{Get high\sphinxhyphen{}pass filtered data}
\label{\detokenize{notebooks/regional_and_local/SL_Components_intra-annual:get-high-pass-filtered-data}}

\section{Remove linear trend}
\label{\detokenize{notebooks/regional_and_local/SL_Components_intra-annual:remove-linear-trend}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} remove the linear trend from rsl\PYGZus{}daily}

\PYG{n}{trend\PYGZus{}mag}\PYG{p}{,} \PYG{n}{trend\PYGZus{}line}\PYG{p}{,} \PYG{n}{trend\PYGZus{}rate} \PYG{o}{=} \PYG{n}{process\PYGZus{}trend\PYGZus{}with\PYGZus{}nan}\PYG{p}{(}\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw\PYGZus{}detrended}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{trend\PYGZus{}line}

\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw\PYGZus{}detrended}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id} \PYG{o}{=} \PYG{l+m+mi}{590}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gt}{\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{n+ne}{NameError}\PYG{g+gWhitespace}{                                 }Traceback (most recent call last)
\PYG{n}{Cell} \PYG{n}{In}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{line} \PYG{l+m+mi}{3}
\PYG{g+gWhitespace}{      }\PYG{l+m+mi}{1} \PYG{c+c1}{\PYGZsh{} remove the linear trend from rsl\PYGZus{}daily}
\PYG{n+ne}{\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{3} \PYG{n}{trend\PYGZus{}mag}\PYG{p}{,} \PYG{n}{trend\PYGZus{}line}\PYG{p}{,} \PYG{n}{trend\PYGZus{}rate} \PYG{o}{=} \PYG{n}{process\PYGZus{}trend\PYGZus{}with\PYGZus{}nan}\PYG{p}{(}\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gWhitespace}{      }\PYG{l+m+mi}{5} \PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw\PYGZus{}detrended}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{trend\PYGZus{}line}
\PYG{g+gWhitespace}{      }\PYG{l+m+mi}{7} \PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw\PYGZus{}detrended}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id} \PYG{o}{=} \PYG{l+m+mi}{590}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}

\PYG{n+ne}{NameError}: name \PYGZsq{}process\PYGZus{}trend\PYGZus{}with\PYGZus{}nan\PYGZsq{} is not defined
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Obtain low\sphinxhyphen{}frequency SL variability}
\label{\detokenize{notebooks/regional_and_local/SL_Components_intra-annual:obtain-low-frequency-sl-variability}}
\sphinxAtStartPar
Weâ€™ll do this by smoothing daily data with a running Gaussian\sphinxhyphen{}shaped low\sphinxhyphen{}pass filter (half power period at \textasciitilde{}5 months).

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{scipy}\PYG{n+nn}{.}\PYG{n+nn}{ndimage} \PYG{k+kn}{import} \PYG{n}{gaussian\PYGZus{}filter1d}
\PYG{k+kn}{from} \PYG{n+nn}{scipy}\PYG{n+nn}{.}\PYG{n+nn}{signal} \PYG{k+kn}{import} \PYG{n}{detrend}

\PYG{c+c1}{\PYGZsh{} Define the filter parameters}
\PYG{n}{half\PYGZus{}power\PYGZus{}period} \PYG{o}{=} \PYG{l+m+mi}{5} \PYG{o}{*} \PYG{l+m+mi}{30}  \PYG{c+c1}{\PYGZsh{} Approximate number of days in 5 months}
\PYG{n}{sigma} \PYG{o}{=} \PYG{n}{half\PYGZus{}power\PYGZus{}period} \PYG{o}{/} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{8} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} Convert half\PYGZhy{}power period to standard deviation}

\PYG{c+c1}{\PYGZsh{} Detrend each station\PYGZsq{}s time series and handle NaNs}
\PYG{n}{rsl\PYGZus{}mhhw\PYGZus{}detrended} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty\PYGZus{}like}\PYG{p}{(}\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}

\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{data} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}
    \PYG{n}{mask} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{isnan}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}
    \PYG{n}{data}\PYG{p}{[}\PYG{n}{mask}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{interp}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{flatnonzero}\PYG{p}{(}\PYG{n}{mask}\PYG{p}{)}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{flatnonzero}\PYG{p}{(}\PYG{o}{\PYGZti{}}\PYG{n}{mask}\PYG{p}{)}\PYG{p}{,} \PYG{n}{data}\PYG{p}{[}\PYG{o}{\PYGZti{}}\PYG{n}{mask}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{rsl\PYGZus{}mhhw\PYGZus{}detrended}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{n}{detrend}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}


\PYG{c+c1}{\PYGZsh{} Apply the Gaussian filter to the detrended data}
\PYG{n}{rsl\PYGZus{}mhhw\PYGZus{}detrended\PYGZus{}filtered} \PYG{o}{=} \PYG{n}{gaussian\PYGZus{}filter1d}\PYG{p}{(}\PYG{n}{rsl\PYGZus{}mhhw\PYGZus{}detrended}\PYG{p}{,} \PYG{n}{sigma}\PYG{o}{=}\PYG{n}{sigma}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Add the detrended and filtered data to the dataset}
\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw\PYGZus{}detrended\PYGZus{}interp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{n}{rsl\PYGZus{}mhhw\PYGZus{}detrended}\PYG{p}{)}
\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw\PYGZus{}detrended\PYGZus{}filtered}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{n}{rsl\PYGZus{}mhhw\PYGZus{}detrended\PYGZus{}filtered}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Compute the seasonal cycle by averaging daily mean water levels over all years for each year day}
\label{\detokenize{notebooks/regional_and_local/SL_Components_intra-annual:compute-the-seasonal-cycle-by-averaging-daily-mean-water-levels-over-all-years-for-each-year-day}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Compute seasonal cycle by averaging daily rsl\PYGZus{}mhhw over all years for each year day}
\PYG{n}{seasonal\PYGZus{}cycle} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw\PYGZus{}detrended}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time.dayofyear}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 

\PYG{c+c1}{\PYGZsh{} Plot the seasonal cycle, with 11 different lines, and add the station names to the legend}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{seasonal\PYGZus{}cycle}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{seasonal\PYGZus{}cycle}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dayofyear}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{seasonal\PYGZus{}cycle}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{station\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Day of Year}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Median Detrended rsl\PYGZus{}mhhw [m]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Seasonal Cycle of rsl\PYGZus{}mhhw Detrended}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{loc}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center left}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{bbox\PYGZus{}to\PYGZus{}anchor}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Obtain High Frequency data}
\label{\detokenize{notebooks/regional_and_local/SL_Components_intra-annual:obtain-high-frequency-data}}
\sphinxAtStartPar
It is the residual of the daily means after removing the linear trend, low\sphinxhyphen{}frequency variability, and seasonal cycle.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Extend the seasonal cycle to the full time series length for each station}
\PYG{n}{seasonal\PYGZus{}cycle\PYGZus{}full} \PYG{o}{=} \PYG{n}{seasonal\PYGZus{}cycle}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{dayofyear}\PYG{o}{=}\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{dayofyear}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Compute the residual by removing the linear trend, filtered data, and seasonal cycle}
\PYG{n}{residual} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw\PYGZus{}detrended}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{rsl\PYGZus{}mhhw\PYGZus{}detrended\PYGZus{}filtered} \PYG{o}{\PYGZhy{}} \PYG{n}{seasonal\PYGZus{}cycle\PYGZus{}full}

\PYG{c+c1}{\PYGZsh{} Add the residual to the dataset}
\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw\PYGZus{}high\PYGZus{}pass\PYGZus{}filtered}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{n}{residual}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Plot the residual for each station}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw\PYGZus{}high\PYGZus{}pass\PYGZus{}filtered}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{label}\PYG{o}{=}\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{station\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\chapter{Tidal component is predicted with fits to hourly data}
\label{\detokenize{notebooks/regional_and_local/SL_Components_intra-annual:tidal-component-is-predicted-with-fits-to-hourly-data}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{split\PYGZus{}continuous\PYGZus{}segments}\PYG{p}{(}\PYG{n}{time}\PYG{p}{,} \PYG{n}{data}\PYG{p}{,} \PYG{n}{max\PYGZus{}gap\PYGZus{}hours}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} Create a DataFrame from the time and data arrays}
    \PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{time}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{data}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Calculate the time difference in hours}
    \PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time\PYGZus{}diff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{diff}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{total\PYGZus{}seconds}\PYG{p}{(}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mi}{3600}
    
    \PYG{c+c1}{\PYGZsh{} Identify the start of new segments}
    \PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{segment}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time\PYGZus{}diff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZgt{}} \PYG{n}{max\PYGZus{}gap\PYGZus{}hours}\PYG{p}{)}\PYG{o}{.}\PYG{n}{cumsum}\PYG{p}{(}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Group by the segment identifier and convert groups to list of tuples}
    \PYG{n}{segments} \PYG{o}{=} \PYG{p}{[}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{zip}\PYG{p}{(}\PYG{n}{group}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{group}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{k}{for} \PYG{n}{\PYGZus{}}\PYG{p}{,} \PYG{n}{group} \PYG{o+ow}{in} \PYG{n}{df}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{segment}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}
    
    \PYG{k}{return} \PYG{n}{segments}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} convert time in rsl\PYGZus{}hourly to fractional year, starting at 0}
\PYG{n}{time} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{time} \PYG{o}{=} \PYG{n}{time} \PYG{o}{\PYGZhy{}} \PYG{n}{time}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{time} \PYG{o}{=} \PYG{n}{time}\PYG{o}{/}\PYG{n}{np}\PYG{o}{.}\PYG{n}{timedelta64}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{time} \PYG{o}{=} \PYG{n}{time}\PYG{o}{/}\PYG{l+m+mf}{365.25}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} check to make sure that data\PYGZus{}dir/rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions.nc exists, if not, run the following code to create it}
\PYG{k}{if} \PYG{o+ow}{not} \PYG{p}{(}\PYG{n}{data\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions.nc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{exists}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions.nc not found in ../../data. Will proceed with tidal analysis and prediction.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}


    \PYG{c+c1}{\PYGZsh{} Prepare an empty array to store tidal predictions for all stations}
    \PYG{n}{sea\PYGZus{}level\PYGZus{}shape} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sea\PYGZus{}level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{shape}
    \PYG{n}{tidal\PYGZus{}predictions} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{full}\PYG{p}{(}\PYG{n}{sea\PYGZus{}level\PYGZus{}shape}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{nan}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} Initialize with NaNs}

    \PYG{c+c1}{\PYGZsh{} Perform tidal analysis and prediction for each station}
    \PYG{k}{for} \PYG{n}{i}\PYG{p}{,} \PYG{n}{station\PYGZus{}id} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Processing }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{station\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{station\PYGZus{}id}\PYG{p}{)}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}\PYG{p}{)}

        \PYG{n}{sea\PYGZus{}level\PYGZus{}data} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sea\PYGZus{}level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{station\PYGZus{}id}\PYG{p}{)}\PYG{o}{.}\PYG{n}{values}
        \PYG{c+c1}{\PYGZsh{}remove linear trend}
        \PYG{n}{sea\PYGZus{}level\PYGZus{}data} \PYG{o}{=} \PYG{n}{sea\PYGZus{}level\PYGZus{}data} \PYG{o}{\PYGZhy{}} \PYG{n}{trend\PYGZus{}rate}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{station\PYGZus{}id}\PYG{p}{)}\PYG{o}{.}\PYG{n}{values}\PYG{o}{*}\PYG{l+m+mi}{1000}\PYG{o}{*}\PYG{n}{time}
        \PYG{c+c1}{\PYGZsh{} print the \PYGZpc{} nans in the data}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Percentage of NaNs in the data: }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{isnan}\PYG{p}{(}\PYG{n}{sea\PYGZus{}level\PYGZus{}data}\PYG{p}{)}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{p}{)} \PYG{o}{/} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{sea\PYGZus{}level\PYGZus{}data}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mi}{100}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
        \PYG{n}{time\PYGZus{}data} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}
        \PYG{n}{latitude} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{station\PYGZus{}id}\PYG{p}{)}\PYG{o}{.}\PYG{n}{values}

        \PYG{c+c1}{\PYGZsh{} Convert time\PYGZus{}data to pandas datetime format for UTide}
        \PYG{n}{time\PYGZus{}series} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{time\PYGZus{}data}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Split data into continuous segments}
        \PYG{n}{segments} \PYG{o}{=} \PYG{n}{split\PYGZus{}continuous\PYGZus{}segments}\PYG{p}{(}\PYG{n}{time\PYGZus{}series}\PYG{p}{,} \PYG{n}{sea\PYGZus{}level\PYGZus{}data}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Number of segments: }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{segments}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Perform harmonic analysis on each segment}
        \PYG{k}{for} \PYG{n}{segment} \PYG{o+ow}{in} \PYG{n}{segments}\PYG{p}{:}
            \PYG{c+c1}{\PYGZsh{} print counter}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Processing segment }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{segments}\PYG{o}{.}\PYG{n}{index}\PYG{p}{(}\PYG{n}{segment}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ of }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{segments}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
            \PYG{n}{segment\PYGZus{}time}\PYG{p}{,} \PYG{n}{segment\PYGZus{}data} \PYG{o}{=} \PYG{n+nb}{zip}\PYG{p}{(}\PYG{o}{*}\PYG{n}{segment}\PYG{p}{)}
            \PYG{n}{segment\PYGZus{}time} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{segment\PYGZus{}time}\PYG{p}{)}
            \PYG{n}{segment\PYGZus{}data} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{segment\PYGZus{}data}\PYG{p}{)}
    
            \PYG{c+c1}{\PYGZsh{} Convert datetime to numeric format for interpolation}
            \PYG{n}{segment\PYGZus{}time\PYGZus{}numeric} \PYG{o}{=} \PYG{n}{segment\PYGZus{}time}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{datetime64[s]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{float64}\PYG{p}{)}
    
            \PYG{c+c1}{\PYGZsh{} Check for NaNs and interpolate to fill NaNs if needed}
            \PYG{k}{if} \PYG{n}{np}\PYG{o}{.}\PYG{n}{isnan}\PYG{p}{(}\PYG{n}{segment\PYGZus{}data}\PYG{p}{)}\PYG{o}{.}\PYG{n}{any}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{mask} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{isnan}\PYG{p}{(}\PYG{n}{segment\PYGZus{}data}\PYG{p}{)}
                \PYG{n}{interp\PYGZus{}func} \PYG{o}{=} \PYG{n}{interp1d}\PYG{p}{(}\PYG{n}{segment\PYGZus{}time\PYGZus{}numeric}\PYG{p}{[}\PYG{o}{\PYGZti{}}\PYG{n}{mask}\PYG{p}{]}\PYG{p}{,} \PYG{n}{segment\PYGZus{}data}\PYG{p}{[}\PYG{o}{\PYGZti{}}\PYG{n}{mask}\PYG{p}{]}\PYG{p}{,} \PYG{n}{kind}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{linear}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fill\PYGZus{}value}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{extrapolate}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{n}{segment\PYGZus{}data}\PYG{p}{[}\PYG{n}{mask}\PYG{p}{]} \PYG{o}{=} \PYG{n}{interp\PYGZus{}func}\PYG{p}{(}\PYG{n}{segment\PYGZus{}time\PYGZus{}numeric}\PYG{p}{[}\PYG{n}{mask}\PYG{p}{]}\PYG{p}{)}
    
            \PYG{c+c1}{\PYGZsh{} Perform harmonic analysis}
            \PYG{n}{coef} \PYG{o}{=} \PYG{n}{utide}\PYG{o}{.}\PYG{n}{solve}\PYG{p}{(}\PYG{n}{segment\PYGZus{}time}\PYG{p}{,} \PYG{n}{segment\PYGZus{}data}\PYG{p}{,} \PYG{n}{lat}\PYG{o}{=}\PYG{n}{latitude}\PYG{p}{)}
    
            \PYG{c+c1}{\PYGZsh{} Predict the tide using the fitted model}
            \PYG{n}{tide\PYGZus{}pred} \PYG{o}{=} \PYG{n}{utide}\PYG{o}{.}\PYG{n}{reconstruct}\PYG{p}{(}\PYG{n}{segment\PYGZus{}time}\PYG{p}{,} \PYG{n}{coef}\PYG{p}{)}
    
            \PYG{c+c1}{\PYGZsh{} Store the tidal predictions in the array}
            \PYG{k}{for} \PYG{n}{t}\PYG{p}{,} \PYG{n}{pred} \PYG{o+ow}{in} \PYG{n+nb}{zip}\PYG{p}{(}\PYG{n}{segment\PYGZus{}time}\PYG{p}{,} \PYG{n}{tide\PYGZus{}pred}\PYG{o}{.}\PYG{n}{h}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{idx} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{where}\PYG{p}{(}\PYG{n}{time\PYGZus{}series} \PYG{o}{==} \PYG{n}{t}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
                \PYG{n}{tidal\PYGZus{}predictions}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,} \PYG{n}{idx}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pred}
    
    \PYG{c+c1}{\PYGZsh{} Create the tidal predictions xarray Dataset with the same structure as rsl\PYGZus{}hourly}
    \PYG{n}{tidal\PYGZus{}predictions\PYGZus{}ds} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{Dataset}\PYG{p}{(}
        \PYG{n}{data\PYGZus{}vars}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tidal\PYGZus{}prediction}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{(}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{n}{tidal\PYGZus{}predictions}\PYG{p}{)}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
        \PYG{n}{coords}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{\PYGZcb{}}
    \PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} save rsl\PYGZus{}daily\PYGZus{}combined to the data directory}
    \PYG{n}{tidal\PYGZus{}predictions\PYGZus{}ds}\PYG{o}{.}\PYG{n}{to\PYGZus{}netcdf}\PYG{p}{(}\PYG{n}{data\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions.nc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tidal predictions saved to: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{data\PYGZus{}dir}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions.nc}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{k}{else}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions.nc found in ../../data. Proceed.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
Reference all data to MHHW

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} open rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions.nc}
\PYG{n}{rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{open\PYGZus{}dataset}\PYG{p}{(}\PYG{n}{data\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions.nc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}

\PYG{n}{rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions}
\PYG{c+c1}{\PYGZsh{}Adjust the tidal precictions to be in MHHW}
\PYG{c+c1}{\PYGZsh{} for station\PYGZus{}id in rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions.data\PYGZus{}vars:}
    \PYG{c+c1}{\PYGZsh{} rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions[station\PYGZus{}id] = rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions[station\PYGZus{}id] + rsl\PYGZus{}hourly[\PYGZsq{}MHHW\PYGZsq{}].sel(record\PYGZus{}id=int(station\PYGZus{}id))}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} reference it to MHHW}
\PYG{n}{rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tidal\PYGZus{}prediction\PYGZus{}mhhw\PYGZus{}m}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.001}\PYG{o}{*}\PYG{p}{(}\PYG{n}{rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tidal\PYGZus{}prediction}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MHHW}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}plot the tidal predictions for Honolulu}
\PYG{n}{rid} \PYG{o}{=} \PYG{l+m+mi}{4}
\PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sea\PYGZus{}level\PYGZus{}mhhw}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.001}\PYG{o}{*}\PYG{p}{(}\PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sea\PYGZus{}level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MHHW}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{rsl\PYGZus{}hourly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sea\PYGZus{}level\PYGZus{}mhhw}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{record\PYGZus{}id}\PYG{p}{[}\PYG{n}{rid}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} rsl\PYGZus{}daily[\PYGZsq{}rsl\PYGZus{}mhhw\PYGZus{}detrended\PYGZus{}interp\PYGZsq{}].sel(record\PYGZus{}id=rsl\PYGZus{}daily.record\PYGZus{}id[rid]).plot()}
\PYG{n}{rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tidal\PYGZus{}prediction\PYGZus{}mhhw\PYGZus{}m}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{record\PYGZus{}id}\PYG{p}{[}\PYG{n}{rid}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Find 95\% exceedence threshold for tidal component}
\label{\detokenize{notebooks/regional_and_local/SL_Components_intra-annual:find-95-exceedence-threshold-for-tidal-component}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} \PYGZdq{}The tidal contribution is the 95\PYGZpc{} exceedance threshold of daily highest water above the MHHW on each year\PYGZhy{}day.\PYGZdq{}\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} first we\PYGZsq{}ll get \PYGZdq{}daily highest water\PYGZdq{}}
\PYG{n}{rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}hawaii\PYGZus{}tidal\PYGZus{}predictions}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tidal\PYGZus{}prediction\PYGZus{}mhhw\PYGZus{}m}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{} .groupby(\PYGZsq{}time.day\PYGZsq{}).max(dim=\PYGZsq{}time\PYGZsq{})}
\PYG{c+c1}{\PYGZsh{}plot}
\PYG{c+c1}{\PYGZsh{} get daily max tidal prediction by resampling to daily and taking the max}
\PYG{n}{rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal}\PYG{o}{.}\PYG{n}{resample}\PYG{p}{(}\PYG{n}{time}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}If we go by the exact wording in the Merrifield doc, it\PYGZsq{}s the 95th percentile of the daily max tidal prediction}
\PYG{c+c1}{\PYGZsh{} and we need to do this on year day}
\PYG{c+c1}{\PYGZsh{} seasonal\PYGZus{}cycle = rsl\PYGZus{}daily[\PYGZsq{}rsl\PYGZus{}mhhw\PYGZus{}detrended\PYGZsq{}].groupby(\PYGZsq{}time.dayofyear\PYGZsq{}).median(dim=\PYGZsq{}time\PYGZsq{}) \PYGZsh{}NOTE I AM USING MEDIAN!!!}

\PYG{c+c1}{\PYGZsh{} \PYGZsh{} get 95th percentile of rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal}
\PYG{c+c1}{\PYGZsh{} rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal\PYGZus{}95 = rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal.quantile(0.95, dim=\PYGZsq{}time\PYGZsq{})}

\PYG{c+c1}{\PYGZsh{} rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal\PYGZus{}95}

\PYG{c+c1}{\PYGZsh{} rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal\PYGZus{}95 = rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal.groupby(\PYGZsq{}time.dayofyear\PYGZsq{}).quantile(0.95, dim=\PYGZsq{}time\PYGZsq{})}
\PYG{c+c1}{\PYGZsh{} rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal\PYGZus{}50 = rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal.groupby(\PYGZsq{}time.dayofyear\PYGZsq{}).quantile(0.5, dim=\PYGZsq{}time\PYGZsq{})}
\PYG{c+c1}{\PYGZsh{} rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal\PYGZus{}5 = rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal.groupby(\PYGZsq{}time.dayofyear\PYGZsq{}).quantile(0.05, dim=\PYGZsq{}time\PYGZsq{})}


\PYG{c+c1}{\PYGZsh{} rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal\PYGZus{}95}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
HF variability is the 95\% exceedance threshold of the HF filtered data on each year day.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} get the 95th percentile of the HF residual data}
\PYG{n}{rsl\PYGZus{}daily\PYGZus{}residual\PYGZus{}95} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw\PYGZus{}high\PYGZus{}pass\PYGZus{}filtered}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time.dayofyear}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{quantile}\PYG{p}{(}\PYG{l+m+mf}{0.95}\PYG{p}{,} \PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{rsl\PYGZus{}daily\PYGZus{}residual\PYGZus{}95}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{rsl\PYGZus{}low\PYGZus{}frequency} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}mhhw\PYGZus{}detrended\PYGZus{}filtered}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{record\PYGZus{}id}\PYG{p}{[}\PYG{n}{rid}\PYG{p}{]}\PYG{p}{)} \PYG{o}{+} \PYG{n}{trend\PYGZus{}line}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{record\PYGZus{}id}\PYG{p}{[}\PYG{n}{rid}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} plot rsl\PYGZus{}low\PYGZus{}frequency, trend\PYGZus{}line}
\PYG{n}{rsl\PYGZus{}low\PYGZus{}frequency}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{trend\PYGZus{}line}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{record\PYGZus{}id}\PYG{p}{[}\PYG{n}{rid}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
Obtain TWL (H95) by stacking the seasonal sea level, tide contribution, and HF contribution

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{H95} \PYG{o}{=} \PYG{n}{seasonal\PYGZus{}cycle}\PYG{o}{+} \PYG{n}{rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal\PYGZus{}95}\PYG{o}{+} \PYG{n}{rsl\PYGZus{}daily\PYGZus{}residual\PYGZus{}95}
\PYG{n}{H95}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{l+m+mi}{570}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} seasonal\PYGZus{}cycle.sel(record\PYGZus{}id=570).plot()}
\PYG{n}{rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal\PYGZus{}95}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{l+m+mi}{570}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal\PYGZus{}5}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{l+m+mi}{570}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{rsl\PYGZus{}daily\PYGZus{}max\PYGZus{}tidal\PYGZus{}50}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{l+m+mi}{570}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} rsl\PYGZus{}daily\PYGZus{}residual\PYGZus{}95.sel(record\PYGZus{}id=570).plot()}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}






\renewcommand{\indexname}{Index}
\printindex
\end{document}