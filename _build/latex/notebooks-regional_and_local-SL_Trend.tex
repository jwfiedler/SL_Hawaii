%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother


\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{Sea Level Trend}
\date{Jun 03, 2024}
\release{}
\author{Playground Coordinator}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{notebooks/regional_and_local/SL_Trend::doc}}



\begin{wrapfigure}{r}{0pt}
\centering
\noindent\sphinxincludegraphics[scale=0.25]{{e8f225b94fb7f185d6a73f7c486490baf3d1d23d003eb80998af80be40a8c1ef}.png}
\end{wrapfigure}

\sphinxAtStartPar
In this notebook, we’ll be creating a {\hyperref[\detokenize{notebooks/regional_and_local/SL_Trend:create-a-table}]{\sphinxcrossref{\DUrole{std,std-ref}{table}}}}, a {\hyperref[\detokenize{notebooks/regional_and_local/SL_Trend:fig-mag}]{\sphinxcrossref{\DUrole{std,std-ref}{map}}}}, and a time series {\hyperref[\detokenize{notebooks/regional_and_local/SL_Trend:trend-fig}]{\sphinxcrossref{\DUrole{std,std-ref}{plot}}}} of absolute and regional sea level change at Hawaiian Islands tide gauge stations from 1993\sphinxhyphen{}2022. Absolute sea level, typically measured by satellite altimetry, refers to the height of the sea surface relative to a reference ellipsoid. Here, we’ll use the global ocean gridded L4 Sea Level Anomalies (SLA) available from Copernicus CLS (France) {[}\hyperlink{cite.notebooks/regional_and_local/SL_Trend:id10}{CLSFrance}{]}, which is the sea surface height (SSH) minus the mean sea surface (MSS), where the MSS is the temporal mean of SSH over a given period. Relative sea level is measured by a tide gauge, and is the sea level relative to land at that location. Differences between the two measurements can arise from vertical land motion, regional oceanographic conditions like currents, and changes to the gravitational field (affecting the geoid).

\sphinxAtStartPar
Download Files:
\DUrole{xref,download,myst}{Map} |
\DUrole{xref,download,myst}{Time Series Plot} |
\DUrole{xref,download,myst}{Table}


\part{Setup}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:setup}}
\sphinxAtStartPar
We’ll run our initial setup for libraries, plotting, and directories.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}}\PYG{k}{run} ../setup.ipynb  
\PYG{o}{\PYGZpc{}}\PYG{k}{run} ../plotting\PYGZus{}functions.ipynb
\PYG{n}{data\PYGZus{}dir} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../data}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{)}
\PYG{n}{output\PYGZus{}dir} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../output}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\part{Retrieve Data Sources}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:retrieve-data-sources}}
\sphinxAtStartPar
Please see the Data Wrangling notebook, where we source everything from UHSLC and CMEMS. In this notebook, we saved three xarray datasets: a sea level altimetry product for the area around the Hawaiian Islands (asl\_hawaii.nc), an hourly tide gauge record for the stations in that region (rsl\_hawaii.nc), and a de\sphinxhyphen{}meaned daily average tide gauge record (rsl\_daily\_hawaii.nc).

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Next, let\PYGZsq{}s establish a period of record from 1993\PYGZhy{}2022.}
\PYG{c+c1}{\PYGZsh{} establish the time period of interest}
\PYG{n}{start\PYGZus{}date} \PYG{o}{=} \PYG{n}{dt}\PYG{o}{.}\PYG{n}{datetime}\PYG{p}{(}\PYG{l+m+mi}{1993}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{end\PYGZus{}date} \PYG{o}{=} \PYG{n}{dt}\PYG{o}{.}\PYG{n}{datetime}\PYG{p}{(}\PYG{l+m+mi}{2022}\PYG{p}{,}\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{l+m+mi}{31}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Normalize the data relative to the 1993\PYGZhy{}2012 epoch}
\PYG{n}{epoch\PYGZus{}start}\PYG{p}{,} \PYG{n}{epoch\PYGZus{}end} \PYG{o}{=} \PYG{n}{start\PYGZus{}date}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2012\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} also save them as strings, for plotting}
\PYG{n}{start\PYGZus{}date\PYGZus{}str} \PYG{o}{=} \PYG{n}{start\PYGZus{}date}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y\PYGZhy{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{end\PYGZus{}date\PYGZus{}str} \PYG{o}{=} \PYG{n}{end\PYGZus{}date}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y\PYGZhy{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} glue these variables}
\PYG{n}{glue}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{start\PYGZus{}date}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{start\PYGZus{}date}\PYG{p}{)}
\PYG{n}{glue}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{end\PYGZus{}date}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{end\PYGZus{}date}\PYG{p}{)}
\PYG{n}{glue}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{start\PYGZus{}date\PYGZus{}str}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{start\PYGZus{}date\PYGZus{}str}\PYG{p}{)}
\PYG{n}{glue}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{end\PYGZus{}date\PYGZus{}str}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{end\PYGZus{}date\PYGZus{}str}\PYG{p}{)}
\PYG{n}{glue}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{station\PYGZus{}group}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Hawaiian Islands}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
datetime.datetime(1993, 1, 1, 0, 0)
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
datetime.datetime(2022, 12, 31, 0, 0)
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZsq{}1993\PYGZhy{}01\PYGZhy{}01\PYGZsq{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZsq{}2022\PYGZhy{}12\PYGZhy{}31\PYGZsq{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZsq{}Hawaiian Islands\PYGZsq{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}import datasets}
\PYG{n}{rsl\PYGZus{}daily} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{open\PYGZus{}dataset}\PYG{p}{(}\PYG{n}{data\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}daily\PYGZus{}hawaii.nc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{rsl} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{open\PYGZus{}dataset}\PYG{p}{(}\PYG{n}{data\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rsl\PYGZus{}hawaii.nc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{sla\PYGZus{}tg} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{open\PYGZus{}dataset}\PYG{p}{(}\PYG{n}{data\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{asl\PYGZus{}hawaii.nc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{sla} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{open\PYGZus{}dataset}\PYG{p}{(}\PYG{n}{data\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cmems\PYGZus{}L4\PYGZus{}SSH\PYGZus{}0.25deg\PYGZus{}1993\PYGZus{}2023.nc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{sla}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{col}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{col\PYGZus{}wrap}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{sharey}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{sharex}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Use g.axs to iterate over the axes in the FacetGrid}
\PYG{k}{for} \PYG{n}{ax}\PYG{p}{,} \PYG{n}{rid} \PYG{o+ow}{in} \PYG{n+nb}{zip}\PYG{p}{(}\PYG{n}{g}\PYG{o}{.}\PYG{n}{axs}\PYG{o}{.}\PYG{n}{flat}\PYG{p}{,} \PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{record\PYGZus{}id}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} Accessing the station\PYGZus{}name coordinate for the current record\PYGZus{}id directly}
    \PYG{n}{station\PYGZus{}name} \PYG{o}{=} \PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{station\PYGZus{}name}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{rid}\PYG{p}{)}\PYG{o}{.}\PYG{n}{item}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{n}{station\PYGZus{}name}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylim}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.7}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{4738a7053e3d1f7f03fbfd3a45e0820bad994017bd4eb55d6973e59a581731a1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{rsl\PYGZus{}daily}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}xarray.Dataset\PYGZgt{} Size: 2MB
Dimensions:       (record\PYGZus{}id: 11, time: 10957)
Coordinates:
  * record\PYGZus{}id     (record\PYGZus{}id) int16 22B 140 500 520 570 ... 610 5470 5480 5520
  * time          (time) datetime64[ns] 88kB 1993\PYGZhy{}01\PYGZhy{}01 ... 2022\PYGZhy{}12\PYGZhy{}31
    lat           (record\PYGZus{}id) float32 44B ...
    lon           (record\PYGZus{}id) float32 44B ...
    station\PYGZus{}name  (record\PYGZus{}id) \PYGZlt{}U17 748B ...
    storm\PYGZus{}time    (time) datetime64[ns] 88kB ...
Data variables:
    rsl\PYGZus{}anomaly   (record\PYGZus{}id, time) float32 482kB ...
    rsl\PYGZus{}mhhw      (record\PYGZus{}id, time) float64 964kB ...
Attributes:
    long\PYGZus{}name:  Sea Level Anomaly
    units:      m
    source:     in situ tide gauge water level observations
    platform:   station\PYGZus{}name, station\PYGZus{}country, station\PYGZus{}country\PYGZus{}code, uhslc\PYGZus{}id...
    epoch:      1993\PYGZhy{}2001
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{rsl\PYGZus{}anomaly}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{col}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{col\PYGZus{}wrap}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{sharey}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{sharex}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Use g.axs to iterate over the axes in the FacetGrid}
\PYG{k}{for} \PYG{n}{ax}\PYG{p}{,} \PYG{n}{rid} \PYG{o+ow}{in} \PYG{n+nb}{zip}\PYG{p}{(}\PYG{n}{g}\PYG{o}{.}\PYG{n}{axs}\PYG{o}{.}\PYG{n}{flat}\PYG{p}{,} \PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{record\PYGZus{}id}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} Accessing the station\PYGZus{}name coordinate for the current record\PYGZus{}id directly}
    \PYG{n}{station\PYGZus{}name} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{station\PYGZus{}name}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{rid}\PYG{p}{)}\PYG{o}{.}\PYG{n}{item}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{n}{station\PYGZus{}name}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylim}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.7}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{8cab19ec35f0c95770af36ae81828c8d180c4ee4e9163eb07012e09c91b3ae49}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
How many nan values are there in rsl{[}‘sea\_level’{]}?

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} first we\PYGZsq{}ll truncate the data to the period of record}
\PYG{n}{sla\PYGZus{}epoch} \PYG{o}{=} \PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{time}\PYG{o}{=}\PYG{n+nb}{slice}\PYG{p}{(}\PYG{n}{epoch\PYGZus{}start}\PYG{p}{,} \PYG{n}{epoch\PYGZus{}end}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} \PYGZsh{}print(\PYGZsq{}Number of NaN values in the tide gauge data: \PYGZsq{}, tide\PYGZus{}gauge\PYGZus{}data\PYGZus{}POR.isnull().sum().values)}
\PYG{c+c1}{\PYGZsh{}Run a quick check to see if the Ab SL from CMEMS is in fact zeroed about the 1993\PYGZhy{}2012 epoch. Curse the details.}
\PYG{c+c1}{\PYGZsh{} Extract the data for the period of record (POR)}
\PYG{c+c1}{\PYGZsh{}check if the mean is zero}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The mean for the [1993,2012] epoch of the SLA is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{sla\PYGZus{}epoch}\PYG{o}{.}\PYG{n}{sla}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{skipna}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{m. Re\PYGZhy{}check source data to make sure this is correct.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
The mean for the [1993,2012] epoch of the SLA is [0.02338939 0.02242252 0.02665729 0.02673529 0.02434594 0.02427523
 0.02620254 0.02673529 0.02515467 0.02468215 0.02189661] m. Re\PYGZhy{}check source data to make sure this is correct.
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxShadowBox}
\sphinxstylesidebartitle{}

\sphinxAtStartPar
OLD NOTE FROM PALAU, UPDATE TO HI:
It should be noted that the coordinates from \sphinxurl{https://ccar.colorado.edu/altimetry/} for the altimetry product are: Lat: 7.2500°N, Lon: 134.4167°E, using \sphinxurl{https://podaac.jpl.nasa.gov/dataset/SEA\_SURFACE\_HEIGHT\_ALT\_GRIDS\_L4\_2SATS\_5DAY\_6THDEG\_V\_JPL1812} as their data source. This data is gridded at 1/6th of a degree as supposed to 1/4th of a degree in the source we are using.
\end{sphinxShadowBox}

\sphinxAtStartPar
Let’s make a map to determine exactly where these points are in space. First we’ll define a function to prettify the map, which we’ll use for the rest of the notebook.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{add\PYGZus{}zebra\PYGZus{}frame}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{,} \PYG{n}{lw}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{segment\PYGZus{}length}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{n}{crs}\PYG{o}{=}\PYG{n}{ccrs}\PYG{o}{.}\PYG{n}{PlateCarree}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} Get the current extent of the map}
    \PYG{n}{left}\PYG{p}{,} \PYG{n}{right}\PYG{p}{,} \PYG{n}{bot}\PYG{p}{,} \PYG{n}{top} \PYG{o}{=} \PYG{n}{ax}\PYG{o}{.}\PYG{n}{get\PYGZus{}extent}\PYG{p}{(}\PYG{n}{crs}\PYG{o}{=}\PYG{n}{crs}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Calculate the nearest 0 or 0.5 degree mark within the current extent}
    \PYG{n}{left\PYGZus{}start} \PYG{o}{=} \PYG{n}{left} \PYG{o}{\PYGZhy{}} \PYG{n}{left} \PYG{o}{\PYGZpc{}} \PYG{n}{segment\PYGZus{}length}
    \PYG{n}{bot\PYGZus{}start} \PYG{o}{=} \PYG{n}{bot} \PYG{o}{\PYGZhy{}} \PYG{n}{bot} \PYG{o}{\PYGZpc{}} \PYG{n}{segment\PYGZus{}length}

    \PYG{c+c1}{\PYGZsh{} Adjust the start if it does not align with the desired segment start}
    \PYG{k}{if} \PYG{n}{left} \PYG{o}{\PYGZpc{}} \PYG{n}{segment\PYGZus{}length} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{n}{segment\PYGZus{}length} \PYG{o}{/} \PYG{l+m+mi}{2}\PYG{p}{:}
        \PYG{n}{left\PYGZus{}start} \PYG{o}{+}\PYG{o}{=} \PYG{n}{segment\PYGZus{}length}
    \PYG{k}{if} \PYG{n}{bot} \PYG{o}{\PYGZpc{}} \PYG{n}{segment\PYGZus{}length} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{n}{segment\PYGZus{}length} \PYG{o}{/} \PYG{l+m+mi}{2}\PYG{p}{:}
        \PYG{n}{bot\PYGZus{}start} \PYG{o}{+}\PYG{o}{=} \PYG{n}{segment\PYGZus{}length}

    \PYG{c+c1}{\PYGZsh{} Extend the frame slightly beyond the map extent to ensure full coverage}
    \PYG{n}{right\PYGZus{}end} \PYG{o}{=} \PYG{n}{right} \PYG{o}{+} \PYG{p}{(}\PYG{n}{segment\PYGZus{}length} \PYG{o}{\PYGZhy{}} \PYG{n}{right} \PYG{o}{\PYGZpc{}} \PYG{n}{segment\PYGZus{}length}\PYG{p}{)}
    \PYG{n}{top\PYGZus{}end} \PYG{o}{=} \PYG{n}{top} \PYG{o}{+} \PYG{p}{(}\PYG{n}{segment\PYGZus{}length} \PYG{o}{\PYGZhy{}} \PYG{n}{top} \PYG{o}{\PYGZpc{}} \PYG{n}{segment\PYGZus{}length}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Calculate the number of segments needed for each side}
    \PYG{n}{num\PYGZus{}segments\PYGZus{}x} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{ceil}\PYG{p}{(}\PYG{p}{(}\PYG{n}{right\PYGZus{}end} \PYG{o}{\PYGZhy{}} \PYG{n}{left\PYGZus{}start}\PYG{p}{)} \PYG{o}{/} \PYG{n}{segment\PYGZus{}length}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{num\PYGZus{}segments\PYGZus{}y} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{ceil}\PYG{p}{(}\PYG{p}{(}\PYG{n}{top\PYGZus{}end} \PYG{o}{\PYGZhy{}} \PYG{n}{bot\PYGZus{}start}\PYG{p}{)} \PYG{o}{/} \PYG{n}{segment\PYGZus{}length}\PYG{p}{)}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Draw horizontal stripes at the top and bottom}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{num\PYGZus{}segments\PYGZus{}x}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{color} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{if} \PYG{p}{(}\PYG{n}{left\PYGZus{}start} \PYG{o}{+} \PYG{n}{i} \PYG{o}{*} \PYG{n}{segment\PYGZus{}length}\PYG{p}{)} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{segment\PYGZus{}length}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0} \PYG{k}{else} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{white}\PYG{l+s+s1}{\PYGZsq{}}
        \PYG{n}{start\PYGZus{}x} \PYG{o}{=} \PYG{n}{left\PYGZus{}start} \PYG{o}{+} \PYG{n}{i} \PYG{o}{*} \PYG{n}{segment\PYGZus{}length}
        \PYG{n}{end\PYGZus{}x} \PYG{o}{=} \PYG{n}{start\PYGZus{}x} \PYG{o}{+} \PYG{n}{segment\PYGZus{}length}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{hlines}\PYG{p}{(}\PYG{p}{[}\PYG{n}{bot}\PYG{p}{,} \PYG{n}{top}\PYG{p}{]}\PYG{p}{,} \PYG{n}{start\PYGZus{}x}\PYG{p}{,} \PYG{n}{end\PYGZus{}x}\PYG{p}{,} \PYG{n}{colors}\PYG{o}{=}\PYG{n}{color}\PYG{p}{,} \PYG{n}{linewidth}\PYG{o}{=}\PYG{n}{lw}\PYG{p}{,} \PYG{n}{transform}\PYG{o}{=}\PYG{n}{crs}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Draw vertical stripes on the left and right}
    \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{num\PYGZus{}segments\PYGZus{}y}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{color} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{if} \PYG{p}{(}\PYG{n}{bot\PYGZus{}start} \PYG{o}{+} \PYG{n}{j} \PYG{o}{*} \PYG{n}{segment\PYGZus{}length}\PYG{p}{)} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{segment\PYGZus{}length}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0} \PYG{k}{else} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{white}\PYG{l+s+s1}{\PYGZsq{}}
        \PYG{n}{start\PYGZus{}y} \PYG{o}{=} \PYG{n}{bot\PYGZus{}start} \PYG{o}{+} \PYG{n}{j} \PYG{o}{*} \PYG{n}{segment\PYGZus{}length}
        \PYG{n}{end\PYGZus{}y} \PYG{o}{=} \PYG{n}{start\PYGZus{}y} \PYG{o}{+} \PYG{n}{segment\PYGZus{}length}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{vlines}\PYG{p}{(}\PYG{p}{[}\PYG{n}{left}\PYG{p}{,} \PYG{n}{right}\PYG{p}{]}\PYG{p}{,} \PYG{n}{start\PYGZus{}y}\PYG{p}{,} \PYG{n}{end\PYGZus{}y}\PYG{p}{,} \PYG{n}{colors}\PYG{o}{=}\PYG{n}{color}\PYG{p}{,} \PYG{n}{linewidth}\PYG{o}{=}\PYG{n}{lw}\PYG{p}{,} \PYG{n}{transform}\PYG{o}{=}\PYG{n}{crs}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set up the map projection}
\PYG{n}{crs} \PYG{o}{=} \PYG{n}{ccrs}\PYG{o}{.}\PYG{n}{PlateCarree}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Set up the figure and axis}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{,} \PYG{n}{subplot\PYGZus{}kw}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{projection}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{crs}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} Set map limits}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{}get min and max longitude and latitude from sla}
\PYG{n}{minlon} \PYG{o}{=} \PYG{n}{sla}\PYG{o}{.}\PYG{n}{longitude}\PYG{o}{.}\PYG{n}{min}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{values}
\PYG{n}{maxlon} \PYG{o}{=} \PYG{n}{sla}\PYG{o}{.}\PYG{n}{longitude}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{values}
\PYG{n}{minlat} \PYG{o}{=} \PYG{n}{sla}\PYG{o}{.}\PYG{n}{latitude}\PYG{o}{.}\PYG{n}{min}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{values}
\PYG{n}{maxlat} \PYG{o}{=} \PYG{n}{sla}\PYG{o}{.}\PYG{n}{latitude}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{values}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{xmin}\PYG{p}{,} \PYG{n}{xmax}\PYG{p}{,} \PYG{n}{ymin}\PYG{p}{,} \PYG{n}{ymax} \PYG{o}{=} \PYG{n}{minlon}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{maxlon}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{minlat}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{maxlat}\PYG{o}{+}\PYG{l+m+mi}{2}

\PYG{k}{if} \PYG{n}{xmin}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{180}\PYG{p}{:}
    \PYG{n}{xmin} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{180}


\PYG{c+c1}{\PYGZsh{}ax.set\PYGZus{}xlim([xmin, xmax])}
\PYG{c+c1}{\PYGZsh{}ax.set\PYGZus{}ylim([ymin, ymax])}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}extent}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{180}\PYG{p}{,} \PYG{n}{xmax}\PYG{p}{,} \PYG{n}{ymin}\PYG{p}{,} \PYG{n}{ymax}\PYG{p}{]}\PYG{p}{,} \PYG{n}{crs}\PYG{o}{=}\PYG{n}{crs}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} add the land and ocean features}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{add\PYGZus{}feature}\PYG{p}{(}\PYG{n}{cfeature}\PYG{o}{.}\PYG{n}{LAND}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{add\PYGZus{}feature}\PYG{p}{(}\PYG{n}{cfeature}\PYG{o}{.}\PYG{n}{OCEAN}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} Add the tide gauge location}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{scatter}\PYG{p}{(}\PYG{n}{rsl}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{rsl}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{marker}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{o}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{transform}\PYG{o}{=}\PYG{n}{crs}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Add the altimetry grid point}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{scatter}\PYG{p}{(}\PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{longitude}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{360}\PYG{p}{,} \PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{latitude}\PYG{p}{,} \PYG{n}{marker}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{o}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} 
        \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{transform}\PYG{o}{=}\PYG{n}{crs}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Create 2D arrays of the longitude and latitude values}
\PYG{c+c1}{\PYGZsh{}lon2d, lat2d = np.meshgrid(ds[\PYGZsq{}sla\PYGZsq{}].longitude, ds[\PYGZsq{}sla\PYGZsq{}].latitude)}

\PYG{c+c1}{\PYGZsh{} plot the latitude and longitude values}
\PYG{c+c1}{\PYGZsh{}ax.scatter(lon2d, lat2d, transform=crs)}

\PYG{c+c1}{\PYGZsh{} Set custom ticks for the zebra frame}
\PYG{n}{degree\PYGZus{}interval} \PYG{o}{=} \PYG{l+m+mf}{2.5}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xticks}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{n}{xmin}\PYG{p}{,}\PYG{n}{xmax}\PYG{p}{,}\PYG{n}{degree\PYGZus{}interval}\PYG{p}{)}\PYG{p}{,} \PYG{n}{crs}\PYG{o}{=}\PYG{n}{crs}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}yticks}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{n}{ymin}\PYG{p}{,}\PYG{n}{ymax}\PYG{p}{,}\PYG{n}{degree\PYGZus{}interval}\PYG{p}{)}\PYG{p}{,} \PYG{n}{crs}\PYG{o}{=}\PYG{n}{crs}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xticklabels}\PYG{p}{(}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}yticklabels}\PYG{p}{(}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Call the function to add the zebra frame}
\PYG{n}{add\PYGZus{}zebra\PYGZus{}frame}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{,} \PYG{n}{lw}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{segment\PYGZus{}length}\PYG{o}{=}\PYG{l+m+mf}{2.5}\PYG{p}{,} \PYG{n}{crs}\PYG{o}{=}\PYG{n}{crs}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} add map grid}
\PYG{n}{gl} \PYG{o}{=} \PYG{n}{ax}\PYG{o}{.}\PYG{n}{gridlines}\PYG{p}{(}\PYG{n}{draw\PYGZus{}labels}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                  \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{,}\PYG{n}{xlocs}\PYG{o}{=}\PYG{n}{ax}\PYG{o}{.}\PYG{n}{get\PYGZus{}xticks}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{n}{ylocs}\PYG{o}{=}\PYG{n}{ax}\PYG{o}{.}\PYG{n}{get\PYGZus{}yticks}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Add the tide gauge location with callout text}
\PYG{c+c1}{\PYGZsh{}tide\PYGZus{}gauge\PYGZus{}label = \PYGZdq{}Tide Gauge\PYGZdq{}}
\PYG{c+c1}{\PYGZsh{}ax.text(rsl[\PYGZsq{}lon\PYGZsq{}]+0.05, rsl[\PYGZsq{}lat\PYGZsq{}]\PYGZhy{}0.05, tide\PYGZus{}gauge\PYGZus{}label, }
\PYG{c+c1}{\PYGZsh{}        transform=crs, ha=\PYGZsq{}left\PYGZsq{},va = \PYGZsq{}top\PYGZsq{}, fontsize=12)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} Add the altimetry grid point with callout text}
\PYG{c+c1}{\PYGZsh{}altimetry\PYGZus{}label = \PYGZdq{}Nearest Altimetry \PYGZbs{}n Grid Point\PYGZdq{}}
\PYG{c+c1}{\PYGZsh{}ax.text(sla\PYGZus{}nearest\PYGZus{}lon, sla\PYGZus{}nearest\PYGZus{}lat+0.05, altimetry\PYGZus{}label, }
\PYG{c+c1}{\PYGZsh{}        transform=crs, ha=\PYGZsq{}center\PYGZsq{}, va = \PYGZsq{}bottom\PYGZsq{}, fontsize=12)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{a0f91dfa1c19e942378028958de7792ab5c9c6fc5853efd52ede096cd6ae5f87}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\chapter{Plot the timeseries}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:plot-the-timeseries}}
\sphinxAtStartPar
Here, we’ll plot the time series of the altimetry data at the nearest location to the tide gauge (aka ‘sla\_tg’). The units of sla\_tg are in meters, so we’ll multiply by 100 to plot in centimeters.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}make a new variable in sla\PYGZus{}tg for cm instead of m}
\PYG{n}{sla\PYGZus{}tg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sla\PYGZus{}cm}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{sla\PYGZus{}tg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sla}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mi}{100}
\PYG{n}{sla\PYGZus{}tg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sla\PYGZus{}cm}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{attrs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{units}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cm}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{sla\PYGZus{}tg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sla\PYGZus{}cm}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{attrs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{long\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sea Level Anomaly}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{}plot the timeseries in sla\PYGZus{}tg}

\PYG{n}{sla\PYGZus{}tg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sla\PYGZus{}cm}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{line}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{station\PYGZus{}name}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}put the legend outside the plot}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{loc}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center left}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{bbox\PYGZus{}to\PYGZus{}anchor}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} set xlimits}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{p}{[}\PYG{n}{start\PYGZus{}date}\PYG{p}{,} \PYG{n}{end\PYGZus{}date}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} set title }
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Altimetry (1993\PYGZhy{}2023)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Text(0.5, 1.0, \PYGZsq{}Altimetry (1993\PYGZhy{}2023)\PYGZsq{})
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{be0683c93aa6562cb789bca758302780ed22df0b2ccaaa3278dbb211dbc8bcbe}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\chapter{Calculate change}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:calculate-change}}
\sphinxAtStartPar
Now we have all of our data sources, we’ll calculate the absolute and relative sea level change (magnitude in cm) at this location for the Period of Record (1993\sphinxhyphen{}2022).

\sphinxAtStartPar
To do this, we’ll first define a function that calculates the sea level change magnitude.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{process\PYGZus{}trend\PYGZus{}with\PYGZus{}nan}\PYG{p}{(}\PYG{n}{sea\PYGZus{}level\PYGZus{}anomaly}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} Flatten the data and get a time index}
    \PYG{c+c1}{\PYGZsh{} first ensure time is the first dimension regardless of other dimensions}
    \PYG{n}{sea\PYGZus{}level\PYGZus{}anomaly} \PYG{o}{=} \PYG{n}{sea\PYGZus{}level\PYGZus{}anomaly}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
    \PYG{n}{sla\PYGZus{}flat} \PYG{o}{=} \PYG{n}{sea\PYGZus{}level\PYGZus{}anomaly}\PYG{o}{.}\PYG{n}{values}\PYG{o}{.}\PYG{n}{reshape}\PYG{p}{(}\PYG{n}{sea\PYGZus{}level\PYGZus{}anomaly}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{time\PYGZus{}index} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{sea\PYGZus{}level\PYGZus{}anomaly}\PYG{o}{.}\PYG{n}{time}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}julian\PYGZus{}date}\PYG{p}{(}\PYG{p}{)}

    \PYG{n}{detrended\PYGZus{}flat} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{full\PYGZus{}like}\PYG{p}{(}\PYG{n}{sla\PYGZus{}flat}\PYG{p}{,} \PYG{n}{fill\PYGZus{}value}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{nan}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Loop over each grid point}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{sla\PYGZus{}flat}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{:}
        \PYG{c+c1}{\PYGZsh{} Get the time series for this grid point}
        \PYG{n}{y} \PYG{o}{=} \PYG{n}{sla\PYGZus{}flat}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}
        \PYG{n}{mask} \PYG{o}{=} \PYG{o}{\PYGZti{}}\PYG{n}{np}\PYG{o}{.}\PYG{n}{isnan}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)}

        \PYG{k}{if} \PYG{n}{np}\PYG{o}{.}\PYG{n}{any}\PYG{p}{(}\PYG{n}{mask}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{time\PYGZus{}masked} \PYG{o}{=} \PYG{n}{time\PYGZus{}index}\PYG{p}{[}\PYG{n}{mask}\PYG{p}{]}
            \PYG{n}{y\PYGZus{}masked} \PYG{o}{=} \PYG{n}{y}\PYG{p}{[}\PYG{n}{mask}\PYG{p}{]}

            \PYG{n}{slope}\PYG{p}{,} \PYG{n}{intercept}\PYG{p}{,} \PYG{n}{\PYGZus{}}\PYG{p}{,} \PYG{n}{\PYGZus{}}\PYG{p}{,} \PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{stats}\PYG{o}{.}\PYG{n}{linregress}\PYG{p}{(}\PYG{n}{time\PYGZus{}masked}\PYG{p}{,} \PYG{n}{y\PYGZus{}masked}\PYG{p}{)}
            \PYG{n}{trend} \PYG{o}{=} \PYG{n}{slope} \PYG{o}{*} \PYG{n}{time\PYGZus{}index} \PYG{o}{+} \PYG{n}{intercept}

            \PYG{n}{detrended\PYGZus{}flat}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{trend}

    \PYG{n}{detrended} \PYG{o}{=} \PYG{n}{detrended\PYGZus{}flat}\PYG{o}{.}\PYG{n}{reshape}\PYG{p}{(}\PYG{n}{sea\PYGZus{}level\PYGZus{}anomaly}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Calculate trend magnitude}
    \PYG{n}{sea\PYGZus{}level\PYGZus{}trend} \PYG{o}{=} \PYG{n}{sea\PYGZus{}level\PYGZus{}anomaly} \PYG{o}{\PYGZhy{}} \PYG{n}{detrended}
    \PYG{n}{trend\PYGZus{}mag} \PYG{o}{=} \PYG{n}{sea\PYGZus{}level\PYGZus{}trend}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{sea\PYGZus{}level\PYGZus{}trend}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}

    \PYG{n}{times} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{sea\PYGZus{}level\PYGZus{}anomaly}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}
    \PYG{n}{time\PYGZus{}mag} \PYG{o}{=} \PYG{p}{(}\PYG{n}{times}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{times}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{days}\PYG{o}{/}\PYG{l+m+mf}{365.25} \PYG{c+c1}{\PYGZsh{} in years}

    \PYG{n}{trend\PYGZus{}rate} \PYG{o}{=} \PYG{n}{trend\PYGZus{}mag} \PYG{o}{/} \PYG{n}{time\PYGZus{}mag}

    \PYG{k}{return} \PYG{n}{trend\PYGZus{}mag}\PYG{p}{,} \PYG{n}{sea\PYGZus{}level\PYGZus{}trend}\PYG{p}{,} \PYG{n}{trend\PYGZus{}rate}  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
Now we’ll run that function for every grid point in our dataset, and make special variables for our proxy tide gauge location.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{trend\PYGZus{}mag\PYGZus{}cmems}\PYG{p}{,} \PYG{n}{trend\PYGZus{}line\PYGZus{}cmems}\PYG{p}{,} \PYG{n}{trend\PYGZus{}rate\PYGZus{}cmems} \PYG{o}{=} \PYG{n}{process\PYGZus{}trend\PYGZus{}with\PYGZus{}nan}\PYG{p}{(}\PYG{n}{sla}\PYG{o}{.}\PYG{n}{sla}\PYG{p}{)}
\PYG{n}{trend\PYGZus{}mag\PYGZus{}asl}\PYG{p}{,} \PYG{n}{trend\PYGZus{}line\PYGZus{}asl}\PYG{p}{,} \PYG{n}{trend\PYGZus{}rate\PYGZus{}asl} \PYG{o}{=} \PYG{n}{process\PYGZus{}trend\PYGZus{}with\PYGZus{}nan}\PYG{p}{(}\PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{sla}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
Calculate the weighted mean for the region of interest.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} calculate the area weights as cosine of latitude}
\PYG{c+c1}{\PYGZsh{} For a rectangular grid, this is equivalent to multiplying by the grid cell area}
\PYG{n}{weights} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{deg2rad}\PYG{p}{(}\PYG{n}{sla}\PYG{o}{.}\PYG{n}{latitude}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{weights}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{weights}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} apply weights to the trend data}
\PYG{n}{trend\PYGZus{}mag\PYGZus{}weighted} \PYG{o}{=} \PYG{n}{trend\PYGZus{}mag\PYGZus{}cmems}\PYG{o}{.}\PYG{n}{weighted}\PYG{p}{(}\PYG{n}{weights}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} calculate the regional mean}
\PYG{n}{trend\PYGZus{}mag\PYGZus{}regional} \PYG{o}{=} \PYG{n}{trend\PYGZus{}mag\PYGZus{}weighted}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{latitude}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{longitude}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} prepare the output string}
\PYG{n}{output} \PYG{o}{=} \PYG{p}{(}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The regional magnitude of sea level change is }\PYG{l+s+si}{\PYGZob{}:.2f\PYGZcb{}}\PYG{l+s+s1}{ cm for the time }\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{period bounded by }\PYG{l+s+si}{\PYGZob{}\PYGZcb{}}\PYG{l+s+s1}{ and }\PYG{l+s+si}{\PYGZob{}\PYGZcb{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{p}{)}\PYG{o}{.}\PYG{n}{format}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{trend\PYGZus{}mag\PYGZus{}regional}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,} \PYG{n}{start\PYGZus{}date\PYGZus{}str}\PYG{p}{,} \PYG{n}{end\PYGZus{}date\PYGZus{}str}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{output}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
The regional magnitude of sea level change is 7.39 cm for the time period bounded by 1993\PYGZhy{}01\PYGZhy{}01 and 2022\PYGZhy{}12\PYGZhy{}31.
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\chapter{Plot a map}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:plot-a-map}}
\sphinxAtStartPar
Plot the Results – MAP

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{xlims} \PYG{o}{=} \PYG{p}{[}\PYG{n}{minlon}\PYG{p}{,} \PYG{n}{maxlon}\PYG{p}{]}
\PYG{n}{ylims} \PYG{o}{=} \PYG{p}{[}\PYG{n}{minlat}\PYG{p}{,}\PYG{n}{maxlat}\PYG{p}{]}
\PYG{n}{vmin}\PYG{p}{,} \PYG{n}{vmax} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{15}\PYG{p}{,} \PYG{l+m+mi}{15}
\PYG{n}{cmap} \PYG{o}{=} \PYG{n}{sns}\PYG{o}{.}\PYG{n}{palettes}\PYG{o}{.}\PYG{n}{color\PYGZus{}palette}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RdBu\PYGZus{}r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{as\PYGZus{}cmap}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax}\PYG{p}{,} \PYG{n}{crs} \PYG{o}{=} \PYG{n}{plot\PYGZus{}map}\PYG{p}{(}\PYG{n}{vmin}\PYG{p}{,}\PYG{n}{vmax}\PYG{p}{,}\PYG{n}{cmap}\PYG{p}{,}\PYG{n}{xlims}\PYG{p}{,}\PYG{n}{ylims}\PYG{p}{)}







\PYG{c+c1}{\PYGZsh{} plot the trend*100 for centimeters}
\PYG{n}{trend\PYGZus{}mag\PYGZus{}cmems\PYGZus{}cm} \PYG{o}{=} \PYG{n}{trend\PYGZus{}mag\PYGZus{}cmems} \PYG{o}{*} \PYG{l+m+mi}{100}

\PYG{c+c1}{\PYGZsh{} plot a map of the magnitude of SL change in centimeters}
\PYG{n}{trend\PYGZus{}mag\PYGZus{}cmems\PYGZus{}cm}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{ax}\PYG{o}{=}\PYG{n}{ax}\PYG{p}{,} \PYG{n}{transform}\PYG{o}{=}\PYG{n}{crs}\PYG{p}{,}
                         \PYG{n}{vmin}\PYG{o}{=}\PYG{n}{vmin}\PYG{p}{,} \PYG{n}{vmax}\PYG{o}{=}\PYG{n}{vmax}\PYG{p}{,} \PYG{n}{cmap}\PYG{o}{=}\PYG{n}{cmap}\PYG{p}{,} \PYG{n}{add\PYGZus{}colorbar}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} 
                         \PYG{n}{cbar\PYGZus{}kwargs}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{label}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Δ Sea Level (cm, 1993\PYGZhy{}2022)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Call the function to add the zebra frame}
\PYG{n}{plot\PYGZus{}zebra\PYGZus{}frame}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{,} \PYG{n}{lw}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{segment\PYGZus{}length}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{crs}\PYG{o}{=}\PYG{n}{crs}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{8acaddd6c06e7efb4c05929b62b005a12970f11d9a46dabf6e0b1abc9ed19806}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\chapter{Plot time series}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:plot-time-series}}\label{\detokenize{notebooks/regional_and_local/SL_Trend:asltimeseries}}
\sphinxAtStartPar
Now we’ll plot a time series that includes a trend line, the Absolute Sea Level Change (magnitude in cm) within area/s in proximity to the Tide Station/s. For now, we’ll plot only one station at a time. The possible list of stations are:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}make a dataframe with station\PYGZus{}name and record\PYGZus{}id}
\PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{station\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{station\PYGZus{}name}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{record\PYGZus{}id}\PYG{o}{.}\PYG{n}{values}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n}{df}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
         station\PYGZus{}name  record\PYGZus{}id
0      French Frigate        140
1              Midway        500
2            Johnston        520
3    Honolulu, Hawaii        570
4          Nawiliwili        580
5             Kahului        590
6        Hilo, Hawaii        600
7            Mokuoloe        610
8   Barbers Point, HI       5470
9      Kaumalapau, HI       5480
10           Kawaihae       5520
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
Select which station you’d like to plot here:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} EDIT THIS CELL}
\PYG{n}{recordID} \PYG{o}{=} \PYG{l+m+mi}{3}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set the style of the plot}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{set\PYGZus{}style}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{whitegrid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Create a color palette}
\PYG{n}{palette} \PYG{o}{=} \PYG{n}{sns}\PYG{o}{.}\PYG{n}{color\PYGZus{}palette}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Set1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Plot the timeseries}
\PYG{c+c1}{\PYGZsh{} Create the figure and the axes}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} plot altimetry data from sla\PYGZus{}tg, using the first record\PYGZus{}id}


\PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{sla}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id} \PYG{o}{=} \PYG{n}{recordID}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{scatter}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Altimetry}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{palette}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{n}{s}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{trend\PYGZus{}line\PYGZus{}asl}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id} \PYG{o}{=} \PYG{n}{recordID}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{line}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Altimetry Trend}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{palette}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}


\PYG{c+c1}{\PYGZsh{} Set the title and labels}
\PYG{n}{title} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Altimetry at }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{sla\PYGZus{}tg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{station\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{recordID}\PYG{p}{)}\PYG{o}{.}\PYG{n}{values}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ (}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{start\PYGZus{}date\PYGZus{}str}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ to }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{end\PYGZus{}date\PYGZus{}str}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{n}{title}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Year}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Height (cm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Set the x limits}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{p}{[}\PYG{n}{start\PYGZus{}date}\PYG{p}{,} \PYG{n}{end\PYGZus{}date}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Add a legend}
\PYG{n}{trendmag\PYGZus{}str} \PYG{o}{=} \PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Δ Sea Level: }\PYG{l+s+si}{\PYGZob{}}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{trend\PYGZus{}mag\PYGZus{}asl}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{recordID}\PYG{p}{)}\PYG{l+s+si}{:}\PYG{l+s+s1}{.2f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ cm, }\PYG{l+s+s1}{\PYGZsq{}}
                \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Trend: }\PYG{l+s+si}{\PYGZob{}}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{trend\PYGZus{}rate\PYGZus{}asl}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{recordID}\PYG{p}{)}\PYG{l+s+si}{:}\PYG{l+s+s1}{.2f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ cm/year}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Add text in a white box to bottom right of plot}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mf}{0.95}\PYG{p}{,} \PYG{l+m+mf}{0.05}\PYG{p}{,} \PYG{n}{trendmag\PYGZus{}str}\PYG{p}{,} \PYG{n}{transform}\PYG{o}{=}\PYG{n}{ax}\PYG{o}{.}\PYG{n}{transAxes}\PYG{p}{,} 
        \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bottom}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} 
        \PYG{n}{bbox}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{facecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{white}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Text(0.95, 0.05, \PYGZsq{}Δ Sea Level: 6.38 cm, Trend: 0.21 cm/year\PYGZsq{})
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{f068f52af7bbd3b6ad57d85e2af38bf77034e6e07315be8cce7cd34175abe04e}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\chapter{Calculate rate and magnitude of change}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:calculate-rate-and-magnitude-of-change}}
\sphinxAtStartPar
Calculate values for both the Trend (rate of change) and Magnitude of Change

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{rsl\PYGZus{}daily}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}xarray.Dataset\PYGZgt{} Size: 2MB
Dimensions:       (record\PYGZus{}id: 11, time: 10957)
Coordinates:
  * record\PYGZus{}id     (record\PYGZus{}id) int16 22B 140 500 520 570 ... 610 5470 5480 5520
  * time          (time) datetime64[ns] 88kB 1993\PYGZhy{}01\PYGZhy{}01 ... 2022\PYGZhy{}12\PYGZhy{}31
    lat           (record\PYGZus{}id) float32 44B ...
    lon           (record\PYGZus{}id) float32 44B ...
    station\PYGZus{}name  (record\PYGZus{}id) \PYGZlt{}U17 748B ...
    storm\PYGZus{}time    (time) datetime64[ns] 88kB ...
Data variables:
    rsl\PYGZus{}anomaly   (record\PYGZus{}id, time) float32 482kB ...
    rsl\PYGZus{}mhhw      (record\PYGZus{}id, time) float64 964kB ...
Attributes:
    long\PYGZus{}name:  Sea Level Anomaly
    units:      m
    source:     in situ tide gauge water level observations
    platform:   station\PYGZus{}name, station\PYGZus{}country, station\PYGZus{}country\PYGZus{}code, uhslc\PYGZus{}id...
    epoch:      1993\PYGZhy{}2001
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} calculate the rate of change for the tide gauge}
\PYG{n}{trend\PYGZus{}mag\PYGZus{}rsl}\PYG{p}{,} \PYG{n}{trend\PYGZus{}line\PYGZus{}rsl}\PYG{p}{,} \PYG{n}{trend\PYGZus{}rate\PYGZus{}rsl} \PYG{o}{=} \PYG{n}{process\PYGZus{}trend\PYGZus{}with\PYGZus{}nan}\PYG{p}{(}\PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{rsl\PYGZus{}anomaly}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The trend magnitude for the tide gauge is }\PYG{l+s+si}{\PYGZob{}}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{trend\PYGZus{}mag\PYGZus{}rsl}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{recordID}\PYG{p}{)}\PYG{l+s+si}{:}\PYG{l+s+s1}{.2f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ cm.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The trend rate for the tide gauge is }\PYG{l+s+si}{\PYGZob{}}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{trend\PYGZus{}rate\PYGZus{}rsl}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{recordID}\PYG{p}{)}\PYG{l+s+si}{:}\PYG{l+s+s1}{.2f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ cm/year.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
The trend magnitude for the tide gauge is 8.09 cm.
The trend rate for the tide gauge is 0.27 cm/year.
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\chapter{Plot time series}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:rsltimeseries}}\label{\detokenize{notebooks/regional_and_local/SL_Trend:id2}}
\sphinxAtStartPar
Now we’ll combine our daily relative sea level time series, the monthly mean, and a trend line into the same plot. We will label it with the Relative Sea Level Sea Level Change (magnitude in cm) and rate of change (cm/yr) at the Tide Station. The “zero” line is referenced to the {[}1993,2012{]} period, following the altimetry.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} make an rsl monthly mean for plotting}
\PYG{n}{rsl\PYGZus{}monthly} \PYG{o}{=} \PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{resample}\PYG{p}{(}\PYG{n}{time}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{squeeze}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Set the style of the plot}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{set\PYGZus{}style}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{whitegrid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Create a color palette}
\PYG{n}{palette} \PYG{o}{=} \PYG{n}{sns}\PYG{o}{.}\PYG{n}{color\PYGZus{}palette}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Set1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Plot the timeseries}
\PYG{c+c1}{\PYGZsh{} Create the figure and the axes}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} plot data}

\PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{rsl\PYGZus{}anomaly}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{recordID}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{scatter}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tide Gauge}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{palette}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{n}{s}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{trend\PYGZus{}line\PYGZus{}rsl}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{recordID}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{line}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tide Gauge Trend}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{palette}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} plot the monthly mean sea level}
\PYG{n}{rsl\PYGZus{}monthly}\PYG{o}{.}\PYG{n}{rsl\PYGZus{}anomaly}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{recordID}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{line}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tide Gauge}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{palette}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{)}


\PYG{c+c1}{\PYGZsh{} Set the title and labels}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tide Gauge (}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{station\PYGZus{}name}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{recordID}\PYG{p}{)}\PYG{o}{.}\PYG{n}{values}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{) (}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{start\PYGZus{}date\PYGZus{}str}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ to }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{end\PYGZus{}date\PYGZus{}str}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Year}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Height (m)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Set the y limits}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylim}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{.50}\PYG{p}{,} \PYG{l+m+mf}{.50}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Set the x limits}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{p}{[}\PYG{n}{start\PYGZus{}date}\PYG{p}{,} \PYG{n}{end\PYGZus{}date}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Add a legend}
\PYG{n}{trendmag\PYGZus{}str} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Δ Sea Level: }\PYG{l+s+si}{\PYGZob{}}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{trend\PYGZus{}mag\PYGZus{}rsl}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{recordID}\PYG{p}{)}\PYG{l+s+si}{:}\PYG{l+s+s1}{.2f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ cm, Trend: }\PYG{l+s+si}{\PYGZob{}}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{trend\PYGZus{}rate\PYGZus{}rsl}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{recordID}\PYG{p}{)}\PYG{l+s+si}{:}\PYG{l+s+s1}{.2f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ cm/year}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Add text in a white box to bottom right of plot}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mf}{0.95}\PYG{p}{,} \PYG{l+m+mf}{0.05}\PYG{p}{,} \PYG{n}{trendmag\PYGZus{}str}\PYG{p}{,} \PYG{n}{transform}\PYG{o}{=}\PYG{n}{ax}\PYG{o}{.}\PYG{n}{transAxes}\PYG{p}{,} 
        \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bottom}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{n}{bbox}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{facecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{white}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/opt/anaconda3/envs/SLI39/lib/python3.9/site\PYGZhy{}packages/xarray/core/groupby.py:668: FutureWarning: \PYGZsq{}M\PYGZsq{} is deprecated and will be removed in a future version, please use \PYGZsq{}ME\PYGZsq{} instead.
  index\PYGZus{}grouper = pd.Grouper(
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Text(0.95, 0.05, \PYGZsq{}Δ Sea Level: 8.09 cm, Trend: 0.27 cm/year\PYGZsq{})
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{5528aff7678aa34cf0d83a6e5ff5c4f07ab83d727c21f5b56c1696c4611d69f6}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\part{Combining both sources}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:combining-both-sources}}

\chapter{Create a Table}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:create-a-table}}\label{\detokenize{notebooks/regional_and_local/SL_Trend:id3}}
\sphinxAtStartPar
That compares the results of sections \hyperref[\detokenize{notebooks/regional_and_local/SL_Trend:asltimeseries}]{Section \ref{\detokenize{notebooks/regional_and_local/SL_Trend:asltimeseries}}} and \hyperref[\detokenize{notebooks/regional_and_local/SL_Trend:rsltimeseries}]{Section \ref{\detokenize{notebooks/regional_and_local/SL_Trend:rsltimeseries}}}– TABLE

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Constants}
\PYG{n}{DATA\PYGZus{}SOURCE\PYGZus{}ALTIMETRY} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CMEMS SSH L4 0.25 deg (SLA)}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{DATA\PYGZus{}SOURCE\PYGZus{}TIDE\PYGZus{}GAUGE} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{UHSLC RQDS}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{TIME\PYGZus{}PERIOD} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{start\PYGZus{}date\PYGZus{}str}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ to }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{end\PYGZus{}date\PYGZus{}str}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} Calculated values }
\PYG{n}{trend\PYGZus{}mmyr\PYGZus{}altimetry} \PYG{o}{=} \PYG{l+m+mi}{1000} \PYG{o}{*} \PYG{n}{trend\PYGZus{}rate\PYGZus{}asl}\PYG{o}{.}\PYG{n}{values}
\PYG{n}{trend\PYGZus{}mmyr\PYGZus{}tide\PYGZus{}gauge} \PYG{o}{=} \PYG{l+m+mi}{1000} \PYG{o}{*} \PYG{n}{trend\PYGZus{}rate\PYGZus{}rsl}\PYG{o}{.}\PYG{n}{values}
\PYG{n}{delta\PYGZus{}sea\PYGZus{}level\PYGZus{}altimetry} \PYG{o}{=} \PYG{l+m+mi}{100} \PYG{o}{*} \PYG{n}{trend\PYGZus{}mag\PYGZus{}asl}\PYG{o}{.}\PYG{n}{values}
\PYG{n}{delta\PYGZus{}sea\PYGZus{}level\PYGZus{}tide\PYGZus{}gauge} \PYG{o}{=} \PYG{l+m+mi}{100} \PYG{o}{*} \PYG{n}{trend\PYGZus{}mag\PYGZus{}rsl}\PYG{o}{.}\PYG{n}{values}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Initialize DataFrame with station names and calculate UHSLC\PYGZus{}ID directly}
\PYG{n}{SL\PYGZus{}magnitude\PYGZus{}results} \PYG{o}{=} \PYG{p}{(}
    \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{\PYGZob{}}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Station\PYGZus{}Name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{station\PYGZus{}name}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{UHSLC\PYGZus{}ID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{int16}\PYG{p}{(}\PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{record\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values} \PYG{o}{/} \PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Trend ASL (mm/yr)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{trend\PYGZus{}mmyr\PYGZus{}altimetry}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Trend RSL (mm/yr)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{trend\PYGZus{}mmyr\PYGZus{}tide\PYGZus{}gauge}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Δ Sea Level ASL (cm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{delta\PYGZus{}sea\PYGZus{}level\PYGZus{}altimetry}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Δ Sea Level RSL (cm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{delta\PYGZus{}sea\PYGZus{}level\PYGZus{}tide\PYGZus{}gauge}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Latitude ASL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{sla\PYGZus{}tg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{latitude}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Latitude RSL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Longitude ASL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{sla\PYGZus{}tg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{longitude}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Longitude RSL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{rsl\PYGZus{}daily}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Time\PYGZus{}Period}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{TIME\PYGZus{}PERIOD}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Data\PYGZus{}Source ASL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{DATA\PYGZus{}SOURCE\PYGZus{}ALTIMETRY}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Data\PYGZus{}Source RSL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{DATA\PYGZus{}SOURCE\PYGZus{}TIDE\PYGZus{}GAUGE}
    \PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} if Longitude is greater than 180, subtract 360}
\PYG{n}{SL\PYGZus{}magnitude\PYGZus{}results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Longitude ASL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{where}\PYG{p}{(}\PYG{n}{SL\PYGZus{}magnitude\PYGZus{}results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Longitude ASL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{180}\PYG{p}{,} \PYG{n}{SL\PYGZus{}magnitude\PYGZus{}results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Longitude ASL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{360}\PYG{p}{,} \PYG{n}{SL\PYGZus{}magnitude\PYGZus{}results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Longitude ASL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{SL\PYGZus{}magnitude\PYGZus{}results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Longitude RSL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{where}\PYG{p}{(}\PYG{n}{SL\PYGZus{}magnitude\PYGZus{}results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Longitude RSL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{180}\PYG{p}{,} \PYG{n}{SL\PYGZus{}magnitude\PYGZus{}results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Longitude RSL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{360}\PYG{p}{,} \PYG{n}{SL\PYGZus{}magnitude\PYGZus{}results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Longitude RSL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{SL\PYGZus{}magnitude\PYGZus{}results}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
         Station\PYGZus{}Name  UHSLC\PYGZus{}ID  Trend ASL (mm/yr)  Trend RSL (mm/yr)  \PYGZbs{}
0      French Frigate        14           1.871329                NaN   
1              Midway        50           4.215143           3.780650   
2            Johnston        52           2.292586           1.802460   
3    Honolulu, Hawaii        57           2.103058           2.696540   
4          Nawiliwili        58           2.263410           3.062466   
5             Kahului        59           2.105416           2.527900   
6        Hilo, Hawaii        60           1.975387           3.298495   
7            Mokuoloe        61           2.103058           2.933727   
8   Barbers Point, HI       547           2.228920                NaN   
9      Kaumalapau, HI       548           2.183053                NaN   
10           Kawaihae       552           2.750707                NaN   

    Δ Sea Level ASL (cm)  Δ Sea Level RSL (cm)  Latitude ASL  Latitude RSL  \PYGZbs{}
0               5.674700                   NaN        23.875     23.867001   
1              12.782183             11.340399        28.125     28.216999   
2               6.952137              5.406640        16.875     16.750000   
3               6.377406              8.088512        21.375     21.306999   
4               6.863662              9.186140        21.875     21.966999   
5               6.384556              7.582662        20.875     20.900000   
6               5.990249              9.894130        19.733     19.733000   
7               6.377406              8.799976        21.375     21.433001   
8               6.759073                   NaN        21.375     21.322001   
9               6.619986                   NaN        20.875     20.783001   
10              8.341365                   NaN        20.125     20.033001   

    Longitude ASL  Longitude RSL               Time\PYGZus{}Period  \PYGZbs{}
0     \PYGZhy{}166.375000    \PYGZhy{}166.289993  1993\PYGZhy{}01\PYGZhy{}01 to 2022\PYGZhy{}12\PYGZhy{}31   
1     \PYGZhy{}177.375000    \PYGZhy{}177.367004  1993\PYGZhy{}01\PYGZhy{}01 to 2022\PYGZhy{}12\PYGZhy{}31   
2     \PYGZhy{}169.625000    \PYGZhy{}169.516998  1993\PYGZhy{}01\PYGZhy{}01 to 2022\PYGZhy{}12\PYGZhy{}31   
3     \PYGZhy{}157.875000    \PYGZhy{}157.867004  1993\PYGZhy{}01\PYGZhy{}01 to 2022\PYGZhy{}12\PYGZhy{}31   
4     \PYGZhy{}159.375000    \PYGZhy{}159.350006  1993\PYGZhy{}01\PYGZhy{}01 to 2022\PYGZhy{}12\PYGZhy{}31   
5     \PYGZhy{}156.375000    \PYGZhy{}156.466995  1993\PYGZhy{}01\PYGZhy{}01 to 2022\PYGZhy{}12\PYGZhy{}31   
6     \PYGZhy{}155.067001    \PYGZhy{}155.067001  1993\PYGZhy{}01\PYGZhy{}01 to 2022\PYGZhy{}12\PYGZhy{}31   
7     \PYGZhy{}157.875000    \PYGZhy{}157.800003  1993\PYGZhy{}01\PYGZhy{}01 to 2022\PYGZhy{}12\PYGZhy{}31   
8     \PYGZhy{}158.125000    \PYGZhy{}158.119995  1993\PYGZhy{}01\PYGZhy{}01 to 2022\PYGZhy{}12\PYGZhy{}31   
9     \PYGZhy{}156.875000    \PYGZhy{}157.000000  1993\PYGZhy{}01\PYGZhy{}01 to 2022\PYGZhy{}12\PYGZhy{}31   
10    \PYGZhy{}155.875000    \PYGZhy{}155.832993  1993\PYGZhy{}01\PYGZhy{}01 to 2022\PYGZhy{}12\PYGZhy{}31   

                Data\PYGZus{}Source ASL Data\PYGZus{}Source RSL  
0   CMEMS SSH L4 0.25 deg (SLA)      UHSLC RQDS  
1   CMEMS SSH L4 0.25 deg (SLA)      UHSLC RQDS  
2   CMEMS SSH L4 0.25 deg (SLA)      UHSLC RQDS  
3   CMEMS SSH L4 0.25 deg (SLA)      UHSLC RQDS  
4   CMEMS SSH L4 0.25 deg (SLA)      UHSLC RQDS  
5   CMEMS SSH L4 0.25 deg (SLA)      UHSLC RQDS  
6   CMEMS SSH L4 0.25 deg (SLA)      UHSLC RQDS  
7   CMEMS SSH L4 0.25 deg (SLA)      UHSLC RQDS  
8   CMEMS SSH L4 0.25 deg (SLA)      UHSLC RQDS  
9   CMEMS SSH L4 0.25 deg (SLA)      UHSLC RQDS  
10  CMEMS SSH L4 0.25 deg (SLA)      UHSLC RQDS  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Save to CSV}
\PYG{n}{output\PYGZus{}file\PYGZus{}path} \PYG{o}{=} \PYG{n}{output\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SL\PYGZus{}magnitude\PYGZus{}results.csv}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} Use the path for operations, e.g., saving a DataFrame}
\PYG{n}{SL\PYGZus{}magnitude\PYGZus{}results}\PYG{o}{.}\PYG{n}{to\PYGZus{}csv}\PYG{p}{(}\PYG{n}{output\PYGZus{}file\PYGZus{}path}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} glue trend\PYGZus{}rates to the notebook}
\PYG{n}{glue}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{trend\PYGZus{}rate\PYGZus{}rsl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{trend\PYGZus{}rate\PYGZus{}rsl}\PYG{p}{,} \PYG{n}{display}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{glue}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{trend\PYGZus{}rate\PYGZus{}asl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{trend\PYGZus{}rate\PYGZus{}asl}\PYG{p}{,} \PYG{n}{display}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\chapter{Create a Map}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:create-a-map}}\label{\detokenize{notebooks/regional_and_local/SL_Trend:id4}}
\sphinxAtStartPar
Now we’ll combine a both the tide gauge and altimetry sources into a map that includes the absolute change with the addition of an icon depicting the magnitude of relative change at the tide station.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-output}
\begin{sphinxuseclass}{tag_hide-input}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{e37b9d70b5833c663c670c5647c87c24386d639a8737aa6510af2d68a055c14d}.png}
\caption{Map of absolute and relative sea level change from the altimetry and tide gauge record near the \DUrole{pasted-text}{Hawaiian Islands} stations from \DUrole{pasted-text}{1993\sphinxhyphen{}01\sphinxhyphen{}01} to \DUrole{pasted-text}{2022\sphinxhyphen{}12\sphinxhyphen{}31}.}\label{\detokenize{notebooks/regional_and_local/SL_Trend:fig-mag}}
\begin{sphinxlegend}
\sphinxAtStartPar
\DUrole{xref,download,myst}{Download Image}
\end{sphinxlegend}
\end{figure}


\chapter{Create a Time series plot}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:create-a-time-series-plot}}\label{\detokenize{notebooks/regional_and_local/SL_Trend:id5}}
\sphinxAtStartPar
Finally we will combine both tide gauge and altimetry sources into a time series plot that includes both {\hyperref[\detokenize{notebooks/regional_and_local/SL_Trend:asltimeseries}]{\sphinxcrossref{\DUrole{std,std-ref}{Absolute}}}}  and {\hyperref[\detokenize{notebooks/regional_and_local/SL_Trend:rsltimeseries}]{\sphinxcrossref{\DUrole{std,std-ref}{Relative}}}} Time Series.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-output}
\begin{sphinxuseclass}{tag_hide-input}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{d1dbe8b3cf3f29a861cc60f4f74f5f1d29433ac295db83015b73413c07f2ab26}.png}
\caption{Absolute sea level trend (red) from altimetry, and relative sea level trend (blue) from the tide gauge record at the \DUrole{pasted-text}{Midway} tide gauge station from \DUrole{pasted-text}{1993\sphinxhyphen{}01\sphinxhyphen{}01} to \DUrole{pasted-text}{2022\sphinxhyphen{}12\sphinxhyphen{}31}.}\label{\detokenize{notebooks/regional_and_local/SL_Trend:trend-fig-station}}\end{figure}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-output}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set the style of the plot}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{set\PYGZus{}style}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{whitegrid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Create a color palette}
\PYG{n}{palette} \PYG{o}{=} \PYG{n}{sns}\PYG{o}{.}\PYG{n}{color\PYGZus{}palette}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Set1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}



\PYG{c+c1}{\PYGZsh{} find the record\PYGZus{}ids that do not have nan trend\PYGZus{}mag\PYGZus{}rsl}
\PYG{n}{record\PYGZus{}ids} \PYG{o}{=} \PYG{n}{trend\PYGZus{}mag\PYGZus{}rsl}\PYG{o}{.}\PYG{n}{record\PYGZus{}id}\PYG{o}{.}\PYG{n}{values}

\PYG{n}{fig}\PYG{p}{,}\PYG{n}{axes} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{,} \PYG{n}{sharex}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{sharey}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{n}{axes} \PYG{o}{=} \PYG{n}{axes}\PYG{o}{.}\PYG{n}{flatten}\PYG{p}{(}\PYG{p}{)}

\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{record\PYGZus{}ids}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{ax} \PYG{o}{=} \PYG{n}{axes}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
    \PYG{c+c1}{\PYGZsh{} plot altimetry data}
    \PYG{n}{sla\PYGZus{}tg}\PYG{o}{.}\PYG{n}{sla}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{record\PYGZus{}ids}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{scatter}\PYG{p}{(}\PYG{n}{ax} \PYG{o}{=} \PYG{n}{ax}\PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Altimetry}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{palette}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{n}{s}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}
    \PYG{n}{trend\PYGZus{}line\PYGZus{}asl}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{record\PYGZus{}ids}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{line}\PYG{p}{(}\PYG{n}{ax} \PYG{o}{=} \PYG{n}{ax}\PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Altimetry Trend}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{palette}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{rsl\PYGZus{}anomaly}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{record\PYGZus{}ids}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{scatter}\PYG{p}{(}\PYG{n}{ax} \PYG{o}{=} \PYG{n}{ax}\PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tide Gauge}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{palette}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{n}{s}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}
    \PYG{n}{trend\PYGZus{}line\PYGZus{}rsl}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{record\PYGZus{}ids}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{line}\PYG{p}{(}\PYG{n}{ax} \PYG{o}{=} \PYG{n}{ax}\PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tide Gauge Trend}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{palette}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{title} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{rsl\PYGZus{}daily}\PYG{o}{.}\PYG{n}{station\PYGZus{}name}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{record\PYGZus{}ids}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{values}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{n}{title}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Height (m)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{i} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{2} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Height (m)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{10}\PYG{p}{:}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{n}{x\PYGZus{}pos} \PYG{o}{=} \PYG{l+m+mf}{0.5}
    \PYG{n}{y\PYGZus{}pos} \PYG{o}{=} \PYG{l+m+mf}{0.05}
    \PYG{n}{spacing} \PYG{o}{=} \PYG{l+m+mf}{0.25}  \PYG{c+c1}{\PYGZsh{} Adjust this value as needed for proper spacing}

    \PYG{c+c1}{\PYGZsh{} Create the first part of the text in red}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{x\PYGZus{}pos}\PYG{p}{,} \PYG{n}{y\PYGZus{}pos}\PYG{p}{,} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{trend\PYGZus{}rate\PYGZus{}asl}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{record\PYGZus{}ids}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{l+s+si}{:}\PYG{l+s+s1}{.2f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ cm/yr}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{palette}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}
            \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bottom}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{transform}\PYG{o}{=}\PYG{n}{ax}\PYG{o}{.}\PYG{n}{transAxes}\PYG{p}{,}
            \PYG{n}{bbox}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{facecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{white}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Create the second part of the text in blue, separated by a fixed amount}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{x\PYGZus{}pos} \PYG{o}{+} \PYG{n}{spacing}\PYG{p}{,} \PYG{n}{y\PYGZus{}pos}\PYG{p}{,} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{trend\PYGZus{}rate\PYGZus{}rsl}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{record\PYGZus{}id}\PYG{o}{=}\PYG{n}{record\PYGZus{}ids}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{l+s+si}{:}\PYG{l+s+s1}{.2f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ cm/yr}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{palette}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}
            \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bottom}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{transform}\PYG{o}{=}\PYG{n}{ax}\PYG{o}{.}\PYG{n}{transAxes}\PYG{p}{,}
            \PYG{n}{bbox}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{facecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{white}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}\PYG{p}{)}
    


\PYG{c+c1}{\PYGZsh{} Set the y and x limits}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylim}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{.40}\PYG{p}{,} \PYG{l+m+mf}{.40}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{p}{[}\PYG{n}{start\PYGZus{}date}\PYG{p}{,} \PYG{n}{end\PYGZus{}date}\PYG{p}{]}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} Adjust overall figure aesthetics}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Altimetry and Tide Gauge Data Across Locations}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{tight\PYGZus{}layout}\PYG{p}{(}\PYG{n}{rect}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mf}{0.03}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mf}{0.95}\PYG{p}{]}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} Adjust layout to make room for the main title}
\PYG{c+c1}{\PYGZsh{} Add a legend in the last subplot}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{loc}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center left}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{bbox\PYGZus{}to\PYGZus{}anchor}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mf}{1.1}\PYG{p}{,} \PYG{l+m+mf}{0.75}\PYG{p}{)}\PYG{p}{,}\PYG{n}{ncol} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} remove the last subplot}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{delaxes}\PYG{p}{(}\PYG{n}{axes}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}


\PYG{n}{glue}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{trend\PYGZus{}fig}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fig}\PYG{p}{,} \PYG{n}{display}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} save the figure}
\PYG{n}{output\PYGZus{}file\PYGZus{}path} \PYG{o}{=} \PYG{n}{output\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SL\PYGZus{}magnitude\PYGZus{}timeseries.png}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{output\PYGZus{}file\PYGZus{}path}\PYG{p}{,} \PYG{n}{dpi}\PYG{o}{=}\PYG{l+m+mi}{300}\PYG{p}{,} \PYG{n}{bbox\PYGZus{}inches}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tight}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{e8f225b94fb7f185d6a73f7c486490baf3d1d23d003eb80998af80be40a8c1ef}.png}
\caption{Absolute sea level trend (red) from altimetry, and relative sea level trend (blue) from the tide gauge record at the \DUrole{pasted-text}{Hawaiian Islands} stations from \DUrole{pasted-text}{1993\sphinxhyphen{}01\sphinxhyphen{}01} to \DUrole{pasted-text}{2022\sphinxhyphen{}12\sphinxhyphen{}31}.}\label{\detokenize{notebooks/regional_and_local/SL_Trend:trend-fig}}\end{figure}


\bigskip\hrule\bigskip



\part{Citations}
\label{\detokenize{notebooks/regional_and_local/SL_Trend:citations}}
\begin{sphinxthebibliography}{CLSFranc}
\bibitem[CLSFrance]{notebooks/regional_and_local/SL_Trend:id10}
\sphinxAtStartPar
CLS (France). Global Ocean Gridded L 4 Sea Surface Heights And Derived Variables Reprocessed 1993 Ongoing. URL: \sphinxurl{https://data.marine.copernicus.eu/product/SEALEVEL\_GLO\_PHY\_L4\_MY\_008\_047/description}, \sphinxhref{https://doi.org/10.48670/moi-00148}{doi:10.48670/moi\sphinxhyphen{}00148}.

\sphinxAtStartPar
CLS (France). Global Ocean Gridded L 4 Sea Surface Heights And Derived Variables Reprocessed 1993 Ongoing. URL: \sphinxurl{https://data.marine.copernicus.eu/product/SEALEVEL\_GLO\_PHY\_L4\_MY\_008\_047/description}, \sphinxhref{https://doi.org/10.48670/moi-00148}{doi:10.48670/moi\sphinxhyphen{}00148}.

\sphinxAtStartPar
CLS (France). Global Ocean Gridded L 4 Sea Surface Heights And Derived Variables Reprocessed 1993 Ongoing. URL: \sphinxurl{https://data.marine.copernicus.eu/product/SEALEVEL\_GLO\_PHY\_L4\_MY\_008\_047/description}, \sphinxhref{https://doi.org/10.48670/moi-00148}{doi:10.48670/moi\sphinxhyphen{}00148}.
\end{sphinxthebibliography}







\renewcommand{\indexname}{Index}
\printindex
\end{document}